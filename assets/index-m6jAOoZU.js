(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function oo(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const _e={},Pn=[],wt=()=>{},Ph=()=>!1,Fi=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),lo=t=>t.startsWith("onUpdate:"),Ve=Object.assign,ao=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Mh=Object.prototype.hasOwnProperty,he=(t,e)=>Mh.call(t,e),G=Array.isArray,Mn=t=>ks(t)==="[object Map]",Ui=t=>ks(t)==="[object Set]",cl=t=>ks(t)==="[object Date]",ee=t=>typeof t=="function",xe=t=>typeof t=="string",Et=t=>typeof t=="symbol",Ce=t=>t!==null&&typeof t=="object",Ua=t=>(Ce(t)||ee(t))&&ee(t.then)&&ee(t.catch),Ba=Object.prototype.toString,ks=t=>Ba.call(t),Oh=t=>ks(t).slice(8,-1),Ha=t=>ks(t)==="[object Object]",co=t=>xe(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,os=oo(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Bi=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},kh=/-(\w)/g,Xt=Bi(t=>t.replace(kh,(e,n)=>n?n.toUpperCase():"")),Lh=/\B([A-Z])/g,In=Bi(t=>t.replace(Lh,"-$1").toLowerCase()),Wa=Bi(t=>t.charAt(0).toUpperCase()+t.slice(1)),hr=Bi(t=>t?`on${Wa(t)}`:""),zt=(t,e)=>!Object.is(t,e),ti=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Va=(t,e,n,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:n})},ui=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let ul;const Hi=()=>ul||(ul=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Yn(t){if(G(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],i=xe(s)?Bh(s):Yn(s);if(i)for(const r in i)e[r]=i[r]}return e}else if(xe(t)||Ce(t))return t}const $h=/;(?![^(]*\))/g,Fh=/:([^]+)/,Uh=/\/\*[^]*?\*\//g;function Bh(t){const e={};return t.replace(Uh,"").split($h).forEach(n=>{if(n){const s=n.split(Fh);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function je(t){let e="";if(xe(t))e=t;else if(G(t))for(let n=0;n<t.length;n++){const s=je(t[n]);s&&(e+=s+" ")}else if(Ce(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const Hh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Wh=oo(Hh);function ja(t){return!!t||t===""}function Vh(t,e){if(t.length!==e.length)return!1;let n=!0;for(let s=0;n&&s<t.length;s++)n=Wi(t[s],e[s]);return n}function Wi(t,e){if(t===e)return!0;let n=cl(t),s=cl(e);if(n||s)return n&&s?t.getTime()===e.getTime():!1;if(n=Et(t),s=Et(e),n||s)return t===e;if(n=G(t),s=G(e),n||s)return n&&s?Vh(t,e):!1;if(n=Ce(t),s=Ce(e),n||s){if(!n||!s)return!1;const i=Object.keys(t).length,r=Object.keys(e).length;if(i!==r)return!1;for(const o in t){const l=t.hasOwnProperty(o),a=e.hasOwnProperty(o);if(l&&!a||!l&&a||!Wi(t[o],e[o]))return!1}}return String(t)===String(e)}function jh(t,e){return t.findIndex(n=>Wi(n,e))}const Ya=t=>!!(t&&t.__v_isRef===!0),fe=t=>xe(t)?t:t==null?"":G(t)||Ce(t)&&(t.toString===Ba||!ee(t.toString))?Ya(t)?fe(t.value):JSON.stringify(t,za,2):String(t),za=(t,e)=>Ya(e)?za(t,e.value):Mn(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,i],r)=>(n[dr(s,r)+" =>"]=i,n),{})}:Ui(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>dr(n))}:Et(e)?dr(e):Ce(e)&&!G(e)&&!Ha(e)?String(e):e,dr=(t,e="")=>{var n;return Et(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let et;class Yh{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=et,!e&&et&&(this.index=(et.scopes||(et.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=et;try{return et=this,e()}finally{et=n}}}on(){et=this}off(){et=this.parent}stop(e){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function zh(){return et}let ge;const fr=new WeakSet;class qa{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,et&&et.active&&et.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,fr.has(this)&&(fr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ka(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,hl(this),Qa(this);const e=ge,n=ht;ge=this,ht=!0;try{return this.fn()}finally{Xa(this),ge=e,ht=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)fo(e);this.deps=this.depsTail=void 0,hl(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?fr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Pr(this)&&this.run()}get dirty(){return Pr(this)}}let Ga=0,ls,as;function Ka(t,e=!1){if(t.flags|=8,e){t.next=as,as=t;return}t.next=ls,ls=t}function uo(){Ga++}function ho(){if(--Ga>0)return;if(as){let e=as;for(as=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;ls;){let e=ls;for(ls=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=n}}if(t)throw t}function Qa(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Xa(t){let e,n=t.depsTail,s=n;for(;s;){const i=s.prevDep;s.version===-1?(s===n&&(n=i),fo(s),qh(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=i}t.deps=e,t.depsTail=n}function Pr(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Ja(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Ja(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===vs))return;t.globalVersion=vs;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!Pr(t)){t.flags&=-3;return}const n=ge,s=ht;ge=t,ht=!0;try{Qa(t);const i=t.fn(t._value);(e.version===0||zt(i,t._value))&&(t._value=i,e.version++)}catch(i){throw e.version++,i}finally{ge=n,ht=s,Xa(t),t.flags&=-3}}function fo(t,e=!1){const{dep:n,prevSub:s,nextSub:i}=t;if(s&&(s.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=s,t.nextSub=void 0),n.subs===t&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let r=n.computed.deps;r;r=r.nextDep)fo(r,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function qh(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let ht=!0;const Za=[];function sn(){Za.push(ht),ht=!1}function rn(){const t=Za.pop();ht=t===void 0?!0:t}function hl(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=ge;ge=void 0;try{e()}finally{ge=n}}}let vs=0;class Gh{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class po{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!ge||!ht||ge===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==ge)n=this.activeLink=new Gh(ge,this),ge.deps?(n.prevDep=ge.depsTail,ge.depsTail.nextDep=n,ge.depsTail=n):ge.deps=ge.depsTail=n,ec(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=ge.depsTail,n.nextDep=void 0,ge.depsTail.nextDep=n,ge.depsTail=n,ge.deps===n&&(ge.deps=s)}return n}trigger(e){this.version++,vs++,this.notify(e)}notify(e){uo();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{ho()}}}function ec(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)ec(s)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Mr=new WeakMap,mn=Symbol(""),Or=Symbol(""),ys=Symbol("");function ke(t,e,n){if(ht&&ge){let s=Mr.get(t);s||Mr.set(t,s=new Map);let i=s.get(n);i||(s.set(n,i=new po),i.map=s,i.key=n),i.track()}}function Pt(t,e,n,s,i,r){const o=Mr.get(t);if(!o){vs++;return}const l=a=>{a&&a.trigger()};if(uo(),e==="clear")o.forEach(l);else{const a=G(t),c=a&&co(n);if(a&&n==="length"){const u=Number(s);o.forEach((h,d)=>{(d==="length"||d===ys||!Et(d)&&d>=u)&&l(h)})}else switch((n!==void 0||o.has(void 0))&&l(o.get(n)),c&&l(o.get(ys)),e){case"add":a?c&&l(o.get("length")):(l(o.get(mn)),Mn(t)&&l(o.get(Or)));break;case"delete":a||(l(o.get(mn)),Mn(t)&&l(o.get(Or)));break;case"set":Mn(t)&&l(o.get(mn));break}}ho()}function xn(t){const e=ue(t);return e===t?e:(ke(e,"iterate",ys),lt(t)?e:e.map(Le))}function Vi(t){return ke(t=ue(t),"iterate",ys),t}const Kh={__proto__:null,[Symbol.iterator](){return pr(this,Symbol.iterator,Le)},concat(...t){return xn(this).concat(...t.map(e=>G(e)?xn(e):e))},entries(){return pr(this,"entries",t=>(t[1]=Le(t[1]),t))},every(t,e){return Nt(this,"every",t,e,void 0,arguments)},filter(t,e){return Nt(this,"filter",t,e,n=>n.map(Le),arguments)},find(t,e){return Nt(this,"find",t,e,Le,arguments)},findIndex(t,e){return Nt(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Nt(this,"findLast",t,e,Le,arguments)},findLastIndex(t,e){return Nt(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Nt(this,"forEach",t,e,void 0,arguments)},includes(...t){return _r(this,"includes",t)},indexOf(...t){return _r(this,"indexOf",t)},join(t){return xn(this).join(t)},lastIndexOf(...t){return _r(this,"lastIndexOf",t)},map(t,e){return Nt(this,"map",t,e,void 0,arguments)},pop(){return Jn(this,"pop")},push(...t){return Jn(this,"push",t)},reduce(t,...e){return dl(this,"reduce",t,e)},reduceRight(t,...e){return dl(this,"reduceRight",t,e)},shift(){return Jn(this,"shift")},some(t,e){return Nt(this,"some",t,e,void 0,arguments)},splice(...t){return Jn(this,"splice",t)},toReversed(){return xn(this).toReversed()},toSorted(t){return xn(this).toSorted(t)},toSpliced(...t){return xn(this).toSpliced(...t)},unshift(...t){return Jn(this,"unshift",t)},values(){return pr(this,"values",Le)}};function pr(t,e,n){const s=Vi(t),i=s[e]();return s!==t&&!lt(t)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.value&&(r.value=n(r.value)),r}),i}const Qh=Array.prototype;function Nt(t,e,n,s,i,r){const o=Vi(t),l=o!==t&&!lt(t),a=o[e];if(a!==Qh[e]){const h=a.apply(t,r);return l?Le(h):h}let c=n;o!==t&&(l?c=function(h,d){return n.call(this,Le(h),d,t)}:n.length>2&&(c=function(h,d){return n.call(this,h,d,t)}));const u=a.call(o,c,s);return l&&i?i(u):u}function dl(t,e,n,s){const i=Vi(t);let r=n;return i!==t&&(lt(t)?n.length>3&&(r=function(o,l,a){return n.call(this,o,l,a,t)}):r=function(o,l,a){return n.call(this,o,Le(l),a,t)}),i[e](r,...s)}function _r(t,e,n){const s=ue(t);ke(s,"iterate",ys);const i=s[e](...n);return(i===-1||i===!1)&&go(n[0])?(n[0]=ue(n[0]),s[e](...n)):i}function Jn(t,e,n=[]){sn(),uo();const s=ue(t)[e].apply(t,n);return ho(),rn(),s}const Xh=oo("__proto__,__v_isRef,__isVue"),tc=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Et));function Jh(t){Et(t)||(t=String(t));const e=ue(this);return ke(e,"has",t),e.hasOwnProperty(t)}class nc{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,s){if(n==="__v_skip")return e.__v_skip;const i=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!i;if(n==="__v_isReadonly")return i;if(n==="__v_isShallow")return r;if(n==="__v_raw")return s===(i?r?ad:oc:r?rc:ic).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=G(e);if(!i){let a;if(o&&(a=Kh[n]))return a;if(n==="hasOwnProperty")return Jh}const l=Reflect.get(e,n,Fe(e)?e:s);return(Et(n)?tc.has(n):Xh(n))||(i||ke(e,"get",n),r)?l:Fe(l)?o&&co(n)?l:l.value:Ce(l)?i?lc(l):ji(l):l}}class sc extends nc{constructor(e=!1){super(!1,e)}set(e,n,s,i){let r=e[n];if(!this._isShallow){const a=bn(r);if(!lt(s)&&!bn(s)&&(r=ue(r),s=ue(s)),!G(e)&&Fe(r)&&!Fe(s))return a?!1:(r.value=s,!0)}const o=G(e)&&co(n)?Number(n)<e.length:he(e,n),l=Reflect.set(e,n,s,Fe(e)?e:i);return e===ue(i)&&(o?zt(s,r)&&Pt(e,"set",n,s):Pt(e,"add",n,s)),l}deleteProperty(e,n){const s=he(e,n);e[n];const i=Reflect.deleteProperty(e,n);return i&&s&&Pt(e,"delete",n,void 0),i}has(e,n){const s=Reflect.has(e,n);return(!Et(n)||!tc.has(n))&&ke(e,"has",n),s}ownKeys(e){return ke(e,"iterate",G(e)?"length":mn),Reflect.ownKeys(e)}}class Zh extends nc{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const ed=new sc,td=new Zh,nd=new sc(!0);const kr=t=>t,zs=t=>Reflect.getPrototypeOf(t);function sd(t,e,n){return function(...s){const i=this.__v_raw,r=ue(i),o=Mn(r),l=t==="entries"||t===Symbol.iterator&&o,a=t==="keys"&&o,c=i[t](...s),u=n?kr:e?Lr:Le;return!e&&ke(r,"iterate",a?Or:mn),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:l?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function qs(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function id(t,e){const n={get(i){const r=this.__v_raw,o=ue(r),l=ue(i);t||(zt(i,l)&&ke(o,"get",i),ke(o,"get",l));const{has:a}=zs(o),c=e?kr:t?Lr:Le;if(a.call(o,i))return c(r.get(i));if(a.call(o,l))return c(r.get(l));r!==o&&r.get(i)},get size(){const i=this.__v_raw;return!t&&ke(ue(i),"iterate",mn),Reflect.get(i,"size",i)},has(i){const r=this.__v_raw,o=ue(r),l=ue(i);return t||(zt(i,l)&&ke(o,"has",i),ke(o,"has",l)),i===l?r.has(i):r.has(i)||r.has(l)},forEach(i,r){const o=this,l=o.__v_raw,a=ue(l),c=e?kr:t?Lr:Le;return!t&&ke(a,"iterate",mn),l.forEach((u,h)=>i.call(r,c(u),c(h),o))}};return Ve(n,t?{add:qs("add"),set:qs("set"),delete:qs("delete"),clear:qs("clear")}:{add(i){!e&&!lt(i)&&!bn(i)&&(i=ue(i));const r=ue(this);return zs(r).has.call(r,i)||(r.add(i),Pt(r,"add",i,i)),this},set(i,r){!e&&!lt(r)&&!bn(r)&&(r=ue(r));const o=ue(this),{has:l,get:a}=zs(o);let c=l.call(o,i);c||(i=ue(i),c=l.call(o,i));const u=a.call(o,i);return o.set(i,r),c?zt(r,u)&&Pt(o,"set",i,r):Pt(o,"add",i,r),this},delete(i){const r=ue(this),{has:o,get:l}=zs(r);let a=o.call(r,i);a||(i=ue(i),a=o.call(r,i)),l&&l.call(r,i);const c=r.delete(i);return a&&Pt(r,"delete",i,void 0),c},clear(){const i=ue(this),r=i.size!==0,o=i.clear();return r&&Pt(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=sd(i,t,e)}),n}function _o(t,e){const n=id(t,e);return(s,i,r)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?s:Reflect.get(he(n,i)&&i in s?n:s,i,r)}const rd={get:_o(!1,!1)},od={get:_o(!1,!0)},ld={get:_o(!0,!1)};const ic=new WeakMap,rc=new WeakMap,oc=new WeakMap,ad=new WeakMap;function cd(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ud(t){return t.__v_skip||!Object.isExtensible(t)?0:cd(Oh(t))}function ji(t){return bn(t)?t:mo(t,!1,ed,rd,ic)}function hd(t){return mo(t,!1,nd,od,rc)}function lc(t){return mo(t,!0,td,ld,oc)}function mo(t,e,n,s,i){if(!Ce(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=i.get(t);if(r)return r;const o=ud(t);if(o===0)return t;const l=new Proxy(t,o===2?s:n);return i.set(t,l),l}function On(t){return bn(t)?On(t.__v_raw):!!(t&&t.__v_isReactive)}function bn(t){return!!(t&&t.__v_isReadonly)}function lt(t){return!!(t&&t.__v_isShallow)}function go(t){return t?!!t.__v_raw:!1}function ue(t){const e=t&&t.__v_raw;return e?ue(e):t}function dd(t){return!he(t,"__v_skip")&&Object.isExtensible(t)&&Va(t,"__v_skip",!0),t}const Le=t=>Ce(t)?ji(t):t,Lr=t=>Ce(t)?lc(t):t;function Fe(t){return t?t.__v_isRef===!0:!1}function X(t){return fd(t,!1)}function fd(t,e){return Fe(t)?t:new pd(t,e)}class pd{constructor(e,n){this.dep=new po,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:ue(e),this._value=n?e:Le(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,s=this.__v_isShallow||lt(e)||bn(e);e=s?e:ue(e),zt(e,n)&&(this._rawValue=e,this._value=s?e:Le(e),this.dep.trigger())}}function _d(t){return Fe(t)?t.value:t}const md={get:(t,e,n)=>e==="__v_raw"?t:_d(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const i=t[e];return Fe(i)&&!Fe(n)?(i.value=n,!0):Reflect.set(t,e,n,s)}};function ac(t){return On(t)?t:new Proxy(t,md)}class gd{constructor(e,n,s){this.fn=e,this.setter=n,this._value=void 0,this.dep=new po(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=vs-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&ge!==this)return Ka(this,!0),!0}get value(){const e=this.dep.track();return Ja(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function vd(t,e,n=!1){let s,i;return ee(t)?s=t:(s=t.get,i=t.set),new gd(s,i,n)}const Gs={},hi=new WeakMap;let un;function yd(t,e=!1,n=un){if(n){let s=hi.get(n);s||hi.set(n,s=[]),s.push(t)}}function bd(t,e,n=_e){const{immediate:s,deep:i,once:r,scheduler:o,augmentJob:l,call:a}=n,c=v=>i?v:lt(v)||i===!1||i===0?Mt(v,1):Mt(v);let u,h,d,_,g=!1,m=!1;if(Fe(t)?(h=()=>t.value,g=lt(t)):On(t)?(h=()=>c(t),g=!0):G(t)?(m=!0,g=t.some(v=>On(v)||lt(v)),h=()=>t.map(v=>{if(Fe(v))return v.value;if(On(v))return c(v);if(ee(v))return a?a(v,2):v()})):ee(t)?e?h=a?()=>a(t,2):t:h=()=>{if(d){sn();try{d()}finally{rn()}}const v=un;un=u;try{return a?a(t,3,[_]):t(_)}finally{un=v}}:h=wt,e&&i){const v=h,C=i===!0?1/0:i;h=()=>Mt(v(),C)}const E=zh(),x=()=>{u.stop(),E&&E.active&&ao(E.effects,u)};if(r&&e){const v=e;e=(...C)=>{v(...C),x()}}let P=m?new Array(t.length).fill(Gs):Gs;const w=v=>{if(!(!(u.flags&1)||!u.dirty&&!v))if(e){const C=u.run();if(i||g||(m?C.some((U,q)=>zt(U,P[q])):zt(C,P))){d&&d();const U=un;un=u;try{const q=[C,P===Gs?void 0:m&&P[0]===Gs?[]:P,_];a?a(e,3,q):e(...q),P=C}finally{un=U}}}else u.run()};return l&&l(w),u=new qa(h),u.scheduler=o?()=>o(w,!1):w,_=v=>yd(v,!1,u),d=u.onStop=()=>{const v=hi.get(u);if(v){if(a)a(v,4);else for(const C of v)C();hi.delete(u)}},e?s?w(!0):P=u.run():o?o(w.bind(null,!0),!0):u.run(),x.pause=u.pause.bind(u),x.resume=u.resume.bind(u),x.stop=x,x}function Mt(t,e=1/0,n){if(e<=0||!Ce(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,Fe(t))Mt(t.value,e,n);else if(G(t))for(let s=0;s<t.length;s++)Mt(t[s],e,n);else if(Ui(t)||Mn(t))t.forEach(s=>{Mt(s,e,n)});else if(Ha(t)){for(const s in t)Mt(t[s],e,n);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Mt(t[s],e,n)}return t}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ls(t,e,n,s){try{return s?t(...s):t()}catch(i){Yi(i,e,n)}}function St(t,e,n,s){if(ee(t)){const i=Ls(t,e,n,s);return i&&Ua(i)&&i.catch(r=>{Yi(r,e,n)}),i}if(G(t)){const i=[];for(let r=0;r<t.length;r++)i.push(St(t[r],e,n,s));return i}}function Yi(t,e,n,s=!0){const i=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||_e;if(e){let l=e.parent;const a=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;l;){const u=l.ec;if(u){for(let h=0;h<u.length;h++)if(u[h](t,a,c)===!1)return}l=l.parent}if(r){sn(),Ls(r,null,10,[t,a,c]),rn();return}}Cd(t,n,i,s,o)}function Cd(t,e,n,s=!0,i=!1){if(i)throw t;console.error(t)}const Be=[];let yt=-1;const kn=[];let jt=null,An=0;const cc=Promise.resolve();let di=null;function uc(t){const e=di||cc;return t?e.then(this?t.bind(this):t):e}function wd(t){let e=yt+1,n=Be.length;for(;e<n;){const s=e+n>>>1,i=Be[s],r=bs(i);r<t||r===t&&i.flags&2?e=s+1:n=s}return e}function vo(t){if(!(t.flags&1)){const e=bs(t),n=Be[Be.length-1];!n||!(t.flags&2)&&e>=bs(n)?Be.push(t):Be.splice(wd(e),0,t),t.flags|=1,hc()}}function hc(){di||(di=cc.then(fc))}function Ed(t){G(t)?kn.push(...t):jt&&t.id===-1?jt.splice(An+1,0,t):t.flags&1||(kn.push(t),t.flags|=1),hc()}function fl(t,e,n=yt+1){for(;n<Be.length;n++){const s=Be[n];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;Be.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function dc(t){if(kn.length){const e=[...new Set(kn)].sort((n,s)=>bs(n)-bs(s));if(kn.length=0,jt){jt.push(...e);return}for(jt=e,An=0;An<jt.length;An++){const n=jt[An];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}jt=null,An=0}}const bs=t=>t.id==null?t.flags&2?-1:1/0:t.id;function fc(t){try{for(yt=0;yt<Be.length;yt++){const e=Be[yt];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Ls(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;yt<Be.length;yt++){const e=Be[yt];e&&(e.flags&=-2)}yt=-1,Be.length=0,dc(),di=null,(Be.length||kn.length)&&fc()}}let rt=null,pc=null;function fi(t){const e=rt;return rt=t,pc=t&&t.type.__scopeId||null,e}function Sd(t,e=rt,n){if(!e||t._n)return t;const s=(...i)=>{s._d&&wl(-1);const r=fi(e);let o;try{o=t(...i)}finally{fi(r),s._d&&wl(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function dt(t,e){if(rt===null)return t;const n=Qi(rt),s=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[r,o,l,a=_e]=e[i];r&&(ee(r)&&(r={mounted:r,updated:r}),r.deep&&Mt(o),s.push({dir:r,instance:n,value:o,oldValue:void 0,arg:l,modifiers:a}))}return t}function an(t,e,n,s){const i=t.dirs,r=e&&e.dirs;for(let o=0;o<i.length;o++){const l=i[o];r&&(l.oldValue=r[o].value);let a=l.dir[s];a&&(sn(),St(a,n,8,[t.el,l,t,e]),rn())}}const Id=Symbol("_vte"),Td=t=>t.__isTeleport;function yo(t,e){t.shapeFlag&6&&t.component?(t.transition=e,yo(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function _c(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function pi(t,e,n,s,i=!1){if(G(t)){t.forEach((g,m)=>pi(g,e&&(G(e)?e[m]:e),n,s,i));return}if(cs(s)&&!i){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&pi(t,e,n,s.component.subTree);return}const r=s.shapeFlag&4?Qi(s.component):s.el,o=i?null:r,{i:l,r:a}=t,c=e&&e.r,u=l.refs===_e?l.refs={}:l.refs,h=l.setupState,d=ue(h),_=h===_e?()=>!1:g=>he(d,g);if(c!=null&&c!==a&&(xe(c)?(u[c]=null,_(c)&&(h[c]=null)):Fe(c)&&(c.value=null)),ee(a))Ls(a,l,12,[o,u]);else{const g=xe(a),m=Fe(a);if(g||m){const E=()=>{if(t.f){const x=g?_(a)?h[a]:u[a]:a.value;i?G(x)&&ao(x,r):G(x)?x.includes(r)||x.push(r):g?(u[a]=[r],_(a)&&(h[a]=u[a])):(a.value=[r],t.k&&(u[t.k]=a.value))}else g?(u[a]=o,_(a)&&(h[a]=o)):m&&(a.value=o,t.k&&(u[t.k]=o))};o?(E.id=-1,Ze(E,n)):E()}}}Hi().requestIdleCallback;Hi().cancelIdleCallback;const cs=t=>!!t.type.__asyncLoader,mc=t=>t.type.__isKeepAlive;function xd(t,e){gc(t,"a",e)}function Rd(t,e){gc(t,"da",e)}function gc(t,e,n=He){const s=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(zi(e,s,n),n){let i=n.parent;for(;i&&i.parent;)mc(i.parent.vnode)&&Ad(s,e,n,i),i=i.parent}}function Ad(t,e,n,s){const i=zi(e,t,s,!0);qi(()=>{ao(s[e],i)},n)}function zi(t,e,n=He,s=!1){if(n){const i=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{sn();const l=$s(n),a=St(e,n,t,o);return l(),rn(),a});return s?i.unshift(r):i.push(r),r}}const Ht=t=>(e,n=He)=>{(!ws||t==="sp")&&zi(t,(...s)=>e(...s),n)},Nd=Ht("bm"),Wt=Ht("m"),Dd=Ht("bu"),Pd=Ht("u"),vc=Ht("bum"),qi=Ht("um"),Md=Ht("sp"),Od=Ht("rtg"),kd=Ht("rtc");function Ld(t,e=He){zi("ec",t,e)}const $d=Symbol.for("v-ndc");function nt(t,e,n,s){let i;const r=n,o=G(t);if(o||xe(t)){const l=o&&On(t);let a=!1;l&&(a=!lt(t),t=Vi(t)),i=new Array(t.length);for(let c=0,u=t.length;c<u;c++)i[c]=e(a?Le(t[c]):t[c],c,void 0,r)}else if(typeof t=="number"){i=new Array(t);for(let l=0;l<t;l++)i[l]=e(l+1,l,void 0,r)}else if(Ce(t))if(t[Symbol.iterator])i=Array.from(t,(l,a)=>e(l,a,void 0,r));else{const l=Object.keys(t);i=new Array(l.length);for(let a=0,c=l.length;a<c;a++){const u=l[a];i[a]=e(t[u],u,a,r)}}else i=[];return i}const $r=t=>t?Hc(t)?Qi(t):$r(t.parent):null,us=Ve(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>$r(t.parent),$root:t=>$r(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>bc(t),$forceUpdate:t=>t.f||(t.f=()=>{vo(t.update)}),$nextTick:t=>t.n||(t.n=uc.bind(t.proxy)),$watch:t=>of.bind(t)}),mr=(t,e)=>t!==_e&&!t.__isScriptSetup&&he(t,e),Fd={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:s,data:i,props:r,accessCache:o,type:l,appContext:a}=t;let c;if(e[0]!=="$"){const _=o[e];if(_!==void 0)switch(_){case 1:return s[e];case 2:return i[e];case 4:return n[e];case 3:return r[e]}else{if(mr(s,e))return o[e]=1,s[e];if(i!==_e&&he(i,e))return o[e]=2,i[e];if((c=t.propsOptions[0])&&he(c,e))return o[e]=3,r[e];if(n!==_e&&he(n,e))return o[e]=4,n[e];Fr&&(o[e]=0)}}const u=us[e];let h,d;if(u)return e==="$attrs"&&ke(t.attrs,"get",""),u(t);if((h=l.__cssModules)&&(h=h[e]))return h;if(n!==_e&&he(n,e))return o[e]=4,n[e];if(d=a.config.globalProperties,he(d,e))return d[e]},set({_:t},e,n){const{data:s,setupState:i,ctx:r}=t;return mr(i,e)?(i[e]=n,!0):s!==_e&&he(s,e)?(s[e]=n,!0):he(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:i,propsOptions:r}},o){let l;return!!n[o]||t!==_e&&he(t,o)||mr(e,o)||(l=r[0])&&he(l,o)||he(s,o)||he(us,o)||he(i.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:he(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function pl(t){return G(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let Fr=!0;function Ud(t){const e=bc(t),n=t.proxy,s=t.ctx;Fr=!1,e.beforeCreate&&_l(e.beforeCreate,t,"bc");const{data:i,computed:r,methods:o,watch:l,provide:a,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:_,updated:g,activated:m,deactivated:E,beforeDestroy:x,beforeUnmount:P,destroyed:w,unmounted:v,render:C,renderTracked:U,renderTriggered:q,errorCaptured:J,serverPrefetch:ce,expose:Z,inheritAttrs:te,components:xt,directives:ln,filters:z}=e;if(c&&Bd(c,s,null),o)for(const k in o){const T=o[k];ee(T)&&(s[k]=T.bind(n))}if(i){const k=i.call(n,n);Ce(k)&&(t.data=ji(k))}if(Fr=!0,r)for(const k in r){const T=r[k],W=ee(T)?T.bind(n,n):ee(T.get)?T.get.bind(n,n):wt,K=!ee(T)&&ee(T.set)?T.set.bind(n):wt,re=Jt({get:W,set:K});Object.defineProperty(s,k,{enumerable:!0,configurable:!0,get:()=>re.value,set:le=>re.value=le})}if(l)for(const k in l)yc(l[k],s,n,k);if(a){const k=ee(a)?a.call(n):a;Reflect.ownKeys(k).forEach(T=>{zd(T,k[T])})}u&&_l(u,t,"c");function N(k,T){G(T)?T.forEach(W=>k(W.bind(n))):T&&k(T.bind(n))}if(N(Nd,h),N(Wt,d),N(Dd,_),N(Pd,g),N(xd,m),N(Rd,E),N(Ld,J),N(kd,U),N(Od,q),N(vc,P),N(qi,v),N(Md,ce),G(Z))if(Z.length){const k=t.exposed||(t.exposed={});Z.forEach(T=>{Object.defineProperty(k,T,{get:()=>n[T],set:W=>n[T]=W})})}else t.exposed||(t.exposed={});C&&t.render===wt&&(t.render=C),te!=null&&(t.inheritAttrs=te),xt&&(t.components=xt),ln&&(t.directives=ln),ce&&_c(t)}function Bd(t,e,n=wt){G(t)&&(t=Ur(t));for(const s in t){const i=t[s];let r;Ce(i)?"default"in i?r=ni(i.from||s,i.default,!0):r=ni(i.from||s):r=ni(i),Fe(r)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[s]=r}}function _l(t,e,n){St(G(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function yc(t,e,n,s){let i=s.includes(".")?Oc(n,s):()=>n[s];if(xe(t)){const r=e[t];ee(r)&&gn(i,r)}else if(ee(t))gn(i,t.bind(n));else if(Ce(t))if(G(t))t.forEach(r=>yc(r,e,n,s));else{const r=ee(t.handler)?t.handler.bind(n):e[t.handler];ee(r)&&gn(i,r,t)}}function bc(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,l=r.get(e);let a;return l?a=l:!i.length&&!n&&!s?a=e:(a={},i.length&&i.forEach(c=>_i(a,c,o,!0)),_i(a,e,o)),Ce(e)&&r.set(e,a),a}function _i(t,e,n,s=!1){const{mixins:i,extends:r}=e;r&&_i(t,r,n,!0),i&&i.forEach(o=>_i(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const l=Hd[o]||n&&n[o];t[o]=l?l(t[o],e[o]):e[o]}return t}const Hd={data:ml,props:gl,emits:gl,methods:rs,computed:rs,beforeCreate:Ue,created:Ue,beforeMount:Ue,mounted:Ue,beforeUpdate:Ue,updated:Ue,beforeDestroy:Ue,beforeUnmount:Ue,destroyed:Ue,unmounted:Ue,activated:Ue,deactivated:Ue,errorCaptured:Ue,serverPrefetch:Ue,components:rs,directives:rs,watch:Vd,provide:ml,inject:Wd};function ml(t,e){return e?t?function(){return Ve(ee(t)?t.call(this,this):t,ee(e)?e.call(this,this):e)}:e:t}function Wd(t,e){return rs(Ur(t),Ur(e))}function Ur(t){if(G(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Ue(t,e){return t?[...new Set([].concat(t,e))]:e}function rs(t,e){return t?Ve(Object.create(null),t,e):e}function gl(t,e){return t?G(t)&&G(e)?[...new Set([...t,...e])]:Ve(Object.create(null),pl(t),pl(e??{})):e}function Vd(t,e){if(!t)return e;if(!e)return t;const n=Ve(Object.create(null),t);for(const s in e)n[s]=Ue(t[s],e[s]);return n}function Cc(){return{app:null,config:{isNativeTag:Ph,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let jd=0;function Yd(t,e){return function(s,i=null){ee(s)||(s=Ve({},s)),i!=null&&!Ce(i)&&(i=null);const r=Cc(),o=new WeakSet,l=[];let a=!1;const c=r.app={_uid:jd++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:xf,get config(){return r.config},set config(u){},use(u,...h){return o.has(u)||(u&&ee(u.install)?(o.add(u),u.install(c,...h)):ee(u)&&(o.add(u),u(c,...h))),c},mixin(u){return r.mixins.includes(u)||r.mixins.push(u),c},component(u,h){return h?(r.components[u]=h,c):r.components[u]},directive(u,h){return h?(r.directives[u]=h,c):r.directives[u]},mount(u,h,d){if(!a){const _=c._ceVNode||Te(s,i);return _.appContext=r,d===!0?d="svg":d===!1&&(d=void 0),t(_,u,d),a=!0,c._container=u,u.__vue_app__=c,Qi(_.component)}},onUnmount(u){l.push(u)},unmount(){a&&(St(l,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(u,h){return r.provides[u]=h,c},runWithContext(u){const h=Ln;Ln=c;try{return u()}finally{Ln=h}}};return c}}let Ln=null;function zd(t,e){if(He){let n=He.provides;const s=He.parent&&He.parent.provides;s===n&&(n=He.provides=Object.create(s)),n[t]=e}}function ni(t,e,n=!1){const s=He||rt;if(s||Ln){const i=Ln?Ln._context.provides:s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return n&&ee(e)?e.call(s&&s.proxy):e}}const wc={},Ec=()=>Object.create(wc),Sc=t=>Object.getPrototypeOf(t)===wc;function qd(t,e,n,s=!1){const i={},r=Ec();t.propsDefaults=Object.create(null),Ic(t,e,i,r);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=s?i:hd(i):t.type.props?t.props=i:t.props=r,t.attrs=r}function Gd(t,e,n,s){const{props:i,attrs:r,vnode:{patchFlag:o}}=t,l=ue(i),[a]=t.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(Gi(t.emitsOptions,d))continue;const _=e[d];if(a)if(he(r,d))_!==r[d]&&(r[d]=_,c=!0);else{const g=Xt(d);i[g]=Br(a,l,g,_,t,!1)}else _!==r[d]&&(r[d]=_,c=!0)}}}else{Ic(t,e,i,r)&&(c=!0);let u;for(const h in l)(!e||!he(e,h)&&((u=In(h))===h||!he(e,u)))&&(a?n&&(n[h]!==void 0||n[u]!==void 0)&&(i[h]=Br(a,l,h,void 0,t,!0)):delete i[h]);if(r!==l)for(const h in r)(!e||!he(e,h))&&(delete r[h],c=!0)}c&&Pt(t.attrs,"set","")}function Ic(t,e,n,s){const[i,r]=t.propsOptions;let o=!1,l;if(e)for(let a in e){if(os(a))continue;const c=e[a];let u;i&&he(i,u=Xt(a))?!r||!r.includes(u)?n[u]=c:(l||(l={}))[u]=c:Gi(t.emitsOptions,a)||(!(a in s)||c!==s[a])&&(s[a]=c,o=!0)}if(r){const a=ue(n),c=l||_e;for(let u=0;u<r.length;u++){const h=r[u];n[h]=Br(i,a,h,c[h],t,!he(c,h))}}return o}function Br(t,e,n,s,i,r){const o=t[n];if(o!=null){const l=he(o,"default");if(l&&s===void 0){const a=o.default;if(o.type!==Function&&!o.skipFactory&&ee(a)){const{propsDefaults:c}=i;if(n in c)s=c[n];else{const u=$s(i);s=c[n]=a.call(null,e),u()}}else s=a;i.ce&&i.ce._setProp(n,s)}o[0]&&(r&&!l?s=!1:o[1]&&(s===""||s===In(n))&&(s=!0))}return s}const Kd=new WeakMap;function Tc(t,e,n=!1){const s=n?Kd:e.propsCache,i=s.get(t);if(i)return i;const r=t.props,o={},l=[];let a=!1;if(!ee(t)){const u=h=>{a=!0;const[d,_]=Tc(h,e,!0);Ve(o,d),_&&l.push(..._)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!r&&!a)return Ce(t)&&s.set(t,Pn),Pn;if(G(r))for(let u=0;u<r.length;u++){const h=Xt(r[u]);vl(h)&&(o[h]=_e)}else if(r)for(const u in r){const h=Xt(u);if(vl(h)){const d=r[u],_=o[h]=G(d)||ee(d)?{type:d}:Ve({},d),g=_.type;let m=!1,E=!0;if(G(g))for(let x=0;x<g.length;++x){const P=g[x],w=ee(P)&&P.name;if(w==="Boolean"){m=!0;break}else w==="String"&&(E=!1)}else m=ee(g)&&g.name==="Boolean";_[0]=m,_[1]=E,(m||he(_,"default"))&&l.push(h)}}const c=[o,l];return Ce(t)&&s.set(t,c),c}function vl(t){return t[0]!=="$"&&!os(t)}const xc=t=>t[0]==="_"||t==="$stable",bo=t=>G(t)?t.map(bt):[bt(t)],Qd=(t,e,n)=>{if(e._n)return e;const s=Sd((...i)=>bo(e(...i)),n);return s._c=!1,s},Rc=(t,e,n)=>{const s=t._ctx;for(const i in t){if(xc(i))continue;const r=t[i];if(ee(r))e[i]=Qd(i,r,s);else if(r!=null){const o=bo(r);e[i]=()=>o}}},Ac=(t,e)=>{const n=bo(e);t.slots.default=()=>n},Nc=(t,e,n)=>{for(const s in e)(n||s!=="_")&&(t[s]=e[s])},Xd=(t,e,n)=>{const s=t.slots=Ec();if(t.vnode.shapeFlag&32){const i=e._;i?(Nc(s,e,n),n&&Va(s,"_",i,!0)):Rc(e,s)}else e&&Ac(t,e)},Jd=(t,e,n)=>{const{vnode:s,slots:i}=t;let r=!0,o=_e;if(s.shapeFlag&32){const l=e._;l?n&&l===1?r=!1:Nc(i,e,n):(r=!e.$stable,Rc(e,i)),o=e}else e&&(Ac(t,e),o={default:1});if(r)for(const l in i)!xc(l)&&o[l]==null&&delete i[l]},Ze=ff;function Zd(t){return ef(t)}function ef(t,e){const n=Hi();n.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:o,createText:l,createComment:a,setText:c,setElementText:u,parentNode:h,nextSibling:d,setScopeId:_=wt,insertStaticContent:g}=t,m=(f,p,b,R=null,S=null,I=null,L=void 0,O=null,M=!!p.dynamicChildren)=>{if(f===p)return;f&&!Zn(f,p)&&(R=it(f),le(f,S,I,!0),f=null),p.patchFlag===-2&&(M=!1,p.dynamicChildren=null);const{type:A,ref:V,shapeFlag:$}=p;switch(A){case Ki:E(f,p,b,R);break;case Cn:x(f,p,b,R);break;case si:f==null&&P(p,b,R,L);break;case we:xt(f,p,b,R,S,I,L,O,M);break;default:$&1?C(f,p,b,R,S,I,L,O,M):$&6?ln(f,p,b,R,S,I,L,O,M):($&64||$&128)&&A.process(f,p,b,R,S,I,L,O,M,Ie)}V!=null&&S&&pi(V,f&&f.ref,I,p||f,!p)},E=(f,p,b,R)=>{if(f==null)s(p.el=l(p.children),b,R);else{const S=p.el=f.el;p.children!==f.children&&c(S,p.children)}},x=(f,p,b,R)=>{f==null?s(p.el=a(p.children||""),b,R):p.el=f.el},P=(f,p,b,R)=>{[f.el,f.anchor]=g(f.children,p,b,R,f.el,f.anchor)},w=({el:f,anchor:p},b,R)=>{let S;for(;f&&f!==p;)S=d(f),s(f,b,R),f=S;s(p,b,R)},v=({el:f,anchor:p})=>{let b;for(;f&&f!==p;)b=d(f),i(f),f=b;i(p)},C=(f,p,b,R,S,I,L,O,M)=>{p.type==="svg"?L="svg":p.type==="math"&&(L="mathml"),f==null?U(p,b,R,S,I,L,O,M):ce(f,p,S,I,L,O,M)},U=(f,p,b,R,S,I,L,O)=>{let M,A;const{props:V,shapeFlag:$,transition:H,dirs:Q}=f;if(M=f.el=o(f.type,I,V&&V.is,V),$&8?u(M,f.children):$&16&&J(f.children,M,null,R,S,gr(f,I),L,O),Q&&an(f,null,R,"created"),q(M,f,f.scopeId,L,R),V){for(const me in V)me!=="value"&&!os(me)&&r(M,me,null,V[me],I,R);"value"in V&&r(M,"value",null,V.value,I),(A=V.onVnodeBeforeMount)&&vt(A,R,f)}Q&&an(f,null,R,"beforeMount");const oe=tf(S,H);oe&&H.beforeEnter(M),s(M,p,b),((A=V&&V.onVnodeMounted)||oe||Q)&&Ze(()=>{A&&vt(A,R,f),oe&&H.enter(M),Q&&an(f,null,R,"mounted")},S)},q=(f,p,b,R,S)=>{if(b&&_(f,b),R)for(let I=0;I<R.length;I++)_(f,R[I]);if(S){let I=S.subTree;if(p===I||Lc(I.type)&&(I.ssContent===p||I.ssFallback===p)){const L=S.vnode;q(f,L,L.scopeId,L.slotScopeIds,S.parent)}}},J=(f,p,b,R,S,I,L,O,M=0)=>{for(let A=M;A<f.length;A++){const V=f[A]=O?Yt(f[A]):bt(f[A]);m(null,V,p,b,R,S,I,L,O)}},ce=(f,p,b,R,S,I,L)=>{const O=p.el=f.el;let{patchFlag:M,dynamicChildren:A,dirs:V}=p;M|=f.patchFlag&16;const $=f.props||_e,H=p.props||_e;let Q;if(b&&cn(b,!1),(Q=H.onVnodeBeforeUpdate)&&vt(Q,b,p,f),V&&an(p,f,b,"beforeUpdate"),b&&cn(b,!0),($.innerHTML&&H.innerHTML==null||$.textContent&&H.textContent==null)&&u(O,""),A?Z(f.dynamicChildren,A,O,b,R,gr(p,S),I):L||T(f,p,O,null,b,R,gr(p,S),I,!1),M>0){if(M&16)te(O,$,H,b,S);else if(M&2&&$.class!==H.class&&r(O,"class",null,H.class,S),M&4&&r(O,"style",$.style,H.style,S),M&8){const oe=p.dynamicProps;for(let me=0;me<oe.length;me++){const de=oe[me],Xe=$[de],ze=H[de];(ze!==Xe||de==="value")&&r(O,de,Xe,ze,S,b)}}M&1&&f.children!==p.children&&u(O,p.children)}else!L&&A==null&&te(O,$,H,b,S);((Q=H.onVnodeUpdated)||V)&&Ze(()=>{Q&&vt(Q,b,p,f),V&&an(p,f,b,"updated")},R)},Z=(f,p,b,R,S,I,L)=>{for(let O=0;O<p.length;O++){const M=f[O],A=p[O],V=M.el&&(M.type===we||!Zn(M,A)||M.shapeFlag&70)?h(M.el):b;m(M,A,V,null,R,S,I,L,!0)}},te=(f,p,b,R,S)=>{if(p!==b){if(p!==_e)for(const I in p)!os(I)&&!(I in b)&&r(f,I,p[I],null,S,R);for(const I in b){if(os(I))continue;const L=b[I],O=p[I];L!==O&&I!=="value"&&r(f,I,O,L,S,R)}"value"in b&&r(f,"value",p.value,b.value,S)}},xt=(f,p,b,R,S,I,L,O,M)=>{const A=p.el=f?f.el:l(""),V=p.anchor=f?f.anchor:l("");let{patchFlag:$,dynamicChildren:H,slotScopeIds:Q}=p;Q&&(O=O?O.concat(Q):Q),f==null?(s(A,b,R),s(V,b,R),J(p.children||[],b,V,S,I,L,O,M)):$>0&&$&64&&H&&f.dynamicChildren?(Z(f.dynamicChildren,H,b,S,I,L,O),(p.key!=null||S&&p===S.subTree)&&Dc(f,p,!0)):T(f,p,b,V,S,I,L,O,M)},ln=(f,p,b,R,S,I,L,O,M)=>{p.slotScopeIds=O,f==null?p.shapeFlag&512?S.ctx.activate(p,b,R,L,M):z(p,b,R,S,I,L,M):F(f,p,M)},z=(f,p,b,R,S,I,L)=>{const O=f.component=Cf(f,R,S);if(mc(f)&&(O.ctx.renderer=Ie),wf(O,!1,L),O.asyncDep){if(S&&S.registerDep(O,N,L),!f.el){const M=O.subTree=Te(Cn);x(null,M,p,b)}}else N(O,f,p,b,S,I,L)},F=(f,p,b)=>{const R=p.component=f.component;if(hf(f,p,b))if(R.asyncDep&&!R.asyncResolved){k(R,p,b);return}else R.next=p,R.update();else p.el=f.el,R.vnode=p},N=(f,p,b,R,S,I,L)=>{const O=()=>{if(f.isMounted){let{next:$,bu:H,u:Q,parent:oe,vnode:me}=f;{const mt=Pc(f);if(mt){$&&($.el=me.el,k(f,$,L)),mt.asyncDep.then(()=>{f.isUnmounted||O()});return}}let de=$,Xe;cn(f,!1),$?($.el=me.el,k(f,$,L)):$=me,H&&ti(H),(Xe=$.props&&$.props.onVnodeBeforeUpdate)&&vt(Xe,oe,$,me),cn(f,!0);const ze=bl(f),_t=f.subTree;f.subTree=ze,m(_t,ze,h(_t.el),it(_t),f,S,I),$.el=ze.el,de===null&&df(f,ze.el),Q&&Ze(Q,S),(Xe=$.props&&$.props.onVnodeUpdated)&&Ze(()=>vt(Xe,oe,$,me),S)}else{let $;const{el:H,props:Q}=p,{bm:oe,m:me,parent:de,root:Xe,type:ze}=f,_t=cs(p);cn(f,!1),oe&&ti(oe),!_t&&($=Q&&Q.onVnodeBeforeMount)&&vt($,de,p),cn(f,!0);{Xe.ce&&Xe.ce._injectChildStyle(ze);const mt=f.subTree=bl(f);m(null,mt,b,R,f,S,I),p.el=mt.el}if(me&&Ze(me,S),!_t&&($=Q&&Q.onVnodeMounted)){const mt=p;Ze(()=>vt($,de,mt),S)}(p.shapeFlag&256||de&&cs(de.vnode)&&de.vnode.shapeFlag&256)&&f.a&&Ze(f.a,S),f.isMounted=!0,p=b=R=null}};f.scope.on();const M=f.effect=new qa(O);f.scope.off();const A=f.update=M.run.bind(M),V=f.job=M.runIfDirty.bind(M);V.i=f,V.id=f.uid,M.scheduler=()=>vo(V),cn(f,!0),A()},k=(f,p,b)=>{p.component=f;const R=f.vnode.props;f.vnode=p,f.next=null,Gd(f,p.props,R,b),Jd(f,p.children,b),sn(),fl(f),rn()},T=(f,p,b,R,S,I,L,O,M=!1)=>{const A=f&&f.children,V=f?f.shapeFlag:0,$=p.children,{patchFlag:H,shapeFlag:Q}=p;if(H>0){if(H&128){K(A,$,b,R,S,I,L,O,M);return}else if(H&256){W(A,$,b,R,S,I,L,O,M);return}}Q&8?(V&16&&st(A,S,I),$!==A&&u(b,$)):V&16?Q&16?K(A,$,b,R,S,I,L,O,M):st(A,S,I,!0):(V&8&&u(b,""),Q&16&&J($,b,R,S,I,L,O,M))},W=(f,p,b,R,S,I,L,O,M)=>{f=f||Pn,p=p||Pn;const A=f.length,V=p.length,$=Math.min(A,V);let H;for(H=0;H<$;H++){const Q=p[H]=M?Yt(p[H]):bt(p[H]);m(f[H],Q,b,null,S,I,L,O,M)}A>V?st(f,S,I,!0,!1,$):J(p,b,R,S,I,L,O,M,$)},K=(f,p,b,R,S,I,L,O,M)=>{let A=0;const V=p.length;let $=f.length-1,H=V-1;for(;A<=$&&A<=H;){const Q=f[A],oe=p[A]=M?Yt(p[A]):bt(p[A]);if(Zn(Q,oe))m(Q,oe,b,null,S,I,L,O,M);else break;A++}for(;A<=$&&A<=H;){const Q=f[$],oe=p[H]=M?Yt(p[H]):bt(p[H]);if(Zn(Q,oe))m(Q,oe,b,null,S,I,L,O,M);else break;$--,H--}if(A>$){if(A<=H){const Q=H+1,oe=Q<V?p[Q].el:R;for(;A<=H;)m(null,p[A]=M?Yt(p[A]):bt(p[A]),b,oe,S,I,L,O,M),A++}}else if(A>H)for(;A<=$;)le(f[A],S,I,!0),A++;else{const Q=A,oe=A,me=new Map;for(A=oe;A<=H;A++){const Je=p[A]=M?Yt(p[A]):bt(p[A]);Je.key!=null&&me.set(Je.key,A)}let de,Xe=0;const ze=H-oe+1;let _t=!1,mt=0;const Xn=new Array(ze);for(A=0;A<ze;A++)Xn[A]=0;for(A=Q;A<=$;A++){const Je=f[A];if(Xe>=ze){le(Je,S,I,!0);continue}let gt;if(Je.key!=null)gt=me.get(Je.key);else for(de=oe;de<=H;de++)if(Xn[de-oe]===0&&Zn(Je,p[de])){gt=de;break}gt===void 0?le(Je,S,I,!0):(Xn[gt-oe]=A+1,gt>=mt?mt=gt:_t=!0,m(Je,p[gt],b,null,S,I,L,O,M),Xe++)}const ll=_t?nf(Xn):Pn;for(de=ll.length-1,A=ze-1;A>=0;A--){const Je=oe+A,gt=p[Je],al=Je+1<V?p[Je+1].el:R;Xn[A]===0?m(null,gt,b,al,S,I,L,O,M):_t&&(de<0||A!==ll[de]?re(gt,b,al,2):de--)}}},re=(f,p,b,R,S=null)=>{const{el:I,type:L,transition:O,children:M,shapeFlag:A}=f;if(A&6){re(f.component.subTree,p,b,R);return}if(A&128){f.suspense.move(p,b,R);return}if(A&64){L.move(f,p,b,Ie);return}if(L===we){s(I,p,b);for(let $=0;$<M.length;$++)re(M[$],p,b,R);s(f.anchor,p,b);return}if(L===si){w(f,p,b);return}if(R!==2&&A&1&&O)if(R===0)O.beforeEnter(I),s(I,p,b),Ze(()=>O.enter(I),S);else{const{leave:$,delayLeave:H,afterLeave:Q}=O,oe=()=>s(I,p,b),me=()=>{$(I,()=>{oe(),Q&&Q()})};H?H(I,oe,me):me()}else s(I,p,b)},le=(f,p,b,R=!1,S=!1)=>{const{type:I,props:L,ref:O,children:M,dynamicChildren:A,shapeFlag:V,patchFlag:$,dirs:H,cacheIndex:Q}=f;if($===-2&&(S=!1),O!=null&&pi(O,null,b,f,!0),Q!=null&&(p.renderCache[Q]=void 0),V&256){p.ctx.deactivate(f);return}const oe=V&1&&H,me=!cs(f);let de;if(me&&(de=L&&L.onVnodeBeforeUnmount)&&vt(de,p,f),V&6)Ye(f.component,b,R);else{if(V&128){f.suspense.unmount(b,R);return}oe&&an(f,null,p,"beforeUnmount"),V&64?f.type.remove(f,p,b,Ie,R):A&&!A.hasOnce&&(I!==we||$>0&&$&64)?st(A,p,b,!1,!0):(I===we&&$&384||!S&&V&16)&&st(M,p,b),R&&Se(f)}(me&&(de=L&&L.onVnodeUnmounted)||oe)&&Ze(()=>{de&&vt(de,p,f),oe&&an(f,null,p,"unmounted")},b)},Se=f=>{const{type:p,el:b,anchor:R,transition:S}=f;if(p===we){Ne(b,R);return}if(p===si){v(f);return}const I=()=>{i(b),S&&!S.persisted&&S.afterLeave&&S.afterLeave()};if(f.shapeFlag&1&&S&&!S.persisted){const{leave:L,delayLeave:O}=S,M=()=>L(b,I);O?O(f.el,I,M):M()}else I()},Ne=(f,p)=>{let b;for(;f!==p;)b=d(f),i(f),f=b;i(p)},Ye=(f,p,b)=>{const{bum:R,scope:S,job:I,subTree:L,um:O,m:M,a:A}=f;yl(M),yl(A),R&&ti(R),S.stop(),I&&(I.flags|=8,le(L,f,p,b)),O&&Ze(O,p),Ze(()=>{f.isUnmounted=!0},p),p&&p.pendingBranch&&!p.isUnmounted&&f.asyncDep&&!f.asyncResolved&&f.suspenseId===p.pendingId&&(p.deps--,p.deps===0&&p.resolve())},st=(f,p,b,R=!1,S=!1,I=0)=>{for(let L=I;L<f.length;L++)le(f[L],p,b,R,S)},it=f=>{if(f.shapeFlag&6)return it(f.component.subTree);if(f.shapeFlag&128)return f.suspense.next();const p=d(f.anchor||f.el),b=p&&p[Id];return b?d(b):p};let Rt=!1;const pt=(f,p,b)=>{f==null?p._vnode&&le(p._vnode,null,null,!0):m(p._vnode||null,f,p,null,null,null,b),p._vnode=f,Rt||(Rt=!0,fl(),dc(),Rt=!1)},Ie={p:m,um:le,m:re,r:Se,mt:z,mc:J,pc:T,pbc:Z,n:it,o:t};return{render:pt,hydrate:void 0,createApp:Yd(pt)}}function gr({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function cn({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function tf(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Dc(t,e,n=!1){const s=t.children,i=e.children;if(G(s)&&G(i))for(let r=0;r<s.length;r++){const o=s[r];let l=i[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=i[r]=Yt(i[r]),l.el=o.el),!n&&l.patchFlag!==-2&&Dc(o,l)),l.type===Ki&&(l.el=o.el)}}function nf(t){const e=t.slice(),n=[0];let s,i,r,o,l;const a=t.length;for(s=0;s<a;s++){const c=t[s];if(c!==0){if(i=n[n.length-1],t[i]<c){e[s]=i,n.push(s);continue}for(r=0,o=n.length-1;r<o;)l=r+o>>1,t[n[l]]<c?r=l+1:o=l;c<t[n[r]]&&(r>0&&(e[s]=n[r-1]),n[r]=s)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}function Pc(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Pc(e)}function yl(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const sf=Symbol.for("v-scx"),rf=()=>ni(sf);function gn(t,e,n){return Mc(t,e,n)}function Mc(t,e,n=_e){const{immediate:s,deep:i,flush:r,once:o}=n,l=Ve({},n),a=e&&s||!e&&r!=="post";let c;if(ws){if(r==="sync"){const _=rf();c=_.__watcherHandles||(_.__watcherHandles=[])}else if(!a){const _=()=>{};return _.stop=wt,_.resume=wt,_.pause=wt,_}}const u=He;l.call=(_,g,m)=>St(_,u,g,m);let h=!1;r==="post"?l.scheduler=_=>{Ze(_,u&&u.suspense)}:r!=="sync"&&(h=!0,l.scheduler=(_,g)=>{g?_():vo(_)}),l.augmentJob=_=>{e&&(_.flags|=4),h&&(_.flags|=2,u&&(_.id=u.uid,_.i=u))};const d=bd(t,e,l);return ws&&(c?c.push(d):a&&d()),d}function of(t,e,n){const s=this.proxy,i=xe(t)?t.includes(".")?Oc(s,t):()=>s[t]:t.bind(s,s);let r;ee(e)?r=e:(r=e.handler,n=e);const o=$s(this),l=Mc(i,r.bind(s),n);return o(),l}function Oc(t,e){const n=e.split(".");return()=>{let s=t;for(let i=0;i<n.length&&s;i++)s=s[n[i]];return s}}const lf=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Xt(e)}Modifiers`]||t[`${In(e)}Modifiers`];function af(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||_e;let i=n;const r=e.startsWith("update:"),o=r&&lf(s,e.slice(7));o&&(o.trim&&(i=n.map(u=>xe(u)?u.trim():u)),o.number&&(i=n.map(ui)));let l,a=s[l=hr(e)]||s[l=hr(Xt(e))];!a&&r&&(a=s[l=hr(In(e))]),a&&St(a,t,6,i);const c=s[l+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[l])return;t.emitted[l]=!0,St(c,t,6,i)}}function kc(t,e,n=!1){const s=e.emitsCache,i=s.get(t);if(i!==void 0)return i;const r=t.emits;let o={},l=!1;if(!ee(t)){const a=c=>{const u=kc(c,e,!0);u&&(l=!0,Ve(o,u))};!n&&e.mixins.length&&e.mixins.forEach(a),t.extends&&a(t.extends),t.mixins&&t.mixins.forEach(a)}return!r&&!l?(Ce(t)&&s.set(t,null),null):(G(r)?r.forEach(a=>o[a]=null):Ve(o,r),Ce(t)&&s.set(t,o),o)}function Gi(t,e){return!t||!Fi(e)?!1:(e=e.slice(2).replace(/Once$/,""),he(t,e[0].toLowerCase()+e.slice(1))||he(t,In(e))||he(t,e))}function bl(t){const{type:e,vnode:n,proxy:s,withProxy:i,propsOptions:[r],slots:o,attrs:l,emit:a,render:c,renderCache:u,props:h,data:d,setupState:_,ctx:g,inheritAttrs:m}=t,E=fi(t);let x,P;try{if(n.shapeFlag&4){const v=i||s,C=v;x=bt(c.call(C,v,u,h,_,d,g)),P=l}else{const v=e;x=bt(v.length>1?v(h,{attrs:l,slots:o,emit:a}):v(h,null)),P=e.props?l:cf(l)}}catch(v){hs.length=0,Yi(v,t,1),x=Te(Cn)}let w=x;if(P&&m!==!1){const v=Object.keys(P),{shapeFlag:C}=w;v.length&&C&7&&(r&&v.some(lo)&&(P=uf(P,r)),w=Hn(w,P,!1,!0))}return n.dirs&&(w=Hn(w,null,!1,!0),w.dirs=w.dirs?w.dirs.concat(n.dirs):n.dirs),n.transition&&yo(w,n.transition),x=w,fi(E),x}const cf=t=>{let e;for(const n in t)(n==="class"||n==="style"||Fi(n))&&((e||(e={}))[n]=t[n]);return e},uf=(t,e)=>{const n={};for(const s in t)(!lo(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function hf(t,e,n){const{props:s,children:i,component:r}=t,{props:o,children:l,patchFlag:a}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&a>=0){if(a&1024)return!0;if(a&16)return s?Cl(s,o,c):!!o;if(a&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==s[d]&&!Gi(c,d))return!0}}}else return(i||l)&&(!l||!l.$stable)?!0:s===o?!1:s?o?Cl(s,o,c):!0:!!o;return!1}function Cl(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(e[r]!==t[r]&&!Gi(n,r))return!0}return!1}function df({vnode:t,parent:e},n){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=n,e=e.parent;else break}}const Lc=t=>t.__isSuspense;function ff(t,e){e&&e.pendingBranch?G(t)?e.effects.push(...t):e.effects.push(t):Ed(t)}const we=Symbol.for("v-fgt"),Ki=Symbol.for("v-txt"),Cn=Symbol.for("v-cmt"),si=Symbol.for("v-stc"),hs=[];let tt=null;function B(t=!1){hs.push(tt=t?null:[])}function pf(){hs.pop(),tt=hs[hs.length-1]||null}let Cs=1;function wl(t,e=!1){Cs+=t,t<0&&tt&&e&&(tt.hasOnce=!0)}function $c(t){return t.dynamicChildren=Cs>0?tt||Pn:null,pf(),Cs>0&&tt&&tt.push(t),t}function j(t,e,n,s,i,r){return $c(y(t,e,n,s,i,r,!0))}function Nn(t,e,n,s,i){return $c(Te(t,e,n,s,i,!0))}function Fc(t){return t?t.__v_isVNode===!0:!1}function Zn(t,e){return t.type===e.type&&t.key===e.key}const Uc=({key:t})=>t??null,ii=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?xe(t)||Fe(t)||ee(t)?{i:rt,r:t,k:e,f:!!n}:t:null);function y(t,e=null,n=null,s=0,i=null,r=t===we?0:1,o=!1,l=!1){const a={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Uc(e),ref:e&&ii(e),scopeId:pc,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:rt};return l?(Co(a,n),r&128&&t.normalize(a)):n&&(a.shapeFlag|=xe(n)?8:16),Cs>0&&!o&&tt&&(a.patchFlag>0||r&6)&&a.patchFlag!==32&&tt.push(a),a}const Te=_f;function _f(t,e=null,n=null,s=0,i=null,r=!1){if((!t||t===$d)&&(t=Cn),Fc(t)){const l=Hn(t,e,!0);return n&&Co(l,n),Cs>0&&!r&&tt&&(l.shapeFlag&6?tt[tt.indexOf(t)]=l:tt.push(l)),l.patchFlag=-2,l}if(Tf(t)&&(t=t.__vccOpts),e){e=mf(e);let{class:l,style:a}=e;l&&!xe(l)&&(e.class=je(l)),Ce(a)&&(go(a)&&!G(a)&&(a=Ve({},a)),e.style=Yn(a))}const o=xe(t)?1:Lc(t)?128:Td(t)?64:Ce(t)?4:ee(t)?2:0;return y(t,e,n,s,i,o,r,!0)}function mf(t){return t?go(t)||Sc(t)?Ve({},t):t:null}function Hn(t,e,n=!1,s=!1){const{props:i,ref:r,patchFlag:o,children:l,transition:a}=t,c=e?vf(i||{},e):i,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&Uc(c),ref:e&&e.ref?n&&r?G(r)?r.concat(ii(e)):[r,ii(e)]:ii(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==we?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:a,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Hn(t.ssContent),ssFallback:t.ssFallback&&Hn(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return a&&s&&yo(u,a.clone(u)),u}function Bc(t=" ",e=0){return Te(Ki,null,t,e)}function gf(t,e){const n=Te(si,null,t);return n.staticCount=e,n}function ot(t="",e=!1){return e?(B(),Nn(Cn,null,t)):Te(Cn,null,t)}function bt(t){return t==null||typeof t=="boolean"?Te(Cn):G(t)?Te(we,null,t.slice()):Fc(t)?Yt(t):Te(Ki,null,String(t))}function Yt(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Hn(t)}function Co(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(G(e))n=16;else if(typeof e=="object")if(s&65){const i=e.default;i&&(i._c&&(i._d=!1),Co(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!Sc(e)?e._ctx=rt:i===3&&rt&&(rt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else ee(e)?(e={default:e,_ctx:rt},n=32):(e=String(e),s&64?(n=16,e=[Bc(e)]):n=8);t.children=e,t.shapeFlag|=n}function vf(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const i in s)if(i==="class")e.class!==s.class&&(e.class=je([e.class,s.class]));else if(i==="style")e.style=Yn([e.style,s.style]);else if(Fi(i)){const r=e[i],o=s[i];o&&r!==o&&!(G(r)&&r.includes(o))&&(e[i]=r?[].concat(r,o):o)}else i!==""&&(e[i]=s[i])}return e}function vt(t,e,n,s=null){St(t,e,7,[n,s])}const yf=Cc();let bf=0;function Cf(t,e,n){const s=t.type,i=(e?e.appContext:t.appContext)||yf,r={uid:bf++,vnode:t,type:s,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Yh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Tc(s,i),emitsOptions:kc(s,i),emit:null,emitted:null,propsDefaults:_e,inheritAttrs:s.inheritAttrs,ctx:_e,data:_e,props:_e,attrs:_e,slots:_e,refs:_e,setupState:_e,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=af.bind(null,r),t.ce&&t.ce(r),r}let He=null,mi,Hr;{const t=Hi(),e=(n,s)=>{let i;return(i=t[n])||(i=t[n]=[]),i.push(s),r=>{i.length>1?i.forEach(o=>o(r)):i[0](r)}};mi=e("__VUE_INSTANCE_SETTERS__",n=>He=n),Hr=e("__VUE_SSR_SETTERS__",n=>ws=n)}const $s=t=>{const e=He;return mi(t),t.scope.on(),()=>{t.scope.off(),mi(e)}},El=()=>{He&&He.scope.off(),mi(null)};function Hc(t){return t.vnode.shapeFlag&4}let ws=!1;function wf(t,e=!1,n=!1){e&&Hr(e);const{props:s,children:i}=t.vnode,r=Hc(t);qd(t,s,r,e),Xd(t,i,n);const o=r?Ef(t,e):void 0;return e&&Hr(!1),o}function Ef(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Fd);const{setup:s}=n;if(s){sn();const i=t.setupContext=s.length>1?If(t):null,r=$s(t),o=Ls(s,t,0,[t.props,i]),l=Ua(o);if(rn(),r(),(l||t.sp)&&!cs(t)&&_c(t),l){if(o.then(El,El),e)return o.then(a=>{Sl(t,a)}).catch(a=>{Yi(a,t,0)});t.asyncDep=o}else Sl(t,o)}else Wc(t)}function Sl(t,e,n){ee(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ce(e)&&(t.setupState=ac(e)),Wc(t)}function Wc(t,e,n){const s=t.type;t.render||(t.render=s.render||wt);{const i=$s(t);sn();try{Ud(t)}finally{rn(),i()}}}const Sf={get(t,e){return ke(t,"get",""),t[e]}};function If(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Sf),slots:t.slots,emit:t.emit,expose:e}}function Qi(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(ac(dd(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in us)return us[n](t)},has(e,n){return n in e||n in us}})):t.proxy}function Tf(t){return ee(t)&&"__vccOpts"in t}const Jt=(t,e)=>vd(t,e,ws),xf="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Wr;const Il=typeof window<"u"&&window.trustedTypes;if(Il)try{Wr=Il.createPolicy("vue",{createHTML:t=>t})}catch{}const Vc=Wr?t=>Wr.createHTML(t):t=>t,Rf="http://www.w3.org/2000/svg",Af="http://www.w3.org/1998/Math/MathML",Dt=typeof document<"u"?document:null,Tl=Dt&&Dt.createElement("template"),Nf={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const i=e==="svg"?Dt.createElementNS(Rf,t):e==="mathml"?Dt.createElementNS(Af,t):n?Dt.createElement(t,{is:n}):Dt.createElement(t);return t==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:t=>Dt.createTextNode(t),createComment:t=>Dt.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Dt.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,i,r){const o=n?n.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===r||!(i=i.nextSibling)););else{Tl.innerHTML=Vc(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const l=Tl.content;if(s==="svg"||s==="mathml"){const a=l.firstChild;for(;a.firstChild;)l.appendChild(a.firstChild);l.removeChild(a)}e.insertBefore(l,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},Df=Symbol("_vtc");function Pf(t,e,n){const s=t[Df];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const gi=Symbol("_vod"),jc=Symbol("_vsh"),Yc={beforeMount(t,{value:e},{transition:n}){t[gi]=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):es(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:s}){!e!=!n&&(s?e?(s.beforeEnter(t),es(t,!0),s.enter(t)):s.leave(t,()=>{es(t,!1)}):es(t,e))},beforeUnmount(t,{value:e}){es(t,e)}};function es(t,e){t.style.display=e?t[gi]:"none",t[jc]=!e}const Mf=Symbol(""),Of=/(^|;)\s*display\s*:/;function kf(t,e,n){const s=t.style,i=xe(n);let r=!1;if(n&&!i){if(e)if(xe(e))for(const o of e.split(";")){const l=o.slice(0,o.indexOf(":")).trim();n[l]==null&&ri(s,l,"")}else for(const o in e)n[o]==null&&ri(s,o,"");for(const o in n)o==="display"&&(r=!0),ri(s,o,n[o])}else if(i){if(e!==n){const o=s[Mf];o&&(n+=";"+o),s.cssText=n,r=Of.test(n)}}else e&&t.removeAttribute("style");gi in t&&(t[gi]=r?s.display:"",t[jc]&&(s.display="none"))}const xl=/\s*!important$/;function ri(t,e,n){if(G(n))n.forEach(s=>ri(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=Lf(t,e);xl.test(n)?t.setProperty(In(s),n.replace(xl,""),"important"):t[s]=n}}const Rl=["Webkit","Moz","ms"],vr={};function Lf(t,e){const n=vr[e];if(n)return n;let s=Xt(e);if(s!=="filter"&&s in t)return vr[e]=s;s=Wa(s);for(let i=0;i<Rl.length;i++){const r=Rl[i]+s;if(r in t)return vr[e]=r}return e}const Al="http://www.w3.org/1999/xlink";function Nl(t,e,n,s,i,r=Wh(e)){s&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Al,e.slice(6,e.length)):t.setAttributeNS(Al,e,n):n==null||r&&!ja(n)?t.removeAttribute(e):t.setAttribute(e,r?"":Et(n)?String(n):n)}function Dl(t,e,n,s,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Vc(n):n);return}const r=t.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const l=r==="OPTION"?t.getAttribute("value")||"":t.value,a=n==null?t.type==="checkbox"?"on":"":String(n);(l!==a||!("_value"in t))&&(t.value=a),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=ja(n):n==null&&l==="string"?(n="",o=!0):l==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(i||e)}function fn(t,e,n,s){t.addEventListener(e,n,s)}function $f(t,e,n,s){t.removeEventListener(e,n,s)}const Pl=Symbol("_vei");function Ff(t,e,n,s,i=null){const r=t[Pl]||(t[Pl]={}),o=r[e];if(s&&o)o.value=s;else{const[l,a]=Uf(e);if(s){const c=r[e]=Wf(s,i);fn(t,l,c,a)}else o&&($f(t,l,o,a),r[e]=void 0)}}const Ml=/(?:Once|Passive|Capture)$/;function Uf(t){let e;if(Ml.test(t)){e={};let s;for(;s=t.match(Ml);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):In(t.slice(2)),e]}let yr=0;const Bf=Promise.resolve(),Hf=()=>yr||(Bf.then(()=>yr=0),yr=Date.now());function Wf(t,e){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;St(Vf(s,n.value),e,5,[s])};return n.value=t,n.attached=Hf(),n}function Vf(t,e){if(G(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>i=>!i._stopped&&s&&s(i))}else return e}const Ol=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,jf=(t,e,n,s,i,r)=>{const o=i==="svg";e==="class"?Pf(t,s,o):e==="style"?kf(t,n,s):Fi(e)?lo(e)||Ff(t,e,n,s,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Yf(t,e,s,o))?(Dl(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Nl(t,e,s,o,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!xe(s))?Dl(t,Xt(e),s,r,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),Nl(t,e,s,o))};function Yf(t,e,n,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&Ol(e)&&ee(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Ol(e)&&xe(n)?!1:e in t}const vi=t=>{const e=t.props["onUpdate:modelValue"]||!1;return G(e)?n=>ti(e,n):e};function zf(t){t.target.composing=!0}function kl(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const $n=Symbol("_assign"),vn={created(t,{modifiers:{lazy:e,trim:n,number:s}},i){t[$n]=vi(i);const r=s||i.props&&i.props.type==="number";fn(t,e?"change":"input",o=>{if(o.target.composing)return;let l=t.value;n&&(l=l.trim()),r&&(l=ui(l)),t[$n](l)}),n&&fn(t,"change",()=>{t.value=t.value.trim()}),e||(fn(t,"compositionstart",zf),fn(t,"compositionend",kl),fn(t,"change",kl))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:s,trim:i,number:r}},o){if(t[$n]=vi(o),t.composing)return;const l=(r||t.type==="number")&&!/^0\d/.test(t.value)?ui(t.value):t.value,a=e??"";l!==a&&(document.activeElement===t&&t.type!=="range"&&(s&&e===n||i&&t.value.trim()===a)||(t.value=a))}},Ll={deep:!0,created(t,{value:e,modifiers:{number:n}},s){const i=Ui(e);fn(t,"change",()=>{const r=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?ui(yi(o)):yi(o));t[$n](t.multiple?i?new Set(r):r:r[0]),t._assigning=!0,uc(()=>{t._assigning=!1})}),t[$n]=vi(s)},mounted(t,{value:e}){$l(t,e)},beforeUpdate(t,e,n){t[$n]=vi(n)},updated(t,{value:e}){t._assigning||$l(t,e)}};function $l(t,e){const n=t.multiple,s=G(e);if(!(n&&!s&&!Ui(e))){for(let i=0,r=t.options.length;i<r;i++){const o=t.options[i],l=yi(o);if(n)if(s){const a=typeof l;a==="string"||a==="number"?o.selected=e.some(c=>String(c)===String(l)):o.selected=jh(e,l)>-1}else o.selected=e.has(l);else if(Wi(yi(o),e)){t.selectedIndex!==i&&(t.selectedIndex=i);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function yi(t){return"_value"in t?t._value:t.value}const qf=["ctrl","shift","alt","meta"],Gf={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>qf.some(n=>t[`${n}Key`]&&!e.includes(n))},zc=(t,e)=>{const n=t._withMods||(t._withMods={}),s=e.join(".");return n[s]||(n[s]=(i,...r)=>{for(let o=0;o<e.length;o++){const l=Gf[e[o]];if(l&&l(i,e))return}return t(i,...r)})},Kf=Ve({patchProp:jf},Nf);let Fl;function Qf(){return Fl||(Fl=Zd(Kf))}const Xf=(...t)=>{const e=Qf().createApp(...t),{mount:n}=e;return e.mount=s=>{const i=Zf(s);if(!i)return;const r=e._component;!ee(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=n(i,!1,Jf(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function Jf(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Zf(t){return xe(t)?document.querySelector(t):t}const ep={class:"header"},tp=["onClick"],np={__name:"Header",props:{activeIndex:{type:Number,default:0}},emits:["update:activeIndex"],setup(t,{emit:e}){const n=e,s=X(["首页","记仇本","纪念日","访客留言"]),i=r=>{n("update:activeIndex",r)};return(r,o)=>(B(),j("section",ep,[(B(!0),j(we,null,nt(s.value,(l,a)=>(B(),j("p",{class:je(["title",[a===t.activeIndex?"active":""]]),key:a,onClick:c=>i(a)},fe(l),11,tp))),128))]))}},Qe=(t,e)=>{const n=t.__vccOpts||t;for(const[s,i]of e)n[s]=i;return n},sp={__name:"BgmPlayer",setup(t){const e=X(!1),n=X(null);function s(){e.value?n.value.pause():n.value.play(),e.value=!e.value}function i(){document.hidden?(n.value.pause(),e.value=!1):e.value&&n.value.play()}return Wt(()=>{document.addEventListener("visibilitychange",i)}),qi(()=>{document.removeEventListener("visibilitychange",i)}),(r,o)=>(B(),j("div",null,[y("audio",{ref_key:"audioPlayer",ref:n,src:"https://lf3-static.bytednsdoc.com/obj/eden-cn/ffseh7bfubfbps/bgm.mp3",loop:""},null,512),y("div",{class:je(["bgm_icon",{rotate:e.value}]),onClick:s},null,2)]))}},ip=Qe(sp,[["__scopeId","data-v-2cde0a74"]]),rp=()=>{};var Ul={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qc={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D=function(t,e){if(!t)throw zn(e)},zn=function(t){return new Error("Firebase Database ("+qc.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gc=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},op=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],o=t[n++],l=t[n++],a=((i&7)<<18|(r&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(a>>10)),e[s++]=String.fromCharCode(56320+(a&1023))}else{const r=t[n++],o=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return e.join("")},wo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],o=i+1<t.length,l=o?t[i+1]:0,a=i+2<t.length,c=a?t[i+2]:0,u=r>>2,h=(r&3)<<4|l>>4;let d=(l&15)<<2|c>>6,_=c&63;a||(_=64,o||(d=64)),s.push(n[u],n[h],n[d],n[_])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Gc(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):op(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||l==null||c==null||h==null)throw new lp;const d=r<<2|l>>4;if(s.push(d),c!==64){const _=l<<4&240|c>>2;if(s.push(_),h!==64){const g=c<<6&192|h;s.push(g)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class lp extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Kc=function(t){const e=Gc(t);return wo.encodeByteArray(e,!0)},bi=function(t){return Kc(t).replace(/\./g,"")},Vr=function(t){try{return wo.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ap(t){return Qc(void 0,t)}function Qc(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!cp(n)||(t[n]=Qc(t[n],e[n]));return t}function cp(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function up(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hp=()=>up().__FIREBASE_DEFAULTS__,dp=()=>{if(typeof process>"u"||typeof Ul>"u")return;const t=Ul.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},fp=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Vr(t[1]);return e&&JSON.parse(e)},Xc=()=>{try{return rp()||hp()||dp()||fp()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},pp=t=>{var e,n;return(n=(e=Xc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},_p=t=>{const e=pp(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Jc=()=>{var t;return(t=Xc())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eo(t){return t.endsWith(".cloudworkstations.dev")}async function mp(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gp(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[bi(JSON.stringify(n)),bi(JSON.stringify(o)),""].join(".")}const ds={};function vp(){const t={prod:[],emulator:[]};for(const e of Object.keys(ds))ds[e]?t.emulator.push(e):t.prod.push(e);return t}function yp(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Bl=!1;function Zc(t,e){if(typeof window>"u"||typeof document>"u"||!Eo(window.location.host)||ds[t]===e||ds[t]||Bl)return;ds[t]=e;function n(d){return`__firebase__banner__${d}`}const s="__firebase__banner",r=vp().prod.length>0;function o(){const d=document.getElementById(s);d&&d.remove()}function l(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="absolute",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function a(d,_){d.setAttribute("width","24"),d.setAttribute("id",_),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{Bl=!0,o()},d}function u(d,_){d.setAttribute("id",_),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=yp(s),_=n("text"),g=document.getElementById(_)||document.createElement("span"),m=n("learnmore"),E=document.getElementById(m)||document.createElement("a"),x=n("preprendIcon"),P=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const w=d.element;l(w),u(E,m);const v=c();a(P,x),w.append(P,g,E,v),document.body.appendChild(w)}r?(g.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function eu(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(bp())}function Cp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wp(){return qc.NODE_ADMIN===!0}function Ep(){try{return typeof indexedDB=="object"}catch{return!1}}function Sp(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var r;e(((r=i.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip="FirebaseError";class Fs extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=Ip,Object.setPrototypeOf(this,Fs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,tu.prototype.create)}}class tu{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?Tp(r,s):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Fs(i,l,s)}}function Tp(t,e){return t.replace(xp,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const xp=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Es(t){return JSON.parse(t)}function Re(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nu=function(t){let e={},n={},s={},i="";try{const r=t.split(".");e=Es(Vr(r[0])||""),n=Es(Vr(r[1])||""),i=r[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:i}},Rp=function(t){const e=nu(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},Ap=function(t){const e=nu(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Wn(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Hl(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ci(t,e,n){const s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s}function wi(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],o=e[i];if(Wl(r)&&Wl(o)){if(!wi(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function Wl(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Np(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)s[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)s[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=s[h-3]^s[h-8]^s[h-14]^s[h-16];s[h]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],r=this.chain_[1],o=this.chain_[2],l=this.chain_[3],a=this.chain_[4],c,u;for(let h=0;h<80;h++){h<40?h<20?(c=l^r&(o^l),u=1518500249):(c=r^o^l,u=1859775393):h<60?(c=r&o|l&(r|o),u=2400959708):(c=r^o^l,u=3395469782);const d=(i<<5|i>>>27)+c+a+u+s[h]&4294967295;a=l,l=o,o=(r<<30|r>>>2)&4294967295,r=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+a&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let i=0;const r=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(r[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}else for(;i<n;)if(r[o]=e[i],++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let r=24;r>=0;r-=8)e[s]=this.chain_[i]>>r&255,++s;return e}}function So(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pp=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);if(i>=55296&&i<=56319){const r=i-55296;s++,D(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;i=65536+(r<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Ji=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function on(t){return t&&t._delegate?t._delegate:t}class Ss{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Xi;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kp(e))try{this.getOrInitializeService({instanceIdentifier:hn})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=hn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=hn){return this.instances.has(e)}getOptions(e=hn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(r);s===l&&o.resolve(i)}return i}onInit(e,n){var s;const i=this.normalizeInstanceIdentifier(n),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:Op(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=hn){return this.component?this.component.multipleInstances?e:hn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Op(t){return t===hn?void 0:t}function kp(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Mp(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ve;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ve||(ve={}));const $p={debug:ve.DEBUG,verbose:ve.VERBOSE,info:ve.INFO,warn:ve.WARN,error:ve.ERROR,silent:ve.SILENT},Fp=ve.INFO,Up={[ve.DEBUG]:"log",[ve.VERBOSE]:"log",[ve.INFO]:"info",[ve.WARN]:"warn",[ve.ERROR]:"error"},Bp=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=Up[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class su{constructor(e){this.name=e,this._logLevel=Fp,this._logHandler=Bp,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$p[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ve.DEBUG,...e),this._logHandler(this,ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ve.VERBOSE,...e),this._logHandler(this,ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ve.INFO,...e),this._logHandler(this,ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ve.WARN,...e),this._logHandler(this,ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ve.ERROR,...e),this._logHandler(this,ve.ERROR,...e)}}const Hp=(t,e)=>e.some(n=>t instanceof n);let Vl,jl;function Wp(){return Vl||(Vl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Vp(){return jl||(jl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iu=new WeakMap,jr=new WeakMap,ru=new WeakMap,br=new WeakMap,Io=new WeakMap;function jp(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",o)},r=()=>{n(qt(t.result)),i()},o=()=>{s(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&iu.set(n,t)}).catch(()=>{}),Io.set(e,t),e}function Yp(t){if(jr.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",o),t.removeEventListener("abort",o)},r=()=>{n(),i()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",o),t.addEventListener("abort",o)});jr.set(t,e)}let Yr={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return jr.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ru.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return qt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function zp(t){Yr=t(Yr)}function qp(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Cr(this),e,...n);return ru.set(s,e.sort?e.sort():[e]),qt(s)}:Vp().includes(t)?function(...e){return t.apply(Cr(this),e),qt(iu.get(this))}:function(...e){return qt(t.apply(Cr(this),e))}}function Gp(t){return typeof t=="function"?qp(t):(t instanceof IDBTransaction&&Yp(t),Hp(t,Wp())?new Proxy(t,Yr):t)}function qt(t){if(t instanceof IDBRequest)return jp(t);if(br.has(t))return br.get(t);const e=Gp(t);return e!==t&&(br.set(t,e),Io.set(e,t)),e}const Cr=t=>Io.get(t);function Kp(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(t,e),l=qt(o);return s&&o.addEventListener("upgradeneeded",a=>{s(qt(o.result),a.oldVersion,a.newVersion,qt(o.transaction),a)}),n&&o.addEventListener("blocked",a=>n(a.oldVersion,a.newVersion,a)),l.then(a=>{r&&a.addEventListener("close",()=>r()),i&&a.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const Qp=["get","getKey","getAll","getAllKeys","count"],Xp=["put","add","delete","clear"],wr=new Map;function Yl(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(wr.get(e))return wr.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=Xp.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||Qp.includes(n)))return;const r=async function(o,...l){const a=this.transaction(o,i?"readwrite":"readonly");let c=a.store;return s&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),i&&a.done]))[0]};return wr.set(e,r),r}zp(t=>({...t,get:(e,n,s)=>Yl(e,n)||t.get(e,n,s),has:(e,n)=>!!Yl(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Zp(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function Zp(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const zr="@firebase/app",zl="0.12.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ut=new su("@firebase/app"),e_="@firebase/app-compat",t_="@firebase/analytics-compat",n_="@firebase/analytics",s_="@firebase/app-check-compat",i_="@firebase/app-check",r_="@firebase/auth",o_="@firebase/auth-compat",l_="@firebase/database",a_="@firebase/data-connect",c_="@firebase/database-compat",u_="@firebase/functions",h_="@firebase/functions-compat",d_="@firebase/installations",f_="@firebase/installations-compat",p_="@firebase/messaging",__="@firebase/messaging-compat",m_="@firebase/performance",g_="@firebase/performance-compat",v_="@firebase/remote-config",y_="@firebase/remote-config-compat",b_="@firebase/storage",C_="@firebase/storage-compat",w_="@firebase/firestore",E_="@firebase/vertexai",S_="@firebase/firestore-compat",I_="firebase",T_="11.7.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qr="[DEFAULT]",x_={[zr]:"fire-core",[e_]:"fire-core-compat",[n_]:"fire-analytics",[t_]:"fire-analytics-compat",[i_]:"fire-app-check",[s_]:"fire-app-check-compat",[r_]:"fire-auth",[o_]:"fire-auth-compat",[l_]:"fire-rtdb",[a_]:"fire-data-connect",[c_]:"fire-rtdb-compat",[u_]:"fire-fn",[h_]:"fire-fn-compat",[d_]:"fire-iid",[f_]:"fire-iid-compat",[p_]:"fire-fcm",[__]:"fire-fcm-compat",[m_]:"fire-perf",[g_]:"fire-perf-compat",[v_]:"fire-rc",[y_]:"fire-rc-compat",[b_]:"fire-gcs",[C_]:"fire-gcs-compat",[w_]:"fire-fst",[S_]:"fire-fst-compat",[E_]:"fire-vertex","fire-js":"fire-js",[I_]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei=new Map,R_=new Map,Gr=new Map;function ql(t,e){try{t.container.addComponent(e)}catch(n){Ut.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Si(t){const e=t.name;if(Gr.has(e))return Ut.debug(`There were multiple attempts to register component ${e}.`),!1;Gr.set(e,t);for(const n of Ei.values())ql(n,t);for(const n of R_.values())ql(n,t);return!0}function A_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function N_(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Gt=new tu("app","Firebase",D_);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Ss("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gt.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_=T_;function ou(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:qr,automaticDataCollectionEnabled:!1},e),i=s.name;if(typeof i!="string"||!i)throw Gt.create("bad-app-name",{appName:String(i)});if(n||(n=Jc()),!n)throw Gt.create("no-options");const r=Ei.get(i);if(r){if(wi(n,r.options)&&wi(s,r.config))return r;throw Gt.create("duplicate-app",{appName:i})}const o=new Lp(i);for(const a of Gr.values())o.addComponent(a);const l=new P_(n,s,o);return Ei.set(i,l),l}function O_(t=qr){const e=Ei.get(t);if(!e&&t===qr&&Jc())return ou();if(!e)throw Gt.create("no-app",{appName:t});return e}function Fn(t,e,n){var s;let i=(s=x_[t])!==null&&s!==void 0?s:t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const l=[`Unable to register library "${i}" with version "${e}":`];r&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ut.warn(l.join(" "));return}Si(new Ss(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_="firebase-heartbeat-database",L_=1,Is="firebase-heartbeat-store";let Er=null;function lu(){return Er||(Er=Kp(k_,L_,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Is)}catch(n){console.warn(n)}}}}).catch(t=>{throw Gt.create("idb-open",{originalErrorMessage:t.message})})),Er}async function $_(t){try{const n=(await lu()).transaction(Is),s=await n.objectStore(Is).get(au(t));return await n.done,s}catch(e){if(e instanceof Fs)Ut.warn(e.message);else{const n=Gt.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ut.warn(n.message)}}}async function Gl(t,e){try{const s=(await lu()).transaction(Is,"readwrite");await s.objectStore(Is).put(e,au(t)),await s.done}catch(n){if(n instanceof Fs)Ut.warn(n.message);else{const s=Gt.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ut.warn(s.message)}}}function au(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=1024,U_=30;class B_{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new W_(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Kl();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats.length>U_){const o=V_(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Ut.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Kl(),{heartbeatsToSend:s,unsentEntries:i}=H_(this._heartbeatsCache.heartbeats),r=bi(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return Ut.warn(n),""}}}function Kl(){return new Date().toISOString().substring(0,10)}function H_(t,e=F_){const n=[];let s=t.slice();for(const i of t){const r=n.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),Ql(n)>e){r.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ql(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class W_{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ep()?Sp().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await $_(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Gl(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Gl(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Ql(t){return bi(JSON.stringify({version:2,heartbeats:t})).length}function V_(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j_(t){Si(new Ss("platform-logger",e=>new Jp(e),"PRIVATE")),Si(new Ss("heartbeat",e=>new B_(e),"PRIVATE")),Fn(zr,zl,t),Fn(zr,zl,"esm2017"),Fn("fire-js","")}j_("");var Xl={};const Jl="@firebase/database",Zl="1.0.16";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cu="";function Y_(t){cu=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Re(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Es(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Tt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uu=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new z_(e)}}catch{}return new q_},pn=uu("localStorage"),G_=uu("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Un=new su("@firebase/database"),K_=function(){let t=1;return function(){return t++}}(),hu=function(t){const e=Pp(t),n=new Dp;n.update(e);const s=n.digest();return wo.encodeByteArray(s)},Us=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=Us.apply(null,s):typeof s=="object"?e+=Re(s):e+=s,e+=" "}return e};let fs=null,ea=!0;const Q_=function(t,e){D(!0,"Can't turn on custom loggers persistently."),Un.logLevel=ve.VERBOSE,fs=Un.log.bind(Un)},$e=function(...t){if(ea===!0&&(ea=!1,fs===null&&G_.get("logging_enabled")===!0&&Q_()),fs){const e=Us.apply(null,t);fs(e)}},Bs=function(t){return function(...e){$e(t,...e)}},Kr=function(...t){const e="FIREBASE INTERNAL ERROR: "+Us(...t);Un.error(e)},Bt=function(...t){const e=`FIREBASE FATAL ERROR: ${Us(...t)}`;throw Un.error(e),new Error(e)},Ge=function(...t){const e="FIREBASE WARNING: "+Us(...t);Un.warn(e)},X_=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ge("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},To=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},J_=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},wn="[MIN_NAME]",Zt="[MAX_NAME]",qn=function(t,e){if(t===e)return 0;if(t===wn||e===Zt)return-1;if(e===wn||t===Zt)return 1;{const n=ta(t),s=ta(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},Z_=function(t,e){return t===e?0:t<e?-1:1},ts=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Re(e))},xo=function(t){if(typeof t!="object"||t===null)return Re(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=Re(e[s]),n+=":",n+=xo(t[e[s]]);return n+="}",n},du=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let i=0;i<n;i+=e)i+e>n?s.push(t.substring(i,n)):s.push(t.substring(i,i+e));return s};function Ke(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const fu=function(t){D(!To(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let i,r,o,l,a;t===0?(r=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),s),r=l+s,o=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(r=0,o=Math.round(t/Math.pow(2,1-s-n))));const c=[];for(a=n;a;a-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(a=e;a;a-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(i?1:0),c.reverse();const u=c.join("");let h="";for(a=0;a<64;a+=8){let d=parseInt(u.substr(a,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},em=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},tm=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function nm(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const sm=new RegExp("^-?(0*)\\d{1,10}$"),im=-2147483648,rm=2147483647,ta=function(t){if(sm.test(t)){const e=Number(t);if(e>=im&&e<=rm)return e}return null},Gn=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Ge("Exception was thrown by user callback.",n),e},Math.floor(0))}},om=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ps=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,N_(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){Ge(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?($e("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ge(e)}}class oi{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}oi.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro="5",pu="v",_u="s",mu="r",gu="f",vu=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,yu="ls",bu="p",Qr="ac",Cu="websocket",wu="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e,n,s,i,r=!1,o="",l=!1,a=!1,c=null){this.secure=n,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=a,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=pn.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&pn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function cm(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Su(t,e,n){D(typeof e=="string","typeof type must == string"),D(typeof n=="object","typeof params must == object");let s;if(e===Cu)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===wu)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);cm(t)&&(n.ns=t.namespace);const i=[];return Ke(n,(r,o)=>{i.push(r+"="+o)}),s+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(){this.counters_={}}incrementCounter(e,n=1){Tt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return ap(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr={},Ir={};function Ao(t){const e=t.toString();return Sr[e]||(Sr[e]=new um),Sr[e]}function hm(t,e){const n=t.toString();return Ir[n]||(Ir[n]=e()),Ir[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&Gn(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na="start",fm="close",pm="pLPCommand",_m="pRTLPCB",Iu="id",Tu="pw",xu="ser",mm="cb",gm="seg",vm="ts",ym="d",bm="dframe",Ru=1870,Au=30,Cm=Ru-Au,wm=25e3,Em=3e4;class Dn{constructor(e,n,s,i,r,o,l){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Bs(e),this.stats_=Ao(n),this.urlFn=a=>(this.appCheckToken&&(a[Qr]=this.appCheckToken),Su(n,wu,a))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new dm(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Em)),J_(()=>{if(this.isClosed_)return;this.scriptTagHolder=new No((...r)=>{const[o,l,a,c,u]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===na)this.id=l,this.password=a;else if(o===fm)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,l]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const s={};s[na]="t",s[xu]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[mm]=this.scriptTagHolder.uniqueCallbackIdentifier),s[pu]=Ro,this.transportSessionId&&(s[_u]=this.transportSessionId),this.lastSessionId&&(s[yu]=this.lastSessionId),this.applicationId&&(s[bu]=this.applicationId),this.appCheckToken&&(s[Qr]=this.appCheckToken),typeof location<"u"&&location.hostname&&vu.test(location.hostname)&&(s[mu]=gu);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Dn.forceAllow_=!0}static forceDisallow(){Dn.forceDisallow_=!0}static isAvailable(){return Dn.forceAllow_?!0:!Dn.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!em()&&!tm()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Re(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=Kc(n),i=du(s,Cm);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[bm]="t",s[Iu]=e,s[Tu]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Re(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class No{constructor(e,n,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=K_(),window[pm+this.uniqueCallbackIdentifier]=e,window[_m+this.uniqueCallbackIdentifier]=n,this.myIFrame=No.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){$e("frame writing exception"),l.stack&&$e(l.stack),$e(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||$e("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Iu]=this.myID,e[Tu]=this.myPW,e[xu]=this.currentSerial;let n=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Au+s.length<=Ru;){const o=this.pendingSegs.shift();s=s+"&"+gm+i+"="+o.seg+"&"+vm+i+"="+o.ts+"&"+ym+i+"="+o.d,i++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(s,Math.floor(wm)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{$e("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm=16384,Im=45e3;let Ii=null;typeof MozWebSocket<"u"?Ii=MozWebSocket:typeof WebSocket<"u"&&(Ii=WebSocket);class at{constructor(e,n,s,i,r,o,l){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Bs(this.connId),this.stats_=Ao(n),this.connURL=at.connectionURL_(n,o,l,i,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,i,r){const o={};return o[pu]=Ro,typeof location<"u"&&location.hostname&&vu.test(location.hostname)&&(o[mu]=gu),n&&(o[_u]=n),s&&(o[yu]=s),i&&(o[Qr]=i),r&&(o[bu]=r),Su(e,Cu,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,pn.set("previous_websocket_failure",!0);try{let s;wp(),this.mySock=new Ii(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){at.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&Ii!==null&&!at.forceDisallow_}static previouslyFailed(){return pn.isInMemoryStorage||pn.get("previous_websocket_failure")===!0}markConnectionHealthy(){pn.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=Es(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(D(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=Re(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=du(n,Sm);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Im))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}at.responsesRequiredToBeHealthy=2;at.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{static get ALL_TRANSPORTS(){return[Dn,at]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=at&&at.isAvailable();let s=n&&!at.previouslyFailed();if(e.webSocketOnly&&(n||Ge("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[at];else{const i=this.transports_=[];for(const r of Ts.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r);Ts.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ts.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tm=6e4,xm=5e3,Rm=10*1024,Am=100*1024,Tr="t",sa="d",Nm="s",ia="r",Dm="e",ra="o",oa="a",la="n",aa="p",Pm="h";class Mm{constructor(e,n,s,i,r,o,l,a,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Bs("c:"+this.id+":"),this.transportManager_=new Ts(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=ps(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Am?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Rm?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Tr in e){const n=e[Tr];n===oa?this.upgradeIfSecondaryHealthy_():n===ia?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===ra&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=ts("t",e),s=ts("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:aa,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:oa,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:la,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=ts("t",e),s=ts("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=ts(Tr,e);if(sa in e){const s=e[sa];if(n===Pm){const i=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===la){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===Nm?this.onConnectionShutdown_(s):n===ia?this.onReset_(s):n===Dm?Kr("Server Error: "+s):n===ra?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Kr("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Ro!==s&&Ge("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),ps(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Tm))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ps(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(xm))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:aa,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(pn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{put(e,n,s,i){}merge(e,n,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e){this.allowedEvents_=e,this.listeners_={},D(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const i=this.getInitialEvent(e);i&&n.apply(s,i)}off(e,n,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===n&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){D(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti extends Du{static getInstance(){return new Ti}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!eu()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return D(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ca=32,ua=768;class pe{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function ae(){return new pe("")}function ne(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function en(t){return t.pieces_.length-t.pieceNum_}function ye(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new pe(t.pieces_,e)}function Pu(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Om(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Mu(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Ou(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new pe(e,0)}function Ae(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof pe)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&n.push(s[i])}return new pe(n,0)}function se(t){return t.pieceNum_>=t.pieces_.length}function We(t,e){const n=ne(t),s=ne(e);if(n===null)return e;if(n===s)return We(ye(t),ye(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Do(t,e){if(en(t)!==en(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function ct(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(en(t)>en(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class km{constructor(e,n){this.errorPrefix_=n,this.parts_=Mu(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Ji(this.parts_[s]);ku(this)}}function Lm(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Ji(e),ku(t)}function $m(t){const e=t.parts_.pop();t.byteLength_-=Ji(e),t.parts_.length>0&&(t.byteLength_-=1)}function ku(t){if(t.byteLength_>ua)throw new Error(t.errorPrefix_+"has a key path longer than "+ua+" bytes ("+t.byteLength_+").");if(t.parts_.length>ca)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ca+") or object contains a cycle "+dn(t))}function dn(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po extends Du{static getInstance(){return new Po}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return D(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns=1e3,Fm=60*5*1e3,ha=30*1e3,Um=1.3,Bm=3e4,Hm="server_kill",da=3;class $t extends Nu{constructor(e,n,s,i,r,o,l,a){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=a,this.id=$t.nextPersistentConnectionId_++,this.log_=Bs("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ns,this.maxReconnectDelay_=Fm,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Po.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Ti.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const i=++this.requestNumber_,r={r:i,a:e,b:n};this.log_(Re(r)),D(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const n=new Xi,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,s,i){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),D(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),D(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const l={onComplete:i,hashFn:n,query:e,tag:s};this.listens.get(o).set(r,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},o="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,l=>{const a=l.d,c=l.s;$t.warnOnListenWarnings_(a,n),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",l),c!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(c,a))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Tt(e,"w")){const s=Wn(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();Ge(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Ap(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=ha)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=Rp(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,i=>{const r=i.s,o=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),D(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,n)}sendUnlisten_(e,n,s,i){this.log_("Unlisten on "+e+" for "+n);const r={p:e},o="n";i&&(r.q=s,r.t=i),this.sendRequest(o,r)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,i){const r={p:n,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,s,i){this.putInternal("p",e,n,s,i)}merge(e,n,s,i){this.putInternal("m",e,n,s,i)}putInternal(e,n,s,i,r){this.initConnection_();const o={p:n,d:s};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Re(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Kr("Unrecognized action received from server: "+Re(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){D(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ns,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ns,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Bm&&(this.reconnectDelay_=ns),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Um)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+$t.nextConnectionId_++,r=this.lastSessionId;let o=!1,l=null;const a=function(){l?l.close():(o=!0,s())},c=function(h){D(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(h)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?$e("getToken() completed but was canceled"):($e("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,l=new Mm(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,_=>{Ge(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(Hm)},r))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Ge(h),a())}}}interrupt(e){$e("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){$e("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Hl(this.interruptReasons_)&&(this.reconnectDelay_=ns,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(r=>xo(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const s=new pe(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(n),r.delete(n),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,n){$e("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=da&&(this.reconnectDelay_=ha,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){$e("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=da&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+cu.replace(/\./g,"-")]=1,eu()?e["framework.cordova"]=1:Cp()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Ti.getInstance().currentlyOnline();return Hl(this.interruptReasons_)&&e}}$t.nextPersistentConnectionId_=0;$t.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ie(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new ie(wn,e),i=new ie(wn,n);return this.compare(s,i)!==0}minPost(){return ie.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ks;class Lu extends Zi{static get __EMPTY_NODE(){return Ks}static set __EMPTY_NODE(e){Ks=e}compare(e,n){return qn(e.name,n.name)}isDefinedOn(e){throw zn("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ie.MIN}maxPost(){return new ie(Zt,Ks)}makePost(e,n){return D(typeof e=="string","KeyIndex indexValue must always be a string."),new ie(e,Ks)}toString(){return".key"}}const yn=new Lu;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e,n,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Pe{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s??Pe.RED,this.left=i??qe.EMPTY_NODE,this.right=r??qe.EMPTY_NODE}copy(e,n,s,i,r){return new Pe(e??this.key,n??this.value,s??this.color,i??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return qe.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,i;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return qe.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Pe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Pe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Pe.RED=!0;Pe.BLACK=!1;class Wm{copy(e,n,s,i,r){return this}insert(e,n,s){return new Pe(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class qe{constructor(e,n=qe.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new qe(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Pe.BLACK,null,null))}remove(e){return new qe(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Pe.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,i=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Qs(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Qs(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Qs(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Qs(this.root_,null,this.comparator_,!0,e)}}qe.EMPTY_NODE=new Wm;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vm(t,e){return qn(t.name,e.name)}function Mo(t,e){return qn(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xr;function jm(t){Xr=t}const $u=function(t){return typeof t=="number"?"number:"+fu(t):"string:"+t},Fu=function(t){if(t.isLeafNode()){const e=t.val();D(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Tt(e,".sv"),"Priority must be a string or number.")}else D(t===Xr||t.isEmpty(),"priority of unexpected type.");D(t===Xr||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fa;class De{static set __childrenNodeConstructor(e){fa=e}static get __childrenNodeConstructor(){return fa}constructor(e,n=De.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,D(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Fu(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new De(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:De.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return se(e)?this:ne(e)===".priority"?this.priorityNode_:De.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:De.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=ne(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(D(s!==".priority"||en(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,De.__childrenNodeConstructor.EMPTY_NODE.updateChild(ye(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+$u(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=fu(this.value_):e+=this.value_,this.lazyHash_=hu(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===De.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof De.__childrenNodeConstructor?-1:(D(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,i=De.VALUE_TYPE_ORDER.indexOf(n),r=De.VALUE_TYPE_ORDER.indexOf(s);return D(i>=0,"Unknown leaf type: "+n),D(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}De.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uu,Bu;function Ym(t){Uu=t}function zm(t){Bu=t}class qm extends Zi{compare(e,n){const s=e.node.getPriority(),i=n.node.getPriority(),r=s.compareTo(i);return r===0?qn(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ie.MIN}maxPost(){return new ie(Zt,new De("[PRIORITY-POST]",Bu))}makePost(e,n){const s=Uu(e);return new ie(n,new De("[PRIORITY-POST]",s))}toString(){return".priority"}}const Ee=new qm;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gm=Math.log(2);class Km{constructor(e){const n=r=>parseInt(Math.log(r)/Gm,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const xi=function(t,e,n,s){t.sort(e);const i=function(a,c){const u=c-a;let h,d;if(u===0)return null;if(u===1)return h=t[a],d=n?n(h):h,new Pe(d,h.node,Pe.BLACK,null,null);{const _=parseInt(u/2,10)+a,g=i(a,_),m=i(_+1,c);return h=t[_],d=n?n(h):h,new Pe(d,h.node,Pe.BLACK,g,m)}},r=function(a){let c=null,u=null,h=t.length;const d=function(g,m){const E=h-g,x=h;h-=g;const P=i(E+1,x),w=t[E],v=n?n(w):w;_(new Pe(v,w.node,m,null,P))},_=function(g){c?(c.left=g,c=g):(u=g,c=g)};for(let g=0;g<a.count;++g){const m=a.nextBitIsOne(),E=Math.pow(2,a.count-(g+1));m?d(E,Pe.BLACK):(d(E,Pe.BLACK),d(E,Pe.RED))}return u},o=new Km(t.length),l=r(o);return new qe(s||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xr;const Rn={};class Lt{static get Default(){return D(Rn&&Ee,"ChildrenNode.ts has not been loaded"),xr=xr||new Lt({".priority":Rn},{".priority":Ee}),xr}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=Wn(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof qe?n:null}hasIndex(e){return Tt(this.indexSet_,e.toString())}addIndex(e,n){D(e!==yn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=n.getIterator(ie.Wrap);let o=r.getNext();for(;o;)i=i||e.isDefinedOn(o.node),s.push(o),o=r.getNext();let l;i?l=xi(s,e.getCompare()):l=Rn;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const u=Object.assign({},this.indexes_);return u[a]=l,new Lt(u,c)}addToIndexes(e,n){const s=Ci(this.indexes_,(i,r)=>{const o=Wn(this.indexSet_,r);if(D(o,"Missing index implementation for "+r),i===Rn)if(o.isDefinedOn(e.node)){const l=[],a=n.getIterator(ie.Wrap);let c=a.getNext();for(;c;)c.name!==e.name&&l.push(c),c=a.getNext();return l.push(e),xi(l,o.getCompare())}else return Rn;else{const l=n.get(e.name);let a=i;return l&&(a=a.remove(new ie(e.name,l))),a.insert(e,e.node)}});return new Lt(s,this.indexSet_)}removeFromIndexes(e,n){const s=Ci(this.indexes_,i=>{if(i===Rn)return i;{const r=n.get(e.name);return r?i.remove(new ie(e.name,r)):i}});return new Lt(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ss;class Y{static get EMPTY_NODE(){return ss||(ss=new Y(new qe(Mo),null,Lt.Default))}constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Fu(this.priorityNode_),this.children_.isEmpty()&&D(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ss}updatePriority(e){return this.children_.isEmpty()?this:new Y(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?ss:n}}getChild(e){const n=ne(e);return n===null?this:this.getImmediateChild(n).getChild(ye(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(D(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new ie(e,n);let i,r;n.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(s,this.children_));const o=i.isEmpty()?ss:this.priorityNode_;return new Y(i,o,r)}}updateChild(e,n){const s=ne(e);if(s===null)return n;{D(ne(e)!==".priority"||en(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(ye(e),n);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,i=0,r=!0;if(this.forEachChild(Ee,(o,l)=>{n[o]=l.val(e),s++,r&&Y.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):r=!1}),!e&&r&&i<2*s){const o=[];for(const l in n)o[l]=n[l];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+$u(this.getPriority().val())+":"),this.forEachChild(Ee,(n,s)=>{const i=s.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":hu(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new ie(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ie(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ie(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,ie.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,ie.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Hs?-1:0}withIndex(e){if(e===yn||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new Y(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===yn||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(Ee),i=n.getIterator(Ee);let r=s.getNext(),o=i.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=s.getNext(),o=i.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===yn?null:this.indexMap_.get(e.toString())}}Y.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Qm extends Y{constructor(){super(new qe(Mo),Y.EMPTY_NODE,Lt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Y.EMPTY_NODE}isEmpty(){return!1}}const Hs=new Qm;Object.defineProperties(ie,{MIN:{value:new ie(wn,Y.EMPTY_NODE)},MAX:{value:new ie(Zt,Hs)}});Lu.__EMPTY_NODE=Y.EMPTY_NODE;De.__childrenNodeConstructor=Y;jm(Hs);zm(Hs);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xm=!0;function Me(t,e=null){if(t===null)return Y.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),D(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new De(n,Me(e))}if(!(t instanceof Array)&&Xm){const n=[];let s=!1;if(Ke(t,(o,l)=>{if(o.substring(0,1)!=="."){const a=Me(l);a.isEmpty()||(s=s||!a.getPriority().isEmpty(),n.push(new ie(o,a)))}}),n.length===0)return Y.EMPTY_NODE;const r=xi(n,Vm,o=>o.name,Mo);if(s){const o=xi(n,Ee.getCompare());return new Y(r,Me(e),new Lt({".priority":o},{".priority":Ee}))}else return new Y(r,Me(e),Lt.Default)}else{let n=Y.EMPTY_NODE;return Ke(t,(s,i)=>{if(Tt(t,s)&&s.substring(0,1)!=="."){const r=Me(i);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(s,r))}}),n.updatePriority(Me(e))}}Ym(Me);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo extends Zi{constructor(e){super(),this.indexPath_=e,D(!se(e)&&ne(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),i=this.extractChild(n.node),r=s.compareTo(i);return r===0?qn(e.name,n.name):r}makePost(e,n){const s=Me(e),i=Y.EMPTY_NODE.updateChild(this.indexPath_,s);return new ie(n,i)}maxPost(){const e=Y.EMPTY_NODE.updateChild(this.indexPath_,Hs);return new ie(Zt,e)}toString(){return Mu(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm extends Zi{compare(e,n){const s=e.node.compareTo(n.node);return s===0?qn(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ie.MIN}maxPost(){return ie.MAX}makePost(e,n){const s=Me(e);return new ie(n,s)}toString(){return".value"}}const Hu=new Jm;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(t){return{type:"value",snapshotNode:t}}function Vn(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function xs(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Rs(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function Zm(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e){this.index_=e}updateChild(e,n,s,i,r,o){D(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(i).equals(s.getChild(i))&&l.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(xs(n,l)):D(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(Vn(n,s)):o.trackChildChange(Rs(n,s,l))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(Ee,(i,r)=>{n.hasChild(i)||s.trackChildChange(xs(i,r))}),n.isLeafNode()||n.forEachChild(Ee,(i,r)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(r)||s.trackChildChange(Rs(i,r,o))}else s.trackChildChange(Vn(i,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Y.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e){this.indexedFilter_=new ko(e.getIndex()),this.index_=e.getIndex(),this.startPost_=As.getStartPost_(e),this.endPost_=As.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,i,r,o){return this.matches(new ie(n,s))||(s=Y.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,i,r,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=Y.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(Y.EMPTY_NODE);const r=this;return n.forEachChild(Ee,(o,l)=>{r.matches(new ie(o,l))||(i=i.updateImmediateChild(o,Y.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new As(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,i,r,o){return this.rangedFilter_.matches(new ie(n,s))||(s=Y.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,i,r,o):this.fullLimitUpdateChild_(e,n,s,r,o)}updateFullNode(e,n,s){let i;if(n.isLeafNode()||n.isEmpty())i=Y.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=Y.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;r.hasNext()&&o<this.limit_;){const l=r.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))i=i.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(Y.EMPTY_NODE);let r;this.reverse_?r=i.getReverseIterator(this.index_):r=i.getIterator(this.index_);let o=0;for(;r.hasNext();){const l=r.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:i=i.updateImmediateChild(l.name,Y.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,i,r){let o;if(this.reverse_){const h=this.index_.getCompare();o=(d,_)=>h(_,d)}else o=this.index_.getCompare();const l=e;D(l.numChildren()===this.limit_,"");const a=new ie(n,s),c=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(l.hasChild(n)){const h=l.getImmediateChild(n);let d=i.getChildAfterChild(this.index_,c,this.reverse_);for(;d!=null&&(d.name===n||l.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);const _=d==null?1:o(d,a);if(u&&!s.isEmpty()&&_>=0)return r!=null&&r.trackChildChange(Rs(n,s,h)),l.updateImmediateChild(n,s);{r!=null&&r.trackChildChange(xs(n,h));const m=l.updateImmediateChild(n,Y.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(r!=null&&r.trackChildChange(Vn(d.name,d.node)),m.updateImmediateChild(d.name,d.node)):m}}else return s.isEmpty()?e:u&&o(c,a)>=0?(r!=null&&(r.trackChildChange(xs(c.name,c.node)),r.trackChildChange(Vn(n,s))),l.updateImmediateChild(n,s).updateImmediateChild(c.name,Y.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ee}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return D(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return D(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:wn}hasEnd(){return this.endSet_}getIndexEndValue(){return D(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return D(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Zt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return D(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ee}copy(){const e=new Lo;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function tg(t){return t.loadsAllData()?new ko(t.getIndex()):t.hasLimit()?new eg(t):new As(t)}function ng(t,e,n){const s=t.copy();return s.startSet_=!0,e===void 0&&(e=null),s.indexStartValue_=e,n!=null?(s.startNameSet_=!0,s.indexStartName_=n):(s.startNameSet_=!1,s.indexStartName_=""),s}function sg(t,e,n){const s=t.copy();return s.endSet_=!0,e===void 0&&(e=null),s.indexEndValue_=e,n!==void 0?(s.endNameSet_=!0,s.indexEndName_=n):(s.endNameSet_=!1,s.indexEndName_=""),s}function ig(t,e){const n=t.copy();return n.index_=e,n}function pa(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Ee?n="$priority":t.index_===Hu?n="$value":t.index_===yn?n="$key":(D(t.index_ instanceof Oo,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Re(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=Re(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+Re(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=Re(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+Re(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function _a(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ee&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri extends Nu{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(D(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=Bs("p:rest:"),this.listens_={}}listen(e,n,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=Ri.getListenId_(e,s),l={};this.listens_[o]=l;const a=pa(e._queryParams);this.restRequest_(r+".json",a,(c,u)=>{let h=u;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(r,h,!1,s),Wn(this.listens_,o)===l){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",i(d,null)}})}unlisten(e,n){const s=Ri.getListenId_(e,n);delete this.listens_[s]}get(e){const n=pa(e._queryParams),s=e._path.toString(),i=new Xi;return this.restRequest_(s+".json",n,(r,o)=>{let l=o;r===404&&(l=null,r=null),r===null?(this.onDataUpdate_(s,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(n.auth=i.accessToken),r&&r.token&&(n.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Np(n);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(s&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let a=null;if(l.status>=200&&l.status<300){try{a=Es(l.responseText)}catch{Ge("Failed to parse JSON response for "+o+": "+l.responseText)}s(null,a)}else l.status!==401&&l.status!==404&&Ge("Got unsuccessful REST response for "+o+" Status: "+l.status),s(l.status);s=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(){this.rootNode_=Y.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ai(){return{value:null,children:new Map}}function Vu(t,e,n){if(se(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=ne(e);t.children.has(s)||t.children.set(s,Ai());const i=t.children.get(s);e=ye(e),Vu(i,e,n)}}function Jr(t,e,n){t.value!==null?n(e,t.value):og(t,(s,i)=>{const r=new pe(e.toString()+"/"+s);Jr(i,r,n)})}function og(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Ke(this.last_,(s,i)=>{n[s]=n[s]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ma=10*1e3,ag=30*1e3,cg=5*60*1e3;class ug{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new lg(e);const s=ma+(ag-ma)*Math.random();ps(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;Ke(e,(i,r)=>{r>0&&Tt(this.statsToReport_,i)&&(n[i]=r,s=!0)}),s&&this.server_.reportStats(n),ps(this.reportStats_.bind(this),Math.floor(Math.random()*2*cg))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ut||(ut={}));function ju(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function $o(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Fo(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=ut.ACK_USER_WRITE,this.source=ju()}operationForChild(e){if(se(this.path)){if(this.affectedTree.value!=null)return D(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new pe(e));return new Ni(ae(),n,this.revert)}}else return D(ne(this.path)===e,"operationForChild called for unrelated child."),new Ni(ye(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,n){this.source=e,this.path=n,this.type=ut.LISTEN_COMPLETE}operationForChild(e){return se(this.path)?new Ns(this.source,ae()):new Ns(this.source,ye(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=ut.OVERWRITE}operationForChild(e){return se(this.path)?new En(this.source,ae(),this.snap.getImmediateChild(e)):new En(this.source,ye(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=ut.MERGE}operationForChild(e){if(se(this.path)){const n=this.children.subtree(new pe(e));return n.isEmpty()?null:n.value?new En(this.source,ae(),n.value):new Ds(this.source,ae(),n)}else return D(ne(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ds(this.source,ye(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(se(e))return this.isFullyInitialized()&&!this.filtered_;const n=ne(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function dg(t,e,n,s){const i=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push(Zm(o.childName,o.snapshotNode))}),is(t,i,"child_removed",e,s,n),is(t,i,"child_added",e,s,n),is(t,i,"child_moved",r,s,n),is(t,i,"child_changed",e,s,n),is(t,i,"value",e,s,n),i}function is(t,e,n,s,i,r){const o=s.filter(l=>l.type===n);o.sort((l,a)=>pg(t,l,a)),o.forEach(l=>{const a=fg(t,l,r);i.forEach(c=>{c.respondsTo(l.type)&&e.push(c.createEvent(a,t.query_))})})}function fg(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function pg(t,e,n){if(e.childName==null||n.childName==null)throw zn("Should only compare child_ events.");const s=new ie(e.childName,e.snapshotNode),i=new ie(n.childName,n.snapshotNode);return t.index_.compare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(t,e){return{eventCache:t,serverCache:e}}function _s(t,e,n,s){return er(new tn(e,n,s),t.serverCache)}function Yu(t,e,n,s){return er(t.eventCache,new tn(e,n,s))}function Di(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Sn(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rr;const _g=()=>(Rr||(Rr=new qe(Z_)),Rr);class be{static fromObject(e){let n=new be(null);return Ke(e,(s,i)=>{n=n.set(new pe(s),i)}),n}constructor(e,n=_g()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ae(),value:this.value};if(se(e))return null;{const s=ne(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(ye(e),n);return r!=null?{path:Ae(new pe(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(se(e))return this;{const n=ne(e),s=this.children.get(n);return s!==null?s.subtree(ye(e)):new be(null)}}set(e,n){if(se(e))return new be(n,this.children);{const s=ne(e),r=(this.children.get(s)||new be(null)).set(ye(e),n),o=this.children.insert(s,r);return new be(this.value,o)}}remove(e){if(se(e))return this.children.isEmpty()?new be(null):new be(null,this.children);{const n=ne(e),s=this.children.get(n);if(s){const i=s.remove(ye(e));let r;return i.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,i),this.value===null&&r.isEmpty()?new be(null):new be(this.value,r)}else return this}}get(e){if(se(e))return this.value;{const n=ne(e),s=this.children.get(n);return s?s.get(ye(e)):null}}setTree(e,n){if(se(e))return n;{const s=ne(e),r=(this.children.get(s)||new be(null)).setTree(ye(e),n);let o;return r.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,r),new be(this.value,o)}}fold(e){return this.fold_(ae(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(Ae(e,i),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,ae(),n)}findOnPath_(e,n,s){const i=this.value?s(n,this.value):!1;if(i)return i;if(se(e))return null;{const r=ne(e),o=this.children.get(r);return o?o.findOnPath_(ye(e),Ae(n,r),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ae(),n)}foreachOnPath_(e,n,s){if(se(e))return this;{this.value&&s(n,this.value);const i=ne(e),r=this.children.get(i);return r?r.foreachOnPath_(ye(e),Ae(n,i),s):new be(null)}}foreach(e){this.foreach_(ae(),e)}foreach_(e,n){this.children.inorderTraversal((s,i)=>{i.foreach_(Ae(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.writeTree_=e}static empty(){return new ft(new be(null))}}function ms(t,e,n){if(se(e))return new ft(new be(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const o=We(i,e);return r=r.updateChild(o,n),new ft(t.writeTree_.set(i,r))}else{const i=new be(n),r=t.writeTree_.setTree(e,i);return new ft(r)}}}function ga(t,e,n){let s=t;return Ke(n,(i,r)=>{s=ms(s,Ae(e,i),r)}),s}function va(t,e){if(se(e))return ft.empty();{const n=t.writeTree_.setTree(e,new be(null));return new ft(n)}}function Zr(t,e){return Tn(t,e)!=null}function Tn(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(We(n.path,e)):null}function ya(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ee,(s,i)=>{e.push(new ie(s,i))}):t.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new ie(s,i.value))}),e}function Kt(t,e){if(se(e))return t;{const n=Tn(t,e);return n!=null?new ft(new be(n)):new ft(t.writeTree_.subtree(e))}}function eo(t){return t.writeTree_.isEmpty()}function jn(t,e){return zu(ae(),t.writeTree_,e)}function zu(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(D(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):n=zu(Ae(t,i),r,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Ae(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(t,e){return Qu(e,t)}function mg(t,e,n,s,i){D(s>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:i}),i&&(t.visibleWrites=ms(t.visibleWrites,e,n)),t.lastWriteId=s}function gg(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function vg(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);D(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let i=s.visible,r=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const l=t.allWrites[o];l.visible&&(o>=n&&yg(l,s.path)?i=!1:ct(s.path,l.path)&&(r=!0)),o--}if(i){if(r)return bg(t),!0;if(s.snap)t.visibleWrites=va(t.visibleWrites,s.path);else{const l=s.children;Ke(l,a=>{t.visibleWrites=va(t.visibleWrites,Ae(s.path,a))})}return!0}else return!1}function yg(t,e){if(t.snap)return ct(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&ct(Ae(t.path,n),e))return!0;return!1}function bg(t){t.visibleWrites=qu(t.allWrites,Cg,ae()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function Cg(t){return t.visible}function qu(t,e,n){let s=ft.empty();for(let i=0;i<t.length;++i){const r=t[i];if(e(r)){const o=r.path;let l;if(r.snap)ct(n,o)?(l=We(n,o),s=ms(s,l,r.snap)):ct(o,n)&&(l=We(o,n),s=ms(s,ae(),r.snap.getChild(l)));else if(r.children){if(ct(n,o))l=We(n,o),s=ga(s,l,r.children);else if(ct(o,n))if(l=We(o,n),se(l))s=ga(s,ae(),r.children);else{const a=Wn(r.children,ne(l));if(a){const c=a.getChild(ye(l));s=ms(s,ae(),c)}}}else throw zn("WriteRecord should have .snap or .children")}}return s}function Gu(t,e,n,s,i){if(!s&&!i){const r=Tn(t.visibleWrites,e);if(r!=null)return r;{const o=Kt(t.visibleWrites,e);if(eo(o))return n;if(n==null&&!Zr(o,ae()))return null;{const l=n||Y.EMPTY_NODE;return jn(o,l)}}}else{const r=Kt(t.visibleWrites,e);if(!i&&eo(r))return n;if(!i&&n==null&&!Zr(r,ae()))return null;{const o=function(c){return(c.visible||i)&&(!s||!~s.indexOf(c.writeId))&&(ct(c.path,e)||ct(e,c.path))},l=qu(t.allWrites,o,e),a=n||Y.EMPTY_NODE;return jn(l,a)}}}function wg(t,e,n){let s=Y.EMPTY_NODE;const i=Tn(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ee,(r,o)=>{s=s.updateImmediateChild(r,o)}),s;if(n){const r=Kt(t.visibleWrites,e);return n.forEachChild(Ee,(o,l)=>{const a=jn(Kt(r,new pe(o)),l);s=s.updateImmediateChild(o,a)}),ya(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const r=Kt(t.visibleWrites,e);return ya(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function Eg(t,e,n,s,i){D(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=Ae(e,n);if(Zr(t.visibleWrites,r))return null;{const o=Kt(t.visibleWrites,r);return eo(o)?i.getChild(n):jn(o,i.getChild(n))}}function Sg(t,e,n,s){const i=Ae(e,n),r=Tn(t.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(n)){const o=Kt(t.visibleWrites,i);return jn(o,s.getNode().getImmediateChild(n))}else return null}function Ig(t,e){return Tn(t.visibleWrites,e)}function Tg(t,e,n,s,i,r,o){let l;const a=Kt(t.visibleWrites,e),c=Tn(a,ae());if(c!=null)l=c;else if(n!=null)l=jn(a,n);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const u=[],h=o.getCompare(),d=r?l.getReverseIteratorFrom(s,o):l.getIteratorFrom(s,o);let _=d.getNext();for(;_&&u.length<i;)h(_,s)!==0&&u.push(_),_=d.getNext();return u}else return[]}function xg(){return{visibleWrites:ft.empty(),allWrites:[],lastWriteId:-1}}function Pi(t,e,n,s){return Gu(t.writeTree,t.treePath,e,n,s)}function Uo(t,e){return wg(t.writeTree,t.treePath,e)}function ba(t,e,n,s){return Eg(t.writeTree,t.treePath,e,n,s)}function Mi(t,e){return Ig(t.writeTree,Ae(t.treePath,e))}function Rg(t,e,n,s,i,r){return Tg(t.writeTree,t.treePath,e,n,s,i,r)}function Bo(t,e,n){return Sg(t.writeTree,t.treePath,e,n)}function Ku(t,e){return Qu(Ae(t.treePath,e),t.writeTree)}function Qu(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;D(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),D(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(s,Rs(s,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(s,xs(s,i.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(s,Vn(s,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(s,Rs(s,e.snapshotNode,i.oldSnap));else throw zn("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Xu=new Ng;class Ho{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new tn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Bo(this.writes_,e,s)}}getChildAfterChild(e,n,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Sn(this.viewCache_),r=Rg(this.writes_,i,n,1,s,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(t){return{filter:t}}function Pg(t,e){D(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),D(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function Mg(t,e,n,s,i){const r=new Ag;let o,l;if(n.type===ut.OVERWRITE){const c=n;c.source.fromUser?o=to(t,e,c.path,c.snap,s,i,r):(D(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered()&&!se(c.path),o=Oi(t,e,c.path,c.snap,s,i,l,r))}else if(n.type===ut.MERGE){const c=n;c.source.fromUser?o=kg(t,e,c.path,c.children,s,i,r):(D(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered(),o=no(t,e,c.path,c.children,s,i,l,r))}else if(n.type===ut.ACK_USER_WRITE){const c=n;c.revert?o=Fg(t,e,c.path,s,i,r):o=Lg(t,e,c.path,c.affectedTree,s,i,r)}else if(n.type===ut.LISTEN_COMPLETE)o=$g(t,e,n.path,s,r);else throw zn("Unknown operation type: "+n.type);const a=r.getChanges();return Og(e,o,a),{viewCache:o,changes:a}}function Og(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=Di(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&n.push(Wu(Di(e)))}}function Ju(t,e,n,s,i,r){const o=e.eventCache;if(Mi(s,n)!=null)return e;{let l,a;if(se(n))if(D(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Sn(e),u=c instanceof Y?c:Y.EMPTY_NODE,h=Uo(s,u);l=t.filter.updateFullNode(e.eventCache.getNode(),h,r)}else{const c=Pi(s,Sn(e));l=t.filter.updateFullNode(e.eventCache.getNode(),c,r)}else{const c=ne(n);if(c===".priority"){D(en(n)===1,"Can't have a priority with additional path components");const u=o.getNode();a=e.serverCache.getNode();const h=ba(s,n,u,a);h!=null?l=t.filter.updatePriority(u,h):l=o.getNode()}else{const u=ye(n);let h;if(o.isCompleteForChild(c)){a=e.serverCache.getNode();const d=ba(s,n,o.getNode(),a);d!=null?h=o.getNode().getImmediateChild(c).updateChild(u,d):h=o.getNode().getImmediateChild(c)}else h=Bo(s,c,e.serverCache);h!=null?l=t.filter.updateChild(o.getNode(),c,h,u,i,r):l=o.getNode()}}return _s(e,l,o.isFullyInitialized()||se(n),t.filter.filtersNodes())}}function Oi(t,e,n,s,i,r,o,l){const a=e.serverCache;let c;const u=o?t.filter:t.filter.getIndexedFilter();if(se(n))c=u.updateFullNode(a.getNode(),s,null);else if(u.filtersNodes()&&!a.isFiltered()){const _=a.getNode().updateChild(n,s);c=u.updateFullNode(a.getNode(),_,null)}else{const _=ne(n);if(!a.isCompleteForPath(n)&&en(n)>1)return e;const g=ye(n),E=a.getNode().getImmediateChild(_).updateChild(g,s);_===".priority"?c=u.updatePriority(a.getNode(),E):c=u.updateChild(a.getNode(),_,E,g,Xu,null)}const h=Yu(e,c,a.isFullyInitialized()||se(n),u.filtersNodes()),d=new Ho(i,h,r);return Ju(t,h,n,i,d,l)}function to(t,e,n,s,i,r,o){const l=e.eventCache;let a,c;const u=new Ho(i,e,r);if(se(n))c=t.filter.updateFullNode(e.eventCache.getNode(),s,o),a=_s(e,c,!0,t.filter.filtersNodes());else{const h=ne(n);if(h===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),s),a=_s(e,c,l.isFullyInitialized(),l.isFiltered());else{const d=ye(n),_=l.getNode().getImmediateChild(h);let g;if(se(d))g=s;else{const m=u.getCompleteChild(h);m!=null?Pu(d)===".priority"&&m.getChild(Ou(d)).isEmpty()?g=m:g=m.updateChild(d,s):g=Y.EMPTY_NODE}if(_.equals(g))a=e;else{const m=t.filter.updateChild(l.getNode(),h,g,d,u,o);a=_s(e,m,l.isFullyInitialized(),t.filter.filtersNodes())}}}return a}function Ca(t,e){return t.eventCache.isCompleteForChild(e)}function kg(t,e,n,s,i,r,o){let l=e;return s.foreach((a,c)=>{const u=Ae(n,a);Ca(e,ne(u))&&(l=to(t,l,u,c,i,r,o))}),s.foreach((a,c)=>{const u=Ae(n,a);Ca(e,ne(u))||(l=to(t,l,u,c,i,r,o))}),l}function wa(t,e,n){return n.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function no(t,e,n,s,i,r,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,c;se(n)?c=s:c=new be(null).setTree(n,s);const u=e.serverCache.getNode();return c.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const _=e.serverCache.getNode().getImmediateChild(h),g=wa(t,_,d);a=Oi(t,a,new pe(h),g,i,r,o,l)}}),c.children.inorderTraversal((h,d)=>{const _=!e.serverCache.isCompleteForChild(h)&&d.value===null;if(!u.hasChild(h)&&!_){const g=e.serverCache.getNode().getImmediateChild(h),m=wa(t,g,d);a=Oi(t,a,new pe(h),m,i,r,o,l)}}),a}function Lg(t,e,n,s,i,r,o){if(Mi(i,n)!=null)return e;const l=e.serverCache.isFiltered(),a=e.serverCache;if(s.value!=null){if(se(n)&&a.isFullyInitialized()||a.isCompleteForPath(n))return Oi(t,e,n,a.getNode().getChild(n),i,r,l,o);if(se(n)){let c=new be(null);return a.getNode().forEachChild(yn,(u,h)=>{c=c.set(new pe(u),h)}),no(t,e,n,c,i,r,l,o)}else return e}else{let c=new be(null);return s.foreach((u,h)=>{const d=Ae(n,u);a.isCompleteForPath(d)&&(c=c.set(u,a.getNode().getChild(d)))}),no(t,e,n,c,i,r,l,o)}}function $g(t,e,n,s,i){const r=e.serverCache,o=Yu(e,r.getNode(),r.isFullyInitialized()||se(n),r.isFiltered());return Ju(t,o,n,s,Xu,i)}function Fg(t,e,n,s,i,r){let o;if(Mi(s,n)!=null)return e;{const l=new Ho(s,e,i),a=e.eventCache.getNode();let c;if(se(n)||ne(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Pi(s,Sn(e));else{const h=e.serverCache.getNode();D(h instanceof Y,"serverChildren would be complete if leaf node"),u=Uo(s,h)}u=u,c=t.filter.updateFullNode(a,u,r)}else{const u=ne(n);let h=Bo(s,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=a.getImmediateChild(u)),h!=null?c=t.filter.updateChild(a,u,h,ye(n),l,r):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(a,u,Y.EMPTY_NODE,ye(n),l,r):c=a,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Pi(s,Sn(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,r)))}return o=e.serverCache.isFullyInitialized()||Mi(s,ae())!=null,_s(e,c,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new ko(s.getIndex()),r=tg(s);this.processor_=Dg(r);const o=n.serverCache,l=n.eventCache,a=i.updateFullNode(Y.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(Y.EMPTY_NODE,l.getNode(),null),u=new tn(a,o.isFullyInitialized(),i.filtersNodes()),h=new tn(c,l.isFullyInitialized(),r.filtersNodes());this.viewCache_=er(h,u),this.eventGenerator_=new hg(this.query_)}get query(){return this.query_}}function Bg(t){return t.viewCache_.serverCache.getNode()}function Hg(t){return Di(t.viewCache_)}function Wg(t,e){const n=Sn(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!se(e)&&!n.getImmediateChild(ne(e)).isEmpty())?n.getChild(e):null}function Ea(t){return t.eventRegistrations_.length===0}function Vg(t,e){t.eventRegistrations_.push(e)}function Sa(t,e,n){const s=[];if(n){D(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(r=>{const o=r.createCancelEvent(n,i);o&&s.push(o)})}if(e){let i=[];for(let r=0;r<t.eventRegistrations_.length;++r){const o=t.eventRegistrations_[r];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return s}function Ia(t,e,n,s){e.type===ut.MERGE&&e.source.queryId!==null&&(D(Sn(t.viewCache_),"We should always have a full cache before handling merges"),D(Di(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,r=Mg(t.processor_,i,e,n,s);return Pg(t.processor_,r.viewCache),D(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,Zu(t,r.changes,r.viewCache.eventCache.getNode(),null)}function jg(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ee,(r,o)=>{s.push(Vn(r,o))}),n.isFullyInitialized()&&s.push(Wu(n.getNode())),Zu(t,s,n.getNode(),e)}function Zu(t,e,n,s){const i=s?[s]:t.eventRegistrations_;return dg(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ki;class eh{constructor(){this.views=new Map}}function Yg(t){D(!ki,"__referenceConstructor has already been defined"),ki=t}function zg(){return D(ki,"Reference.ts has not been loaded"),ki}function qg(t){return t.views.size===0}function Wo(t,e,n,s){const i=e.source.queryId;if(i!==null){const r=t.views.get(i);return D(r!=null,"SyncTree gave us an op for an invalid query."),Ia(r,e,n,s)}else{let r=[];for(const o of t.views.values())r=r.concat(Ia(o,e,n,s));return r}}function th(t,e,n,s,i){const r=e._queryIdentifier,o=t.views.get(r);if(!o){let l=Pi(n,i?s:null),a=!1;l?a=!0:s instanceof Y?(l=Uo(n,s),a=!1):(l=Y.EMPTY_NODE,a=!1);const c=er(new tn(l,a,!1),new tn(s,i,!1));return new Ug(e,c)}return o}function Gg(t,e,n,s,i,r){const o=th(t,e,s,i,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),Vg(o,n),jg(o,n)}function Kg(t,e,n,s){const i=e._queryIdentifier,r=[];let o=[];const l=nn(t);if(i==="default")for(const[a,c]of t.views.entries())o=o.concat(Sa(c,n,s)),Ea(c)&&(t.views.delete(a),c.query._queryParams.loadsAllData()||r.push(c.query));else{const a=t.views.get(i);a&&(o=o.concat(Sa(a,n,s)),Ea(a)&&(t.views.delete(i),a.query._queryParams.loadsAllData()||r.push(a.query)))}return l&&!nn(t)&&r.push(new(zg())(e._repo,e._path)),{removed:r,events:o}}function nh(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Qt(t,e){let n=null;for(const s of t.views.values())n=n||Wg(s,e);return n}function sh(t,e){if(e._queryParams.loadsAllData())return nr(t);{const s=e._queryIdentifier;return t.views.get(s)}}function ih(t,e){return sh(t,e)!=null}function nn(t){return nr(t)!=null}function nr(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Li;function Qg(t){D(!Li,"__referenceConstructor has already been defined"),Li=t}function Xg(){return D(Li,"Reference.ts has not been loaded"),Li}let Jg=1;class Ta{constructor(e){this.listenProvider_=e,this.syncPointTree_=new be(null),this.pendingWriteTree_=xg(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function rh(t,e,n,s,i){return mg(t.pendingWriteTree_,e,n,s,i),i?Vs(t,new En(ju(),e,n)):[]}function _n(t,e,n=!1){const s=gg(t.pendingWriteTree_,e);if(vg(t.pendingWriteTree_,e)){let r=new be(null);return s.snap!=null?r=r.set(ae(),!0):Ke(s.children,o=>{r=r.set(new pe(o),!0)}),Vs(t,new Ni(s.path,r,n))}else return[]}function Ws(t,e,n){return Vs(t,new En($o(),e,n))}function Zg(t,e,n){const s=be.fromObject(n);return Vs(t,new Ds($o(),e,s))}function ev(t,e){return Vs(t,new Ns($o(),e))}function tv(t,e,n){const s=jo(t,n);if(s){const i=Yo(s),r=i.path,o=i.queryId,l=We(r,e),a=new Ns(Fo(o),l);return zo(t,r,a)}else return[]}function $i(t,e,n,s,i=!1){const r=e._path,o=t.syncPointTree_.get(r);let l=[];if(o&&(e._queryIdentifier==="default"||ih(o,e))){const a=Kg(o,e,n,s);qg(o)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const c=a.removed;if(l=a.events,!i){const u=c.findIndex(d=>d._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(r,(d,_)=>nn(_));if(u&&!h){const d=t.syncPointTree_.subtree(r);if(!d.isEmpty()){const _=iv(d);for(let g=0;g<_.length;++g){const m=_[g],E=m.query,x=ch(t,m);t.listenProvider_.startListening(gs(E),Ps(t,E),x.hashFn,x.onComplete)}}}!h&&c.length>0&&!s&&(u?t.listenProvider_.stopListening(gs(e),null):c.forEach(d=>{const _=t.queryToTagMap.get(sr(d));t.listenProvider_.stopListening(gs(d),_)}))}rv(t,c)}return l}function oh(t,e,n,s){const i=jo(t,s);if(i!=null){const r=Yo(i),o=r.path,l=r.queryId,a=We(o,e),c=new En(Fo(l),a,n);return zo(t,o,c)}else return[]}function nv(t,e,n,s){const i=jo(t,s);if(i){const r=Yo(i),o=r.path,l=r.queryId,a=We(o,e),c=be.fromObject(n),u=new Ds(Fo(l),a,c);return zo(t,o,u)}else return[]}function so(t,e,n,s=!1){const i=e._path;let r=null,o=!1;t.syncPointTree_.foreachOnPath(i,(d,_)=>{const g=We(d,i);r=r||Qt(_,g),o=o||nn(_)});let l=t.syncPointTree_.get(i);l?(o=o||nn(l),r=r||Qt(l,ae())):(l=new eh,t.syncPointTree_=t.syncPointTree_.set(i,l));let a;r!=null?a=!0:(a=!1,r=Y.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((_,g)=>{const m=Qt(g,ae());m&&(r=r.updateImmediateChild(_,m))}));const c=ih(l,e);if(!c&&!e._queryParams.loadsAllData()){const d=sr(e);D(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");const _=ov();t.queryToTagMap.set(d,_),t.tagToQueryMap.set(_,d)}const u=tr(t.pendingWriteTree_,i);let h=Gg(l,e,n,u,r,a);if(!c&&!o&&!s){const d=sh(l,e);h=h.concat(lv(t,e,d))}return h}function Vo(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(o,l)=>{const a=We(o,e),c=Qt(l,a);if(c)return c});return Gu(i,e,r,n,!0)}function sv(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(c,u)=>{const h=We(c,n);s=s||Qt(u,h)});let i=t.syncPointTree_.get(n);i?s=s||Qt(i,ae()):(i=new eh,t.syncPointTree_=t.syncPointTree_.set(n,i));const r=s!=null,o=r?new tn(s,!0,!1):null,l=tr(t.pendingWriteTree_,e._path),a=th(i,e,l,r?o.getNode():Y.EMPTY_NODE,r);return Hg(a)}function Vs(t,e){return lh(e,t.syncPointTree_,null,tr(t.pendingWriteTree_,ae()))}function lh(t,e,n,s){if(se(t.path))return ah(t,e,n,s);{const i=e.get(ae());n==null&&i!=null&&(n=Qt(i,ae()));let r=[];const o=ne(t.path),l=t.operationForChild(o),a=e.children.get(o);if(a&&l){const c=n?n.getImmediateChild(o):null,u=Ku(s,o);r=r.concat(lh(l,a,c,u))}return i&&(r=r.concat(Wo(i,t,s,n))),r}}function ah(t,e,n,s){const i=e.get(ae());n==null&&i!=null&&(n=Qt(i,ae()));let r=[];return e.children.inorderTraversal((o,l)=>{const a=n?n.getImmediateChild(o):null,c=Ku(s,o),u=t.operationForChild(o);u&&(r=r.concat(ah(u,l,a,c)))}),i&&(r=r.concat(Wo(i,t,s,n))),r}function ch(t,e){const n=e.query,s=Ps(t,n);return{hashFn:()=>(Bg(e)||Y.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return s?tv(t,n._path,s):ev(t,n._path);{const r=nm(i,n);return $i(t,n,null,r)}}}}function Ps(t,e){const n=sr(e);return t.queryToTagMap.get(n)}function sr(t){return t._path.toString()+"$"+t._queryIdentifier}function jo(t,e){return t.tagToQueryMap.get(e)}function Yo(t){const e=t.indexOf("$");return D(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new pe(t.substr(0,e))}}function zo(t,e,n){const s=t.syncPointTree_.get(e);D(s,"Missing sync point for query tag that we're tracking");const i=tr(t.pendingWriteTree_,e);return Wo(s,n,i,null)}function iv(t){return t.fold((e,n,s)=>{if(n&&nn(n))return[nr(n)];{let i=[];return n&&(i=nh(n)),Ke(s,(r,o)=>{i=i.concat(o)}),i}})}function gs(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Xg())(t._repo,t._path):t}function rv(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const i=sr(s),r=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(r)}}}function ov(){return Jg++}function lv(t,e,n){const s=e._path,i=Ps(t,e),r=ch(t,n),o=t.listenProvider_.startListening(gs(e),i,r.hashFn,r.onComplete),l=t.syncPointTree_.subtree(s);if(i)D(!nn(l.value),"If we're adding a query, it shouldn't be shadowed");else{const a=l.fold((c,u,h)=>{if(!se(c)&&u&&nn(u))return[nr(u).query];{let d=[];return u&&(d=d.concat(nh(u).map(_=>_.query))),Ke(h,(_,g)=>{d=d.concat(g)}),d}});for(let c=0;c<a.length;++c){const u=a[c];t.listenProvider_.stopListening(gs(u),Ps(t,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new qo(n)}node(){return this.node_}}class Go{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Ae(this.path_,e);return new Go(this.syncTree_,n)}node(){return Vo(this.syncTree_,this.path_)}}const av=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},xa=function(t,e,n){if(!t||typeof t!="object")return t;if(D(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return cv(t[".sv"],e,n);if(typeof t[".sv"]=="object")return uv(t[".sv"],e);D(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},cv=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:D(!1,"Unexpected server value: "+t)}},uv=function(t,e,n){t.hasOwnProperty("increment")||D(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&D(!1,"Unexpected increment value: "+s);const i=e.node();if(D(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const o=i.getValue();return typeof o!="number"?s:o+s},hv=function(t,e,n,s){return Ko(e,new Go(n,t),s)},uh=function(t,e,n){return Ko(t,new qo(e),n)};function Ko(t,e,n){const s=t.getPriority().val(),i=xa(s,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const o=t,l=xa(o.getValue(),e,n);return l!==o.getValue()||i!==o.getPriority().val()?new De(l,Me(i)):t}else{const o=t;return r=o,i!==o.getPriority().val()&&(r=r.updatePriority(new De(i))),o.forEachChild(Ee,(l,a)=>{const c=Ko(a,e.getImmediateChild(l),n);c!==a&&(r=r.updateImmediateChild(l,c))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function Xo(t,e){let n=e instanceof pe?e:new pe(e),s=t,i=ne(n);for(;i!==null;){const r=Wn(s.node.children,i)||{children:{},childCount:0};s=new Qo(i,s,r),n=ye(n),i=ne(n)}return s}function Kn(t){return t.node.value}function hh(t,e){t.node.value=e,io(t)}function dh(t){return t.node.childCount>0}function dv(t){return Kn(t)===void 0&&!dh(t)}function ir(t,e){Ke(t.node.children,(n,s)=>{e(new Qo(n,t,s))})}function fh(t,e,n,s){n&&e(t),ir(t,i=>{fh(i,e,!0)})}function fv(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function js(t){return new pe(t.parent===null?t.name:js(t.parent)+"/"+t.name)}function io(t){t.parent!==null&&pv(t.parent,t.name,t)}function pv(t,e,n){const s=dv(n),i=Tt(t.node.children,e);s&&i?(delete t.node.children[e],t.node.childCount--,io(t)):!s&&!i&&(t.node.children[e]=n.node,t.node.childCount++,io(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _v=/[\[\].#$\/\u0000-\u001F\u007F]/,mv=/[\[\].#$\u0000-\u001F\u007F]/,Ar=10*1024*1024,ph=function(t){return typeof t=="string"&&t.length!==0&&!_v.test(t)},_h=function(t){return typeof t=="string"&&t.length!==0&&!mv.test(t)},gv=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),_h(t)},Ra=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!To(t)||t&&typeof t=="object"&&Tt(t,".sv")},Ys=function(t,e,n,s){s&&e===void 0||Jo(So(t,"value"),e,n)},Jo=function(t,e,n){const s=n instanceof pe?new km(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+dn(s));if(typeof e=="function")throw new Error(t+"contains a function "+dn(s)+" with contents = "+e.toString());if(To(e))throw new Error(t+"contains "+e.toString()+" "+dn(s));if(typeof e=="string"&&e.length>Ar/3&&Ji(e)>Ar)throw new Error(t+"contains a string greater than "+Ar+" utf8 bytes "+dn(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(Ke(e,(o,l)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!ph(o)))throw new Error(t+" contains an invalid key ("+o+") "+dn(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Lm(s,o),Jo(t,l,s),$m(s)}),i&&r)throw new Error(t+' contains ".value" child '+dn(s)+" in addition to actual children.")}},Zo=function(t,e,n,s){if(!_h(n))throw new Error(So(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},vv=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Zo(t,e,n)},el=function(t,e){if(ne(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},yv=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!ph(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!gv(n))throw new Error(So(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function tl(t,e){let n=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();n!==null&&!Do(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(i)}n&&t.eventLists_.push(n)}function mh(t,e,n){tl(t,n),gh(t,s=>Do(s,e))}function It(t,e,n){tl(t,n),gh(t,s=>ct(s,e)||ct(e,s))}function gh(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const i=t.eventLists_[s];if(i){const r=i.path;e(r)?(Cv(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Cv(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();fs&&$e("event: "+n.toString()),Gn(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv="repo_interrupt",Ev=25;class Sv{constructor(e,n,s,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new bv,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ai(),this.transactionQueueTree_=new Qo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Iv(t,e,n){if(t.stats_=Ao(t.repoInfo_),t.forceRestClient_||om())t.server_=new Ri(t.repoInfo_,(s,i,r,o)=>{Aa(t,s,i,r,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Na(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Re(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new $t(t.repoInfo_,e,(s,i,r,o)=>{Aa(t,s,i,r,o)},s=>{Na(t,s)},s=>{Tv(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=hm(t.repoInfo_,()=>new ug(t.stats_,t.server_)),t.infoData_=new rg,t.infoSyncTree_=new Ta({startListening:(s,i,r,o)=>{let l=[];const a=t.infoData_.getNode(s._path);return a.isEmpty()||(l=Ws(t.infoSyncTree_,s._path,a),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),sl(t,"connected",!1),t.serverSyncTree_=new Ta({startListening:(s,i,r,o)=>(t.server_.listen(s,r,i,(l,a)=>{const c=o(l,a);It(t.eventQueue_,s._path,c)}),[]),stopListening:(s,i)=>{t.server_.unlisten(s,i)}})}function vh(t){const n=t.infoData_.getNode(new pe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function nl(t){return av({timestamp:vh(t)})}function Aa(t,e,n,s,i){t.dataUpdateCount++;const r=new pe(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(s){const a=Ci(n,c=>Me(c));o=nv(t.serverSyncTree_,r,a,i)}else{const a=Me(n);o=oh(t.serverSyncTree_,r,a,i)}else if(s){const a=Ci(n,c=>Me(c));o=Zg(t.serverSyncTree_,r,a)}else{const a=Me(n);o=Ws(t.serverSyncTree_,r,a)}let l=r;o.length>0&&(l=or(t,r)),It(t.eventQueue_,l,o)}function Na(t,e){sl(t,"connected",e),e===!1&&Av(t)}function Tv(t,e){Ke(e,(n,s)=>{sl(t,n,s)})}function sl(t,e,n){const s=new pe("/.info/"+e),i=Me(n);t.infoData_.updateSnapshot(s,i);const r=Ws(t.infoSyncTree_,s,i);It(t.eventQueue_,s,r)}function yh(t){return t.nextWriteId_++}function xv(t,e,n){const s=sv(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(i=>{const r=Me(i).withIndex(e._queryParams.getIndex());so(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Ws(t.serverSyncTree_,e._path,r);else{const l=Ps(t.serverSyncTree_,e);o=oh(t.serverSyncTree_,e._path,r,l)}return It(t.eventQueue_,e._path,o),$i(t.serverSyncTree_,e,n,null,!0),r},i=>(rr(t,"get for query "+Re(e)+" failed: "+i),Promise.reject(new Error(i))))}function Rv(t,e,n,s,i){rr(t,"set",{path:e.toString(),value:n,priority:s});const r=nl(t),o=Me(n,s),l=Vo(t.serverSyncTree_,e),a=uh(o,l,r),c=yh(t),u=rh(t.serverSyncTree_,e,a,c,!0);tl(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,_)=>{const g=d==="ok";g||Ge("set at "+e+" failed: "+d);const m=_n(t.serverSyncTree_,c,!g);It(t.eventQueue_,e,m),Pv(t,i,d,_)});const h=Sh(t,e);or(t,h),It(t.eventQueue_,h,[])}function Av(t){rr(t,"onDisconnectEvents");const e=nl(t),n=Ai();Jr(t.onDisconnect_,ae(),(i,r)=>{const o=hv(i,r,t.serverSyncTree_,e);Vu(n,i,o)});let s=[];Jr(n,ae(),(i,r)=>{s=s.concat(Ws(t.serverSyncTree_,i,r));const o=Sh(t,i);or(t,o)}),t.onDisconnect_=Ai(),It(t.eventQueue_,ae(),s)}function Nv(t,e,n){let s;ne(e._path)===".info"?s=so(t.infoSyncTree_,e,n):s=so(t.serverSyncTree_,e,n),mh(t.eventQueue_,e._path,s)}function Da(t,e,n){let s;ne(e._path)===".info"?s=$i(t.infoSyncTree_,e,n):s=$i(t.serverSyncTree_,e,n),mh(t.eventQueue_,e._path,s)}function Dv(t){t.persistentConnection_&&t.persistentConnection_.interrupt(wv)}function rr(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),$e(n,...e)}function Pv(t,e,n,s){e&&Gn(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let r=i;s&&(r+=": "+s);const o=new Error(r);o.code=i,e(o)}})}function bh(t,e,n){return Vo(t.serverSyncTree_,e,n)||Y.EMPTY_NODE}function il(t,e=t.transactionQueueTree_){if(e||lr(t,e),Kn(e)){const n=wh(t,e);D(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&Mv(t,js(e),n)}else dh(e)&&ir(e,n=>{il(t,n)})}function Mv(t,e,n){const s=n.map(c=>c.currentWriteId),i=bh(t,e,s);let r=i;const o=i.hash();for(let c=0;c<n.length;c++){const u=n[c];D(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=We(e,u.path);r=r.updateChild(h,u.currentOutputSnapshotRaw)}const l=r.val(!0),a=e;t.server_.put(a.toString(),l,c=>{rr(t,"transaction put response",{path:a.toString(),status:c});let u=[];if(c==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(_n(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();lr(t,Xo(t.transactionQueueTree_,e)),il(t,t.transactionQueueTree_),It(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)Gn(h[d])}else{if(c==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Ge("transaction at "+a.toString()+" failed: "+c);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=c}or(t,e)}},o)}function or(t,e){const n=Ch(t,e),s=js(n),i=wh(t,n);return Ov(t,i,s),s}function Ov(t,e,n){if(e.length===0)return;const s=[];let i=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const a=e[l],c=We(n,a.path);let u=!1,h;if(D(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)u=!0,h=a.abortReason,i=i.concat(_n(t.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=Ev)u=!0,h="maxretry",i=i.concat(_n(t.serverSyncTree_,a.currentWriteId,!0));else{const d=bh(t,a.path,o);a.currentInputSnapshot=d;const _=e[l].update(d.val());if(_!==void 0){Jo("transaction failed: Data returned ",_,a.path);let g=Me(_);typeof _=="object"&&_!=null&&Tt(_,".priority")||(g=g.updatePriority(d.getPriority()));const E=a.currentWriteId,x=nl(t),P=uh(g,d,x);a.currentOutputSnapshotRaw=g,a.currentOutputSnapshotResolved=P,a.currentWriteId=yh(t),o.splice(o.indexOf(E),1),i=i.concat(rh(t.serverSyncTree_,a.path,P,a.currentWriteId,a.applyLocally)),i=i.concat(_n(t.serverSyncTree_,E,!0))}else u=!0,h="nodata",i=i.concat(_n(t.serverSyncTree_,a.currentWriteId,!0))}It(t.eventQueue_,n,i),i=[],u&&(e[l].status=2,function(d){setTimeout(d,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(h==="nodata"?s.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):s.push(()=>e[l].onComplete(new Error(h),!1,null))))}lr(t,t.transactionQueueTree_);for(let l=0;l<s.length;l++)Gn(s[l]);il(t,t.transactionQueueTree_)}function Ch(t,e){let n,s=t.transactionQueueTree_;for(n=ne(e);n!==null&&Kn(s)===void 0;)s=Xo(s,n),e=ye(e),n=ne(e);return s}function wh(t,e){const n=[];return Eh(t,e,n),n.sort((s,i)=>s.order-i.order),n}function Eh(t,e,n){const s=Kn(e);if(s)for(let i=0;i<s.length;i++)n.push(s[i]);ir(e,i=>{Eh(t,i,n)})}function lr(t,e){const n=Kn(e);if(n){let s=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[s]=n[i],s++);n.length=s,hh(e,n.length>0?n:void 0)}ir(e,s=>{lr(t,s)})}function Sh(t,e){const n=js(Ch(t,e)),s=Xo(t.transactionQueueTree_,e);return fv(s,i=>{Nr(t,i)}),Nr(t,s),fh(s,i=>{Nr(t,i)}),n}function Nr(t,e){const n=Kn(e);if(n){const s=[];let i=[],r=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(D(r===o-1,"All SENT items should be at beginning of queue."),r=o,n[o].status=3,n[o].abortReason="set"):(D(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(_n(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?hh(e,void 0):n.length=r+1,It(t.eventQueue_,js(e),i);for(let o=0;o<s.length;o++)Gn(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let i=n[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function Lv(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Ge(`Invalid query segment '${n}' in query '${t}'`)}return e}const Pa=function(t,e){const n=$v(t),s=n.namespace;n.domain==="firebase.com"&&Bt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Bt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||X_();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Eu(n.host,n.secure,s,i,e,"",s!==n.subdomain),path:new pe(n.pathString)}},$v=function(t){let e="",n="",s="",i="",r="",o=!0,l="https",a=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(l=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(i=kv(t.substring(u,h)));const d=Lv(t.substring(Math.min(t.length,h)));c=e.indexOf(":"),c>=0?(o=l==="https"||l==="wss",a=parseInt(e.substring(c+1),10)):c=e.length;const _=e.slice(0,c);if(_.toLowerCase()==="localhost")n="localhost";else if(_.split(".").length<=2)n=_;else{const g=e.indexOf(".");s=e.substring(0,g).toLowerCase(),n=e.substring(g+1),r=s}"ns"in d&&(r=d.ns)}return{host:e,port:a,domain:n,subdomain:s,secure:o,scheme:l,pathString:i,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Fv=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let i;const r=new Array(8);for(i=7;i>=0;i--)r[i]=Ma.charAt(n%64),n=Math.floor(n/64);D(n===0,"Cannot push at time == 0");let o=r.join("");if(s){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=Ma.charAt(e[i]);return D(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,n,s,i){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Re(this.snapshot.exportVal())}}class Bv{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return D(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,n,s,i){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=i}get key(){return se(this._path)?null:Pu(this._path)}get ref(){return new Vt(this._repo,this._path)}get _queryIdentifier(){const e=_a(this._queryParams),n=xo(e);return n==="{}"?"default":n}get _queryObject(){return _a(this._queryParams)}isEqual(e){if(e=on(e),!(e instanceof Qn))return!1;const n=this._repo===e._repo,s=Do(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+Om(this._path)}}function Hv(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function rl(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===yn){const s="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==wn)throw new Error(s);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Zt)throw new Error(s);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Ee){if(e!=null&&!Ra(e)||n!=null&&!Ra(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(D(t.getIndex()instanceof Oo||t.getIndex()===Hu,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Th(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Vt extends Qn{constructor(e,n){super(e,n,new Lo,!1)}get parent(){const e=Ou(this._path);return e===null?null:new Vt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Ms{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new pe(e),s=Os(this.ref,e);return new Ms(this._node.getChild(n),s,Ee)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,i)=>e(new Ms(i,Os(this.ref,s),Ee)))}hasChild(e){const n=new pe(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ot(t,e){return t=on(t),t._checkNotDeleted("ref"),e!==void 0?Os(t._root,e):t._root}function Os(t,e){return t=on(t),ne(t._path)===null?vv("child","path",e):Zo("child","path",e),new Vt(t._repo,Ae(t._path,e))}function xh(t,e){t=on(t),el("push",t._path),Ys("push",e,t._path,!0);const n=vh(t._repo),s=Fv(n),i=Os(t,s),r=Os(t,s);let o;return e!=null?o=Ft(r,e).then(()=>r):o=Promise.resolve(r),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function Wv(t){return el("remove",t._path),Ft(t,null)}function Ft(t,e){t=on(t),el("set",t._path),Ys("set",e,t._path,!1);const n=new Xi;return Rv(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function Xs(t){t=on(t);const e=new Ih(()=>{}),n=new ar(e);return xv(t._repo,t,n).then(s=>new Ms(s,new Vt(t._repo,t._path),t._queryParams.getIndex()))}class ar{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new Uv("value",this,new Ms(e.snapshotNode,new Vt(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Bv(this,e,n):null}matches(e){return e instanceof ar?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function Vv(t,e,n,s,i){let r;if(typeof s=="object"&&(r=void 0,i=s),typeof s=="function"&&(r=s),i&&i.onlyOnce){const a=n,c=(u,h)=>{Da(t._repo,t,l),a(u,h)};c.userCallback=n.userCallback,c.context=n.context,n=c}const o=new Ih(n,r||void 0),l=new ar(o);return Nv(t._repo,t,l),()=>Da(t._repo,t,l)}function cr(t,e,n,s){return Vv(t,"value",e,n,s)}class ur{}class jv extends ur{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Ys("endAt",this._value,e._path,!0);const n=sg(e._queryParams,this._value,this._key);if(Th(n),rl(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Qn(e._repo,e._path,n,e._orderByCalled)}}class Yv extends ur{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Ys("startAt",this._value,e._path,!0);const n=ng(e._queryParams,this._value,this._key);if(Th(n),rl(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Qn(e._repo,e._path,n,e._orderByCalled)}}class zv extends ur{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Hv(e,"orderByChild");const n=new pe(this._path);if(se(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const s=new Oo(n),i=ig(e._queryParams,s);return rl(i),new Qn(e._repo,e._path,i,!0)}}function Js(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Zo("orderByChild","path",t),new zv(t)}class qv extends ur{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Ys("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new jv(this._value,this._key)._apply(new Yv(this._value,this._key)._apply(e))}}function Zs(t,e){return new qv(t,e)}function ei(t,...e){let n=on(t);for(const s of e)n=s._apply(n);return n}Yg(Vt);Qg(Vt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="FIREBASE_DATABASE_EMULATOR_HOST",ro={};let Kv=!1;function Qv(t,e,n,s){const i=e.lastIndexOf(":"),r=e.substring(0,i),o=Eo(r);t.repoInfo_=new Eu(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(t.authTokenProvider_=s)}function Xv(t,e,n,s,i){let r=s||t.options.databaseURL;r===void 0&&(t.options.projectId||Bt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),$e("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Pa(r,i),l=o.repoInfo,a;typeof process<"u"&&Xl&&(a=Xl[Gv]),a?(r=`http://${a}?ns=${l.namespace}`,o=Pa(r,i),l=o.repoInfo):o.repoInfo.secure;const c=new am(t.name,t.options,e);yv("Invalid Firebase Database URL",o),se(o.path)||Bt("Database URL must point to the root of a Firebase Database (not including a child path).");const u=Zv(l,t,c,new lm(t,n));return new ey(u,t)}function Jv(t,e){const n=ro[e];(!n||n[t.key]!==t)&&Bt(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Dv(t),delete n[t.key]}function Zv(t,e,n,s){let i=ro[e.name];i||(i={},ro[e.name]=i);let r=i[t.toURLString()];return r&&Bt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Sv(t,Kv,n,s),i[t.toURLString()]=r,r}class ey{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Iv(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0,Zc("Database",this._repo.repoInfo_.emulatorOptions!==null)),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Vt(this._repo,ae())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Jv(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Bt("Cannot call "+e+" on a deleted database.")}}function ty(t=O_(),e){const n=A_(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=_p("database");s&&ny(n,...s)}return n}function ny(t,e,n,s={}){t=on(t),t._checkNotDeleted("useEmulator");const i=`${e}:${n}`,r=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&wi(s,r.repoInfo_.emulatorOptions))return;Bt("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&Bt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new oi(oi.OWNER);else if(s.mockUserToken){const l=typeof s.mockUserToken=="string"?s.mockUserToken:gp(s.mockUserToken,t.app.options.projectId);o=new oi(l)}Eo(e)&&(mp(e),Zc("Database",!0)),Qv(r,i,s,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(t){Y_(M_),Si(new Ss("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return Xv(s,i,r,n)},"PUBLIC").setMultipleInstances(!0)),Fn(Jl,Zl,t),Fn(Jl,Zl,"esm2017")}$t.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};$t.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};sy();var iy="firebase",ry="11.7.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fn(iy,ry,"app");const oy={apiKey:"AIzaSyBEYS8UtnIdaYA4aZHsFCE3rnSya_DdS8o",authDomain:"yierbubu.firebaseapp.com",projectId:"yierbubu",storageBucket:"yierbubu.firebasestorage.app",messagingSenderId:"745521053033",appId:"1:745521053033:web:57602c1e935aa1cca811f8",measurementId:"G-7TF1KMZJBQ",databaseURL:"https://yierbubu-default-rtdb.asia-southeast1.firebasedatabase.app"},ly=ou(oy),kt=ty(ly),ay={class:"user-count-box"},cy={class:"count-text"},uy={__name:"index",setup(t){const e=Ot(kt,"users"),n=X(0),s=X({opacity:0,position:"absolute",top:"70px",right:"0px",zIndex:"9999"}),i=X(null);Wt(()=>{i.value=cr(e,x=>{x.exists()?(n.value=Object.keys(x.val()||{}).length,s.value.opacity=1):n.value=0})}),qi(()=>{i.value&&i.value()});const r=X(!1),o=X(0),l=X(0),a=x=>x.touches?{clientX:x.touches[0].clientX,clientY:x.touches[0].clientY}:{clientX:x.clientX,clientY:x.clientY},c=()=>{document.body.style.overflow="hidden"},u=()=>{document.body.style.overflow=""},h=x=>{const{clientX:P,clientY:w}=a(x);r.value=!0;const C=x.currentTarget.getBoundingClientRect();o.value=P-C.left,l.value=w-C.top,s.value={...s.value,left:`${C.left}px`,right:"auto"},c(),document.addEventListener("mousemove",_),document.addEventListener("mouseup",m)},d=x=>{const{clientX:P,clientY:w}=a(x);r.value=!0;const C=x.currentTarget.getBoundingClientRect();o.value=P-C.left,l.value=w-C.top,s.value={...s.value,left:`${C.left}px`,right:"auto"},c(),document.addEventListener("touchmove",g),document.addEventListener("touchend",E)},_=x=>{if(r.value){const{clientX:P,clientY:w}=a(x);s.value.left=`${P-o.value}px`,s.value.top=`${w-l.value}px`}},g=x=>{if(r.value){const{clientX:P,clientY:w}=a(x);s.value.left=`${P-o.value}px`,s.value.top=`${w-l.value}px`}},m=()=>{r.value=!1,u(),document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",m)},E=()=>{r.value=!1,u(),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",E)};return(x,P)=>(B(),j("div",{class:"user-count-container",style:Yn(s.value),onMousedown:h,onTouchstart:d},[y("div",ay,[y("span",cy,"当前已有 "+fe(n.value)+" 人访问",1)])],36))}},hy=Qe(uy,[["__scopeId","data-v-f5bab605"]]),dy=""+new URL("yier_avatar-CSEOs6om.jpg",import.meta.url).href,fy=""+new URL("bubu_avatar-DEQ1y__y.jpg",import.meta.url).href,py=""+new URL("card1-BjV9YNQd.png",import.meta.url).href,_y=""+new URL("card2-AYQs3wvw.png",import.meta.url).href,my=""+new URL("yierbubu1-B23mzmrk.gif",import.meta.url).href,gy=""+new URL("yierbubu2-B7bgCKGJ.gif",import.meta.url).href,vy=""+new URL("yierbubu3-CPNQMIDT.gif",import.meta.url).href,yy=""+new URL("yierbubu4-CvyKPgHh.gif",import.meta.url).href,by=""+new URL("yierbubu5-BShqPsnc.gif",import.meta.url).href,Cy=""+new URL("yierbubu6-DT3n0tNy.gif",import.meta.url).href,wy=""+new URL("yierbubu7-QHzcuu4f.gif",import.meta.url).href,Rh=""+new URL("yierbubu8-R6jPVSrt.gif",import.meta.url).href,Ey=""+new URL("yierbubu9-CRF36ScZ.gif",import.meta.url).href,Sy=""+new URL("yierbubu10-DrkyPMO_.gif",import.meta.url).href,Iy=""+new URL("yierbubu11-vewBH8We.gif",import.meta.url).href,Ty=""+new URL("yierbubu12-DlyaiZpM.gif",import.meta.url).href,xy=""+new URL("yierbubu13-BNA4hEOo.gif",import.meta.url).href,Ah=""+new URL("yierRole-kStJEXR8.gif",import.meta.url).href,Ry=""+new URL("youke-D8Qhs-IN.jpeg",import.meta.url).href,Oa=[Ah,py,_y,my,gy,vy,yy,by,Cy,wy,Rh,Ey,Sy,Iy,Ty,xy],Bn=[Ah,Rh,Ry],Ay={class:"index-body"},Ny={class:"avatar"},Dy={class:"days-container"},Py={class:"card_container"},My=["src"],Oy=2,ky={__name:"IndexBody",setup(t){const e=X(0);let n,s=0;const i=X([...Oa,...Oa]),r=X(null);let o=null;o=setInterval(()=>{Array.from({length:5}).forEach(()=>{var g;i.value.push(i.value[s]),(g=r.value[s])==null||g.remove(),s++,d.value-=120,c.value.style.transform=`translateX(-${d.value}px)`})},5e3);const l=()=>{const E=Math.abs(new Date-new Date("2023-12-07"));e.value=Math.ceil(E/(1e3*60*60*24))},a=Jt(()=>e.value.toString().split("")),c=X(null);let u,h=0;const d=X(0),_=()=>{u=setInterval(()=>{c.value&&(d.value+=Oy,d.value>=h&&(d.value=0),c.value.style.transform=`translateX(-${d.value}px)`)},16)};return Wt(()=>{l(),n=setInterval(l,60*1e3),setTimeout(()=>{if(c.value){h=c.value.offsetWidth;const g=c.value.querySelector(".card1");if(g){const m=window.getComputedStyle(g);g.offsetWidth+parseInt(m.marginRight)}_()}},0)}),vc(()=>{clearInterval(n),clearInterval(u),clearInterval(o)}),(g,m)=>(B(),j(we,null,[m[5]||(m[5]=y("section",{class:"banner"},null,-1)),y("div",Ay,[y("div",Ny,[m[2]||(m[2]=y("div",{class:"left container"},[y("img",{class:"img",src:dy,width:"84"}),y("div",{class:"img_name"},"王宇晴")],-1)),y("div",null,[m[1]||(m[1]=y("div",{class:"desc_container text"},"在一起",-1)),y("div",Dy,[(B(!0),j(we,null,nt(a.value,(E,x)=>(B(),j("div",{key:x,class:"digit-card"},fe(E),1))),128)),m[0]||(m[0]=y("div",{class:"digit-card text"},"Days",-1))])]),m[3]||(m[3]=y("div",{class:"right container"},[y("img",{class:"img",src:fy,width:"84"}),y("div",{class:"img_name"},"刘云宇")],-1))]),y("div",Py,[y("div",{class:"scroll-wrapper",ref_key:"scrollWrapper",ref:c},[(B(!0),j(we,null,nt(i.value,(E,x)=>(B(),j("img",{key:E+x,src:E,class:"card card1",ref_for:!0,ref_key:"scrollImgRef",ref:r},null,8,My))),128))],512)]),m[4]||(m[4]=gf('<div class="content" data-v-a5134c12><div class="about_us" data-v-a5134c12><span class="card_title" data-v-a5134c12>关于我们</span><div class="divider" data-v-a5134c12></div><div class="about_us_content" data-v-a5134c12><div data-v-a5134c12>     一二布布相识于2017年12月湖里实验中学，在初一办公室见面，那时候一二带着陈伟诺小弟改英语作业，布布来数数学卷子，两天彼此对视，留下了深刻的印象，并成为了soulmate。但是好景不长......被一二的班主任发现了，一二布布被迫分开。 </div><div data-v-a5134c12>     初中毕业后，一二布布来到不同的高中，布布去了最好的厦门一中，一二去了厦门仅此一所的松柏中学。中间虽然见了几次面，但最终抵不过时间的洪流，联系渐少，生活的轨迹似乎越行越远 。</div><div data-v-a5134c12>     到了大学，醒悟的布布重新找到一二，互相诉说着这三年来各自的遭遇，在经历了这么多事情之后，两人决定再也不分开了。至此，一二和布布从soulmate变成lovers，开启了属于他们的爱情篇章...... </div></div></div></div>',1))])],64))}},Ly=Qe(ky,[["__scopeId","data-v-a5134c12"]]);function ol(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var li={exports:{}},$y=li.exports,ka;function Fy(){return ka||(ka=1,function(t,e){(function(n,s){t.exports=s()})($y,function(){var n=1e3,s=6e4,i=36e5,r="millisecond",o="second",l="minute",a="hour",c="day",u="week",h="month",d="quarter",_="year",g="date",m="Invalid Date",E=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,P={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(z){var F=["th","st","nd","rd"],N=z%100;return"["+z+(F[(N-20)%10]||F[N]||F[0])+"]"}},w=function(z,F,N){var k=String(z);return!k||k.length>=F?z:""+Array(F+1-k.length).join(N)+z},v={s:w,z:function(z){var F=-z.utcOffset(),N=Math.abs(F),k=Math.floor(N/60),T=N%60;return(F<=0?"+":"-")+w(k,2,"0")+":"+w(T,2,"0")},m:function z(F,N){if(F.date()<N.date())return-z(N,F);var k=12*(N.year()-F.year())+(N.month()-F.month()),T=F.clone().add(k,h),W=N-T<0,K=F.clone().add(k+(W?-1:1),h);return+(-(k+(N-T)/(W?T-K:K-T))||0)},a:function(z){return z<0?Math.ceil(z)||0:Math.floor(z)},p:function(z){return{M:h,y:_,w:u,d:c,D:g,h:a,m:l,s:o,ms:r,Q:d}[z]||String(z||"").toLowerCase().replace(/s$/,"")},u:function(z){return z===void 0}},C="en",U={};U[C]=P;var q="$isDayjsObject",J=function(z){return z instanceof xt||!(!z||!z[q])},ce=function z(F,N,k){var T;if(!F)return C;if(typeof F=="string"){var W=F.toLowerCase();U[W]&&(T=W),N&&(U[W]=N,T=W);var K=F.split("-");if(!T&&K.length>1)return z(K[0])}else{var re=F.name;U[re]=F,T=re}return!k&&T&&(C=T),T||!k&&C},Z=function(z,F){if(J(z))return z.clone();var N=typeof F=="object"?F:{};return N.date=z,N.args=arguments,new xt(N)},te=v;te.l=ce,te.i=J,te.w=function(z,F){return Z(z,{locale:F.$L,utc:F.$u,x:F.$x,$offset:F.$offset})};var xt=function(){function z(N){this.$L=ce(N.locale,null,!0),this.parse(N),this.$x=this.$x||N.x||{},this[q]=!0}var F=z.prototype;return F.parse=function(N){this.$d=function(k){var T=k.date,W=k.utc;if(T===null)return new Date(NaN);if(te.u(T))return new Date;if(T instanceof Date)return new Date(T);if(typeof T=="string"&&!/Z$/i.test(T)){var K=T.match(E);if(K){var re=K[2]-1||0,le=(K[7]||"0").substring(0,3);return W?new Date(Date.UTC(K[1],re,K[3]||1,K[4]||0,K[5]||0,K[6]||0,le)):new Date(K[1],re,K[3]||1,K[4]||0,K[5]||0,K[6]||0,le)}}return new Date(T)}(N),this.init()},F.init=function(){var N=this.$d;this.$y=N.getFullYear(),this.$M=N.getMonth(),this.$D=N.getDate(),this.$W=N.getDay(),this.$H=N.getHours(),this.$m=N.getMinutes(),this.$s=N.getSeconds(),this.$ms=N.getMilliseconds()},F.$utils=function(){return te},F.isValid=function(){return this.$d.toString()!==m},F.isSame=function(N,k){var T=Z(N);return this.startOf(k)<=T&&T<=this.endOf(k)},F.isAfter=function(N,k){return Z(N)<this.startOf(k)},F.isBefore=function(N,k){return this.endOf(k)<Z(N)},F.$g=function(N,k,T){return te.u(N)?this[k]:this.set(T,N)},F.unix=function(){return Math.floor(this.valueOf()/1e3)},F.valueOf=function(){return this.$d.getTime()},F.startOf=function(N,k){var T=this,W=!!te.u(k)||k,K=te.p(N),re=function(pt,Ie){var At=te.w(T.$u?Date.UTC(T.$y,Ie,pt):new Date(T.$y,Ie,pt),T);return W?At:At.endOf(c)},le=function(pt,Ie){return te.w(T.toDate()[pt].apply(T.toDate("s"),(W?[0,0,0,0]:[23,59,59,999]).slice(Ie)),T)},Se=this.$W,Ne=this.$M,Ye=this.$D,st="set"+(this.$u?"UTC":"");switch(K){case _:return W?re(1,0):re(31,11);case h:return W?re(1,Ne):re(0,Ne+1);case u:var it=this.$locale().weekStart||0,Rt=(Se<it?Se+7:Se)-it;return re(W?Ye-Rt:Ye+(6-Rt),Ne);case c:case g:return le(st+"Hours",0);case a:return le(st+"Minutes",1);case l:return le(st+"Seconds",2);case o:return le(st+"Milliseconds",3);default:return this.clone()}},F.endOf=function(N){return this.startOf(N,!1)},F.$set=function(N,k){var T,W=te.p(N),K="set"+(this.$u?"UTC":""),re=(T={},T[c]=K+"Date",T[g]=K+"Date",T[h]=K+"Month",T[_]=K+"FullYear",T[a]=K+"Hours",T[l]=K+"Minutes",T[o]=K+"Seconds",T[r]=K+"Milliseconds",T)[W],le=W===c?this.$D+(k-this.$W):k;if(W===h||W===_){var Se=this.clone().set(g,1);Se.$d[re](le),Se.init(),this.$d=Se.set(g,Math.min(this.$D,Se.daysInMonth())).$d}else re&&this.$d[re](le);return this.init(),this},F.set=function(N,k){return this.clone().$set(N,k)},F.get=function(N){return this[te.p(N)]()},F.add=function(N,k){var T,W=this;N=Number(N);var K=te.p(k),re=function(Ne){var Ye=Z(W);return te.w(Ye.date(Ye.date()+Math.round(Ne*N)),W)};if(K===h)return this.set(h,this.$M+N);if(K===_)return this.set(_,this.$y+N);if(K===c)return re(1);if(K===u)return re(7);var le=(T={},T[l]=s,T[a]=i,T[o]=n,T)[K]||1,Se=this.$d.getTime()+N*le;return te.w(Se,this)},F.subtract=function(N,k){return this.add(-1*N,k)},F.format=function(N){var k=this,T=this.$locale();if(!this.isValid())return T.invalidDate||m;var W=N||"YYYY-MM-DDTHH:mm:ssZ",K=te.z(this),re=this.$H,le=this.$m,Se=this.$M,Ne=T.weekdays,Ye=T.months,st=T.meridiem,it=function(Ie,At,f,p){return Ie&&(Ie[At]||Ie(k,W))||f[At].slice(0,p)},Rt=function(Ie){return te.s(re%12||12,Ie,"0")},pt=st||function(Ie,At,f){var p=Ie<12?"AM":"PM";return f?p.toLowerCase():p};return W.replace(x,function(Ie,At){return At||function(f){switch(f){case"YY":return String(k.$y).slice(-2);case"YYYY":return te.s(k.$y,4,"0");case"M":return Se+1;case"MM":return te.s(Se+1,2,"0");case"MMM":return it(T.monthsShort,Se,Ye,3);case"MMMM":return it(Ye,Se);case"D":return k.$D;case"DD":return te.s(k.$D,2,"0");case"d":return String(k.$W);case"dd":return it(T.weekdaysMin,k.$W,Ne,2);case"ddd":return it(T.weekdaysShort,k.$W,Ne,3);case"dddd":return Ne[k.$W];case"H":return String(re);case"HH":return te.s(re,2,"0");case"h":return Rt(1);case"hh":return Rt(2);case"a":return pt(re,le,!0);case"A":return pt(re,le,!1);case"m":return String(le);case"mm":return te.s(le,2,"0");case"s":return String(k.$s);case"ss":return te.s(k.$s,2,"0");case"SSS":return te.s(k.$ms,3,"0");case"Z":return K}return null}(Ie)||K.replace(":","")})},F.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},F.diff=function(N,k,T){var W,K=this,re=te.p(k),le=Z(N),Se=(le.utcOffset()-this.utcOffset())*s,Ne=this-le,Ye=function(){return te.m(K,le)};switch(re){case _:W=Ye()/12;break;case h:W=Ye();break;case d:W=Ye()/3;break;case u:W=(Ne-Se)/6048e5;break;case c:W=(Ne-Se)/864e5;break;case a:W=Ne/i;break;case l:W=Ne/s;break;case o:W=Ne/n;break;default:W=Ne}return T?W:te.a(W)},F.daysInMonth=function(){return this.endOf(h).$D},F.$locale=function(){return U[this.$L]},F.locale=function(N,k){if(!N)return this.$L;var T=this.clone(),W=ce(N,k,!0);return W&&(T.$L=W),T},F.clone=function(){return te.w(this.$d,this)},F.toDate=function(){return new Date(this.valueOf())},F.toJSON=function(){return this.isValid()?this.toISOString():null},F.toISOString=function(){return this.$d.toISOString()},F.toString=function(){return this.$d.toUTCString()},z}(),ln=xt.prototype;return Z.prototype=ln,[["$ms",r],["$s",o],["$m",l],["$H",a],["$W",c],["$M",h],["$y",_],["$D",g]].forEach(function(z){ln[z[1]]=function(F){return this.$g(F,z[0],z[1])}}),Z.extend=function(z,F){return z.$i||(z(F,xt,Z),z.$i=!0),Z},Z.locale=ce,Z.isDayjs=J,Z.unix=function(z){return Z(1e3*z)},Z.en=U[C],Z.Ls=U,Z.p={},Z})}(li)),li.exports}var Uy=Fy();const Ct=ol(Uy),By={class:"app-container"},Hy={class:"form-group"},Wy={class:"form-group"},Vy={class:"form-group"},jy={type:"submit",class:"btn primary-btn"},Yy={class:"memo-list"},zy={class:"item-header"},qy={class:"item-meta"},Gy={class:"date"},Ky={class:"countdown"},Qy={class:"actions"},Xy=["onClick"],Jy=["onClick"],Zy={key:0,class:"empty-state"},eb={__name:"MemoryDay",setup(t){const e=Ot(kt,"memos"),n=X([]),s=ji({id:null,name:"",date:"",type:"纪念日",backgroundColor:""}),i=X(""),r=X(!0),o=X(null),l=X(!1),a=Jt(()=>(n.value.forEach(w=>{w.backgroundColor||(w.backgroundColor=_())}),n.value.filter(w=>w.name.toLowerCase().includes(i.value.toLowerCase())))),c=w=>{const v=Ct(w),C=Ct();return v.diff(C,"day")},u=w=>{const v=c(w);return v>0?`${v}天后`:v===0?"今天！":`${-v}天前`},h=w=>Ct(w).format("YYYY年MM月DD日"),d=w=>w>7?"countdown-normal":w>0?"countdown-warning":w===0?"countdown-today":"countdown-past",_=()=>{const w=["rgba(163, 217, 0, 0.3)","rgba(0, 163, 224, 0.3)","rgba(255, 184, 28, 0.3)","rgba(0, 166, 172, 0.3)","rgba(214, 0, 28, 0.3)","rgba(143, 195, 31, 0.3)","rgba(0, 153, 68, 0.3)"],v=Math.floor(Math.random()*w.length);return w[v]},g=async()=>{if(!(!s.name||!s.date))try{const w={id:Date.now(),name:s.name,date:s.date,type:s.type,days:c(s.date),backgroundColor:_()};n.value.push(w),await Ft(e,n.value),P()}catch(w){o.value=w.message,console.error("添加失败:",w)}},m=w=>{const v=n.value[w];s.id=v.id,s.name=v.name,s.date=v.date,s.type=v.type,s.backgroundColor=v.backgroundColor,l.value=!0},E=async()=>{if(s.id)try{const w=n.value.findIndex(v=>v.id===s.id);w!==-1&&(n.value[w]={...n.value[w],name:s.name,date:s.date,type:s.type,days:c(s.date),backgroundColor:s.backgroundColor},await Ft(e,n.value),P(),l.value=!1)}catch(w){o.value=w.message,console.error("更新失败:",w)}},x=async w=>{if(confirm("确定要删除这个纪念日吗？"))try{n.value=n.value.filter(v=>v.id!==w),await Ft(e,n.value)}catch(v){o.value=v.message,console.error("删除失败:",v)}},P=()=>{s.id=null,s.name="",s.date="",s.type="纪念日",s.backgroundColor=""};return Wt(()=>{try{cr(e,w=>{const v=w.val();n.value=v?Object.values(v):[],r.value=!1},w=>{o.value=w.message,r.value=!1,console.error("获取数据失败:",w)})}catch(w){o.value=w.message,r.value=!1,console.error("初始化失败:",w)}}),(w,v)=>(B(),j("div",By,[y("form",{class:"memo-form",onSubmit:v[3]||(v[3]=zc(C=>l.value?E():g(),["prevent"]))},[y("div",Hy,[v[4]||(v[4]=y("label",null,"名称",-1)),dt(y("input",{type:"text","onUpdate:modelValue":v[0]||(v[0]=C=>s.name=C),placeholder:"请输入纪念日名称",required:""},null,512),[[vn,s.name,void 0,{trim:!0}]])]),y("div",Wy,[v[5]||(v[5]=y("label",null,"日期",-1)),dt(y("input",{type:"date","onUpdate:modelValue":v[1]||(v[1]=C=>s.date=C),required:""},null,512),[[vn,s.date]])]),y("div",Vy,[v[6]||(v[6]=y("label",null,"类型",-1)),dt(y("input",{type:"text","onUpdate:modelValue":v[2]||(v[2]=C=>s.type=C),placeholder:"请输入纪念类型",required:""},null,512),[[vn,s.type,void 0,{trim:!0}]])]),y("button",jy,fe(l.value?"保存编辑":"添加纪念日"),1)],32),y("div",Yy,[(B(!0),j(we,null,nt(a.value,(C,U)=>(B(),j("div",{class:"memo-item",key:C.id},[y("div",zy,[y("p",{class:"item-name",style:Yn({backgroundColor:C.backgroundColor})},fe(C.name),5)]),y("div",qy,[y("span",{class:je(["type-tag",C.type])},fe(C.type),3),y("span",Gy,fe(h(C.date)),1)]),y("div",Ky,[y("span",{class:je(["countdown-text",d(C.days)])},fe(u(C.date)),3)]),y("div",Qy,[y("button",{class:"btn edit-btn",onClick:q=>m(U)},v[7]||(v[7]=[y("span",{class:"icon-edit"},"编辑",-1)]),8,Xy),y("button",{class:"btn delete-btn",onClick:q=>x(C.id)},v[8]||(v[8]=[y("span",{class:"icon-delete"},"删除",-1)]),8,Jy)])]))),128)),n.value.length===0?(B(),j("div",Zy,v[9]||(v[9]=[y("p",null,"暂无纪念日，点击上方按钮添加",-1)]))):ot("",!0)])]))}},tb=Qe(eb,[["__scopeId","data-v-2d71f74a"]]);var ai={exports:{}},nb=ai.exports,La;function sb(){return La||(La=1,function(t,e){(function(n,s){t.exports=s()})(nb,function(){var n={year:0,month:1,day:2,hour:3,minute:4,second:5},s={};return function(i,r,o){var l,a=function(d,_,g){g===void 0&&(g={});var m=new Date(d),E=function(x,P){P===void 0&&(P={});var w=P.timeZoneName||"short",v=x+"|"+w,C=s[v];return C||(C=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:x,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:w}),s[v]=C),C}(_,g);return E.formatToParts(m)},c=function(d,_){for(var g=a(d,_),m=[],E=0;E<g.length;E+=1){var x=g[E],P=x.type,w=x.value,v=n[P];v>=0&&(m[v]=parseInt(w,10))}var C=m[3],U=C===24?0:C,q=m[0]+"-"+m[1]+"-"+m[2]+" "+U+":"+m[4]+":"+m[5]+":000",J=+d;return(o.utc(q).valueOf()-(J-=J%1e3))/6e4},u=r.prototype;u.tz=function(d,_){d===void 0&&(d=l);var g,m=this.utcOffset(),E=this.toDate(),x=E.toLocaleString("en-US",{timeZone:d}),P=Math.round((E-new Date(x))/1e3/60),w=15*-Math.round(E.getTimezoneOffset()/15)-P;if(!Number(w))g=this.utcOffset(0,_);else if(g=o(x,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(w,!0),_){var v=g.utcOffset();g=g.add(m-v,"minute")}return g.$x.$timezone=d,g},u.offsetName=function(d){var _=this.$x.$timezone||o.tz.guess(),g=a(this.valueOf(),_,{timeZoneName:d}).find(function(m){return m.type.toLowerCase()==="timezonename"});return g&&g.value};var h=u.startOf;u.startOf=function(d,_){if(!this.$x||!this.$x.$timezone)return h.call(this,d,_);var g=o(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return h.call(g,d,_).tz(this.$x.$timezone,!0)},o.tz=function(d,_,g){var m=g&&_,E=g||_||l,x=c(+o(),E);if(typeof d!="string")return o(d).tz(E);var P=function(U,q,J){var ce=U-60*q*1e3,Z=c(ce,J);if(q===Z)return[ce,q];var te=c(ce-=60*(Z-q)*1e3,J);return Z===te?[ce,Z]:[U-60*Math.min(Z,te)*1e3,Math.max(Z,te)]}(o.utc(d,m).valueOf(),x,E),w=P[0],v=P[1],C=o(w).utcOffset(v);return C.$x.$timezone=E,C},o.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},o.tz.setDefault=function(d){l=d}}})}(ai)),ai.exports}var ib=sb();const Nh=ol(ib);var ci={exports:{}},rb=ci.exports,$a;function ob(){return $a||($a=1,function(t,e){(function(n,s){t.exports=s()})(rb,function(){var n="minute",s=/[+-]\d\d(?::?\d\d)?/g,i=/([+-]|\d\d)/g;return function(r,o,l){var a=o.prototype;l.utc=function(m){var E={date:m,utc:!0,args:arguments};return new o(E)},a.utc=function(m){var E=l(this.toDate(),{locale:this.$L,utc:!0});return m?E.add(this.utcOffset(),n):E},a.local=function(){return l(this.toDate(),{locale:this.$L,utc:!1})};var c=a.parse;a.parse=function(m){m.utc&&(this.$u=!0),this.$utils().u(m.$offset)||(this.$offset=m.$offset),c.call(this,m)};var u=a.init;a.init=function(){if(this.$u){var m=this.$d;this.$y=m.getUTCFullYear(),this.$M=m.getUTCMonth(),this.$D=m.getUTCDate(),this.$W=m.getUTCDay(),this.$H=m.getUTCHours(),this.$m=m.getUTCMinutes(),this.$s=m.getUTCSeconds(),this.$ms=m.getUTCMilliseconds()}else u.call(this)};var h=a.utcOffset;a.utcOffset=function(m,E){var x=this.$utils().u;if(x(m))return this.$u?0:x(this.$offset)?h.call(this):this.$offset;if(typeof m=="string"&&(m=function(C){C===void 0&&(C="");var U=C.match(s);if(!U)return null;var q=(""+U[0]).match(i)||["-",0,0],J=q[0],ce=60*+q[1]+ +q[2];return ce===0?0:J==="+"?ce:-ce}(m),m===null))return this;var P=Math.abs(m)<=16?60*m:m,w=this;if(E)return w.$offset=P,w.$u=m===0,w;if(m!==0){var v=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(w=this.local().add(P+v,n)).$offset=P,w.$x.$localOffset=v}else w=this.utc();return w};var d=a.format;a.format=function(m){var E=m||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return d.call(this,E)},a.valueOf=function(){var m=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*m},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var _=a.toDate;a.toDate=function(m){return m==="s"&&this.$offset?l(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():_.call(this)};var g=a.diff;a.diff=function(m,E,x){if(m&&this.$u===m.$u)return g.call(this,m,E,x);var P=this.local(),w=l(m).local();return g.call(P,w,E,x)}}})}(ci)),ci.exports}var lb=ob();const Dh=ol(lb),ab={class:"tab-bar"},cb={__name:"TabBar",props:{currentTab:{type:String,default:"home"}},emits:["tabChange"],setup(t,{emit:e}){return(n,s)=>(B(),j("div",ab,[y("button",{onClick:s[0]||(s[0]=i=>n.$emit("tabChange","home")),class:je({active:t.currentTab==="home"})},"说说主页",2),y("button",{onClick:s[1]||(s[1]=i=>n.$emit("tabChange","stats")),class:je({active:t.currentTab==="stats"})},"统计分析",2)]))}},ub=Qe(cb,[["__scopeId","data-v-bce7c543"]]),hb={class:"post-area"},db={class:"post-card"},fb={class:"post-header"},pb=["src"],_b={class:"post-info"},mb={class:"post-name"},gb={class:"post-time"},vb={class:"post-form"},yb={class:"post-actions"},bb={class:"image-upload"},Cb={key:0,class:"image-preview"},wb={class:"image-grid"},Eb=["src"],Sb={__name:"PostArea",props:{currentUser:{type:Object,required:!0},newPost:{type:Object,required:!0},showUpload:{type:Boolean,required:!0}},emits:["publishPost","handleImageUpload","showImageUpload"],setup(t,{emit:e}){const n=t,s=e,i=()=>{s("showImageUpload",!0)},r=()=>{s("publishPost",n.newPost)},o=l=>{s("handleImageUpload",l)};return(l,a)=>(B(),j("div",hb,[y("div",db,[y("div",fb,[y("img",{src:t.currentUser.avatar,alt:"头像",class:"post-avatar"},null,8,pb),y("div",_b,[y("div",mb,fe(t.currentUser.name),1),y("span",gb,fe(new Date().toLocaleString()),1)])]),y("div",vb,[dt(y("textarea",{"onUpdate:modelValue":a[0]||(a[0]=c=>t.newPost.content=c),placeholder:"今天有什么值得记录的事？",class:"post-textarea",onFocus:i},null,544),[[vn,t.newPost.content]]),y("div",yb,[dt(y("div",bb,[y("input",{type:"file",id:"post-image",onChange:o,multiple:"",class:"hidden-input"},null,32),a[1]||(a[1]=y("label",{for:"post-image",class:"upload-btn"},[y("i",{class:"fa fa-image"}),Bc(" 上传图片 ")],-1))],512),[[Yc,t.showUpload]]),y("button",{onClick:r,class:"publish-btn"},"发布")]),t.newPost.images.length?(B(),j("div",Cb,[y("div",wb,[(B(!0),j(we,null,nt(t.newPost.images,c=>(B(),j("img",{src:c,alt:"预览",class:"preview-img",key:c},null,8,Eb))),128))])])):ot("",!0)])])]))}},Ib=Qe(Sb,[["__scopeId","data-v-fc18fefb"]]),Tb=["src"],xb={__name:"ImagePreview",props:{visible:{type:Boolean,required:!0},imageUrl:{type:String,required:!0}},emits:["close"],setup(t,{emit:e}){const n=e,s=()=>{n("close")};return(i,r)=>t.visible?(B(),j("div",{key:0,class:"image-preview-overlay",onClick:s},[y("div",{class:"image-preview-container",onClick:r[0]||(r[0]=zc(()=>{},["stop"]))},[y("img",{src:t.imageUrl,alt:"预览图片",class:"preview-image"},null,8,Tb),y("button",{class:"close-button",onClick:s},r[1]||(r[1]=[y("i",{class:"fa fa-times"},null,-1)]))])])):ot("",!0)}},Rb=Qe(xb,[["__scopeId","data-v-fa1b4578"]]),Ab={class:"feed-list"},Nb={class:"feed-header"},Db=["src"],Pb={class:"feed-user-info"},Mb={class:"feed-actions"},Ob={class:"feed-actions-group"},kb=["onClick"],Lb=["onClick"],$b=["onClick"],Fb={class:"feed-content"},Ub={class:"feed-images"},Bb=["src","onClick"],Hb={div:"",class:"feed-footer"},Wb={class:"comment-section"},Vb=["onClick"],jb={class:"comment-list"},Yb={class:"comment-user"},zb={class:"comment-text"},qb={class:"comment-input"},Gb=["onClick"],Kb={__name:"FeedList",props:{posts:{type:Array,required:!0},filteredPosts:{type:Array,required:!0},currentUser:{type:Object,required:!0}},emits:["editPost","deletePost","toggleForgiven","toggleComments","addComment"],setup(t,{emit:e}){Ct.extend(Dh),Ct.extend(Nh),Ct.tz.setDefault("Asia/Shanghai");const n=e,s=X(!1),i=X(""),r=g=>{i.value=g,s.value=!0},o=()=>{s.value=!1,i.value=""},l={content:""},a=g=>Ct.tz(g,"Asia/Shanghai").format("YYYY年MM月DD日 HH:MM"),c=g=>{n("editPost",g)},u=g=>{n("deletePost",g)},h=g=>{[1,2].includes(g.user.id)&&n("toggleForgiven",g)},d=g=>{n("toggleComments",g)},_=(g,m)=>{n("addComment",g,m),l.content=""};return(g,m)=>(B(),j("div",Ab,[(B(!0),j(we,null,nt(t.filteredPosts,E=>{var x;return B(),j("div",{class:"feed-card",key:E.id},[y("div",Nb,[y("img",{src:E.user.avatar,alt:"头像",class:"feed-avatar"},null,8,Db),y("div",Pb,[y("div",null,fe(E.user.name),1),y("span",null,fe(a(E.timestamp)),1)]),y("div",Mb,[y("div",Ob,[E.user.id===t.currentUser.id?(B(),j("button",{key:0,onClick:P=>c(E)},m[1]||(m[1]=[y("i",{class:"fa fa-pen"},null,-1)]),8,kb)):ot("",!0),E.user.id===t.currentUser.id?(B(),j("button",{key:1,onClick:P=>u(E)},m[2]||(m[2]=[y("i",{class:"fa fa-trash"},null,-1)]),8,Lb)):ot("",!0)]),[1,2].includes(E.user.id)?(B(),j("div",{key:0,onClick:P=>h(E),class:je(E.forgiven?"forgiven-status forgiven":"forgiven-status unforgiven")},fe(E.forgiven?"已原谅":"未原谅"),11,$b)):ot("",!0)])]),y("div",Fb,[y("p",null,fe(E.content),1),y("div",Ub,[(B(!0),j(we,null,nt(E.images,P=>(B(),j("img",{src:P,alt:"动态图片",class:"feed-img",key:P,onClick:w=>r(P)},null,8,Bb))),128))])]),y("div",Hb,[y("div",Wb,[y("button",{onClick:P=>d(E),class:"comment-button"},fe(((x=E.comments)==null?void 0:x.length)||0)+"条留言，点击留言 ",9,Vb),y("div",jb,[(B(!0),j(we,null,nt(E.comments,(P,w)=>(B(),j("div",{class:"comment",key:w},[y("span",Yb,fe(P.user.name)+":",1),y("span",zb,fe(P.content),1)]))),128)),dt(y("div",qb,[dt(y("textarea",{"onUpdate:modelValue":m[0]||(m[0]=P=>l.content=P),placeholder:"留下你的评论...",class:"comment-textarea"},null,512),[[vn,l.content]]),y("button",{onClick:P=>_(E.id,l),class:"comment-submit-button"},"发表",8,Gb)],512),[[Yc,E.showComments]])])])])])}),128)),Te(Rb,{visible:s.value,"image-url":i.value,onClose:o},null,8,["visible","image-url"])]))}},Qb=Qe(Kb,[["__scopeId","data-v-adf02cb3"]]),Xb={class:"stats-container"},Jb={class:"stats-table"},Zb={__name:"StatsComponent",props:{posts:Array},setup(t){const e=t,n=Jt(()=>{const s={};return e.posts.forEach(i=>{const r=i.timestamp.split(" ")[0];s[r]||(s[r]={yier:!1,bubu:!1}),i.user.id===1?s[r].yier=!0:i.user.id===2&&(s[r].bubu=!0)}),s});return(s,i)=>(B(),j("div",Xb,[i[1]||(i[1]=y("h2",null,"统计分析",-1)),y("div",Jb,[y("table",null,[i[0]||(i[0]=y("thead",null,[y("tr",null,[y("th",null,"日期"),y("th",null,"一二"),y("th",null,"布布")])],-1)),y("tbody",null,[(B(!0),j(we,null,nt(n.value,(r,o)=>(B(),j("tr",{key:o},[y("td",null,fe(o),1),y("td",{class:je({active:r.yier})},null,2),y("td",{class:je({active:r.bubu})},null,2)]))),128))])])])]))}},eC=Qe(Zb,[["__scopeId","data-v-8596637e"]]),tC={class:"filter-container"},nC={class:"filter-item"},sC={class:"filter-item"},iC=["value"],rC={__name:"FilterComponent",props:{posts:Array},setup(t,{expose:e}){const n=X(""),s=X(""),i=X([]),r=t,o=()=>{s.value="",a()},l=Jt(()=>r.posts.map(c=>c.timestamp.split(" ")[0]).filter((c,u,h)=>h.indexOf(c)===u)),a=()=>{n.value?i.value=l.value.filter(c=>r.posts.some(u=>u.user.name===n.value&&u.timestamp.includes(c))):i.value=[...new Set(l.value)]};return gn(()=>l.value,a,{immediate:!0}),e({selectedIdentity:n,selectedDate:s}),(c,u)=>(B(),j("div",tC,[y("div",nC,[u[3]||(u[3]=y("label",{for:"identity"},"身份筛选：",-1)),dt(y("select",{"onUpdate:modelValue":u[0]||(u[0]=h=>n.value=h),id:"identity",onChange:o},u[2]||(u[2]=[y("option",{value:""},"全部",-1),y("option",{value:"一二"},"一二",-1),y("option",{value:"布布"},"布布",-1)]),544),[[Ll,n.value]])]),y("div",sC,[u[5]||(u[5]=y("label",{for:"date"},"时间筛选：",-1)),dt(y("select",{"onUpdate:modelValue":u[1]||(u[1]=h=>s.value=h),id:"date"},[u[4]||(u[4]=y("option",{value:""},"全部",-1)),(B(!0),j(we,null,nt(i.value,h=>(B(),j("option",{key:h,value:h},fe(h),9,iC))),128))],512),[[Ll,s.value]])])]))}},oC=Qe(rC,[["__scopeId","data-v-80c044ae"]]),lC={class:"app-container"},aC={class:"app-main"},cC={key:0},uC={key:1,class:"stats-area"},hC={__name:"index",setup(t){const e=X("home"),n=X({id:3,name:"访客",avatar:Bn[2]}),s=[{id:1,name:"一二",avatar:Bn[0]},{id:2,name:"布布",avatar:Bn[1]}],i=X([]),r=X({content:"",images:[],originalId:null}),o=X(!1),l=X(null),a=Jt(()=>{var U,q;let C=i.value;if((U=l.value)!=null&&U.selectedIdentity&&(C=C.filter(J=>J.user.name===l.value.selectedIdentity)),(q=l.value)!=null&&q.selectedDate){const J=new Date(l.value.selectedDate);C=C.filter(ce=>{const Z=new Date(ce.timestamp);return Z.getFullYear()===J.getFullYear()&&Z.getMonth()===J.getMonth()&&Z.getDate()===J.getDate()})}return C});Ct.extend(Dh),Ct.extend(Nh),Ct.tz.setDefault("Asia/Shanghai"),Wt(()=>{cr(Ot(kt,"posts"),U=>{const q=U.val(),J=q?Object.values(q).map(ce=>(ce.comments=ce.comments?Object.values(ce.comments):[],ce)):[];i.value=J.reverse()},U=>{console.error("获取动态数据失败:",U)});const C=localStorage.getItem("YIERBUBU_ROLE");C==="yier"?n.value=s[0]:C==="bubu"&&(n.value=s[1]),n.value.name=localStorage.getItem("YIERBUBU_NAME")||"访客"});const c=C=>new Promise((U,q)=>{const J=new FileReader;J.onloadend=()=>U(J.result),J.onerror=q,J.readAsDataURL(C)}),u=async C=>{const q=await(await fetch(C)).arrayBuffer();return new Blob([q],{type:"image/jpeg"})},h=async()=>{var ce;if(!r.value.content&&!r.value.images.length){alert("请输入内容或上传图片");return}const C=await u(n.value.avatar),U=await c(C),q=!!r.value.originalId,J={id:q?r.value.originalId:Date.now(),user:{...n.value,avatar:U},content:r.value.content,images:r.value.images,comments:q?((ce=i.value.find(Z=>Z.id===r.value.originalId))==null?void 0:ce.comments)||[]:[],timestamp:new Date().toLocaleString(),forgiven:!1};try{await Ft(Ot(kt,`posts/${J.id}`),J),d()}catch(Z){console.error("发布动态失败:",Z),alert("发布失败，请重试")}},d=()=>{r.value.content="",r.value.images=[],r.value.originalId=null,o.value=!1},_=()=>{o.value=!o.value},g=C=>{const U=C.target.files;U&&(r.value.images=[],Array.from(U).forEach(q=>{const J=new FileReader;J.onload=ce=>{r.value.images.push(ce.target.result)},J.readAsDataURL(q)}))},m=C=>{r.value.content=C.content,r.value.images=C.images||[],r.value.originalId=C.id},E=async C=>{if(confirm("确定要删除这条动态吗？"))try{await Wv(Ot(kt,`posts/${C.id}`))}catch(U){console.error("删除动态失败:",U),alert("删除失败，请重试")}},x=async(C,U)=>{if(!U.content)return;const q={user:n.value,content:U.content,timestamp:new Date().toLocaleString()};try{await Ft(Ot(kt,`posts/${C}/comments/${Date.now()}`),q)}catch(J){console.error("添加评论失败:",J)}},P=C=>{C.showComments=!C.showComments},w=async C=>{try{await Ft(Ot(kt,`posts/${C.id}/forgiven`),!C.forgiven),C.forgiven=!C.forgiven}catch(U){console.error("切换原谅状态失败:",U)}},v=C=>{e.value=C};return(C,U)=>(B(),j("div",lC,[y("main",aC,[Te(ub,{currentTab:e.value,onTabChange:v},null,8,["currentTab"]),Te(oC,{ref_key:"filterComponent",ref:l,posts:i.value},null,8,["posts"]),e.value==="home"?(B(),j("div",cC,[Te(Ib,{currentUser:n.value,newPost:r.value,showUpload:o.value,onPublishPost:h,onHandleImageUpload:g,onShowImageUpload:_},null,8,["currentUser","newPost","showUpload"]),Te(Qb,{posts:i.value,filteredPosts:a.value,currentUser:n.value,onEditPost:m,onDeletePost:E,onToggleForgiven:w,onToggleComments:P,onAddComment:x},null,8,["posts","filteredPosts","currentUser"])])):(B(),j("div",uC,[Te(eC,{posts:i.value},null,8,["posts"])]))])]))}},dC=Qe(hC,[["__scopeId","data-v-71746ee4"]]),fC=["src"],pC={class:"name"},_C={class:"description"},mC={__name:"RoleCard",props:{role:Object,selectedRole:String},emits:["select"],setup(t,{emit:e}){const n=t,s=e,i=()=>{s("select",n.role.id)};return(r,o)=>(B(),j("div",{class:je(["role-card",[{selected:t.role.id===t.selectedRole}]]),onClick:i},[y("img",{src:t.role.icon,class:"icon",width:"36"},null,8,fC),y("div",pC,fe(t.role.name),1),y("div",_C,fe(t.role.description),1)],2))}},gC=Qe(mC,[["__scopeId","data-v-e177fee1"]]),vC={key:0,class:"modal-overlay"},yC={class:"role-selection-modal"},bC={class:"modal-content"},CC={class:"role-cards"},wC={class:"username-input"},EC={key:0,class:"error-message"},SC=["disabled"],IC={__name:"RoleSelect",setup(t){const e=Ot(kt,"users"),n=X(!1),s=X([{id:"yier",name:"一二",icon:Bn[0],description:"公主专属身份"},{id:"bubu",name:"布布",icon:Bn[1],description:"王子专属身份"},{id:"guest",name:"访客",icon:Bn[2],description:"访客身份"}]),i=X(null),r=X(""),o=X(""),l=X(!1);Wt(async()=>{localStorage.getItem("yierbubu-role")&&(localStorage.removeItem("yierbubu-role"),localStorage.removeItem("yierbubu-role-time"));const h=localStorage.getItem("YIERBUBU_ROLE"),d=localStorage.getItem("YIERBUBU_NAME");if(h&&d){const _=ei(e,Js("username"),Zs(d));(await Xs(_)).exists()?n.value=!1:(localStorage.removeItem("YIERBUBU_ROLE"),localStorage.removeItem("YIERBUBU_NAME"),n.value=!0,o.value="用户名不存在，请重新选择身份和输入用户名")}else n.value=!0}),gn(n,h=>{h?document.body.classList.add("no-scroll"):document.body.classList.remove("no-scroll")});const a=h=>{i.value=h,o.value=""},c=async()=>{if(!i.value)return"请选择一个身份";if(!r.value.trim())return"请输入用户名";if(i.value==="yier"||i.value==="bubu"){const _=ei(e,Js("role"),Zs("yier")),g=await Xs(_);let m=0;g.exists()&&(m+=g.size);const E=ei(e,Js("role"),Zs("bubu")),x=await Xs(E);if(x.exists()&&(m+=x.size),m>=5)return"一二和布布的身份已被占用，请选择访客身份或稍后再试"}const h=ei(e,Js("username"),Zs(r.value));return(await Xs(h)).exists()?"该用户名已被使用，请选择其他用户名":null},u=async()=>{if(!l.value)try{l.value=!0,o.value="";const h=await c();if(h){o.value=h;return}localStorage.setItem("YIERBUBU_ROLE",i.value),localStorage.setItem("YIERBUBU_NAME",r.value);const d=xh(e);await Ft(d,{role:i.value,username:r.value,createdAt:new Date().toISOString()}),n.value=!1}catch(h){console.error("保存用户信息失败:",h),o.value="保存失败，请稍后再试"}finally{l.value=!1}};return(h,d)=>n.value?(B(),j("div",vC,[y("div",yC,[y("div",bC,[d[2]||(d[2]=y("h3",{class:"modal-title"},"请选择您的身份",-1)),y("div",CC,[(B(!0),j(we,null,nt(s.value,_=>(B(),Nn(gC,{key:_.id,role:_,selectedRole:i.value,onSelect:a},null,8,["role","selectedRole"]))),128))]),y("div",wC,[d[1]||(d[1]=y("label",{for:"username"},"请输入您的用户名:",-1)),dt(y("input",{type:"text",id:"username","onUpdate:modelValue":d[0]||(d[0]=_=>r.value=_),placeholder:"请输入用户名"},null,512),[[vn,r.value]])]),o.value?(B(),j("p",EC,fe(o.value),1)):ot("",!0),y("button",{class:"confirm-button",onClick:u,disabled:l.value},fe(l.value?"提交中...":"确定"),9,SC)])])])):ot("",!0)}},TC=Qe(IC,[["__scopeId","data-v-c1f4313b"]]),Oe=[];for(let t=0;t<256;++t)Oe.push((t+256).toString(16).slice(1));function xC(t,e=0){return(Oe[t[e+0]]+Oe[t[e+1]]+Oe[t[e+2]]+Oe[t[e+3]]+"-"+Oe[t[e+4]]+Oe[t[e+5]]+"-"+Oe[t[e+6]]+Oe[t[e+7]]+"-"+Oe[t[e+8]]+Oe[t[e+9]]+"-"+Oe[t[e+10]]+Oe[t[e+11]]+Oe[t[e+12]]+Oe[t[e+13]]+Oe[t[e+14]]+Oe[t[e+15]]).toLowerCase()}let Dr;const RC=new Uint8Array(16);function AC(){if(!Dr){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Dr=crypto.getRandomValues.bind(crypto)}return Dr(RC)}const NC=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Fa={randomUUID:NC};function DC(t,e,n){var i;if(Fa.randomUUID&&!t)return Fa.randomUUID();t=t||{};const s=t.random??((i=t.rng)==null?void 0:i.call(t))??AC();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,xC(s)}const PC={class:"guest-comment-container"},MC={class:"comment-board"},OC=["onMouseenter","onMouseleave"],kC={class:"comment-content"},LC={class:"comment-name"},$C={class:"comment-text"},FC={class:"comment-input-area"},UC={class:"input-wrapper"},BC=["disabled"],HC={class:"comment-list"},WC=["onMouseenter","onMouseleave"],VC={class:"comment-header"},jC={class:"comment-name"},YC={class:"comment-time"},zC={class:"comment-text"},qC={__name:"index",setup(t){const e=X(""),n=X(localStorage.getItem("YIERBUBU_NAME")||""),s=X([]),i=X({}),r=X(new Set);Wt(()=>{const v=localStorage.getItem("YIERBUBU_NAME");v&&(n.value=v)}),gn(n,v=>{v.trim()&&localStorage.setItem("YIERBUBU_NAME",v)});const o=Ot(kt,"GuestComments"),l=()=>({color:`hsl(${Math.random()*360}, 70%, 50%)`,fontSize:`${14+Math.random()*8}px`,position:"absolute",left:`${10+Math.random()*50}%`,top:`${25+Math.random()*50}%`,opacity:.9,transition:"all 0.5s ease"}),a=()=>{if(!c.value)return;const v={id:DC(),text:e.value,time:new Date().toISOString(),userName:n.value,style:l()};xh(o,v),r.value.add(v.id),setTimeout(()=>{const C=document.querySelector(".comment-board");C&&(C.scrollTop=0)},100),e.value=""},c=Jt(()=>e.value.trim()&&n.value.trim()),u=Jt(()=>[...s.value].sort((v,C)=>new Date(C.time)-new Date(v.time))),h=v=>{const C=new Date(v);return`${C.getFullYear()}-${(C.getMonth()+1).toString().padStart(2,"0")}-${C.getDate().toString().padStart(2,"0")} ${C.getHours().toString().padStart(2,"0")}:${C.getMinutes().toString().padStart(2,"0")}`},d=v=>r.value.has(v.id)&&new Date-new Date(v.time)<5e3,_=v=>{v.target.style.height="auto",v.target.style.height=v.target.scrollHeight+10+"px"};cr(o,v=>{const C=v.val();s.value=C?Object.values(C):[],setTimeout(()=>{r.value.clear()},5e3)});const g=v=>{i.value[v]={...i.value[v],hover:!0}},m=v=>{i.value[v]={...i.value[v],hover:!1}},E=v=>{i.value[v]={...i.value[v],listHover:!0}},x=v=>{i.value[v]={...i.value[v],listHover:!1}},P=v=>{v.target.parentElement.classList.add("focused")},w=v=>{v.target.parentElement.classList.remove("focused")};return(v,C)=>(B(),j("div",PC,[C[2]||(C[2]=y("div",{class:"comment-header"},[y("h2",{class:"title"},"留言板"),y("div",{class:"subtitle"},"分享你的想法和感受")],-1)),y("div",MC,[(B(!0),j(we,null,nt(s.value,U=>(B(),j("div",{key:U.id,class:"comment-item",style:Yn(U.style),onMouseenter:q=>g(U.id),onMouseleave:q=>m(U.id)},[y("div",kC,[y("div",LC,fe(U.userName),1),y("div",$C,fe(U.text),1)])],44,OC))),128))]),y("div",FC,[y("div",UC,[C[1]||(C[1]=y("label",{class:"input-label"},"留言",-1)),dt(y("textarea",{"onUpdate:modelValue":C[0]||(C[0]=U=>e.value=U),placeholder:"写下你的留言...",onInput:_,onFocus:P,onBlur:w},null,544),[[vn,e.value]])]),y("button",{onClick:a,class:je({"btn-active":e.value.trim()&&n.value.trim()}),disabled:!c.value}," 发表留言 ",10,BC)]),y("div",HC,[(B(!0),j(we,null,nt(u.value,U=>(B(),j("div",{key:U.id,class:je(["comment-list-item",{"new-comment":d(U)}]),onMouseenter:q=>E(U.id),onMouseleave:q=>x(U.id)},[y("div",VC,[y("div",jC,fe(U.userName),1),y("div",YC,fe(h(U.time)),1)]),y("div",zC,fe(U.text),1)],42,WC))),128))])]))}},GC=Qe(qC,[["__scopeId","data-v-224ead62"]]),KC={__name:"App",setup(t){const e=X(0);return gn(e,n=>{localStorage.setItem("yierbubu-activeIndex",n)}),Wt(()=>{e.value=Number(localStorage.getItem("yierbubu-activeIndex"))||0}),(n,s)=>(B(),j(we,null,[y("div",null,[Te(ip),Te(hy),Te(np,{activeIndex:e.value,"onUpdate:activeIndex":s[0]||(s[0]=i=>e.value=i)},null,8,["activeIndex"]),e.value===0?(B(),Nn(Ly,{key:0})):ot("",!0),e.value===1?(B(),Nn(dC,{key:1})):ot("",!0),e.value===2?(B(),Nn(tb,{key:2})):ot("",!0),e.value===3?(B(),Nn(GC,{key:3})):ot("",!0)]),Te(TC)],64))}};Xf(KC).mount("#app");
